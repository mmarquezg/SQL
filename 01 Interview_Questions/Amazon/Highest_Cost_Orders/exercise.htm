<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><style id="ace-github">.ace-github .ace_gutter {background: #e8e8e8;color: #AAA;}.ace-github  {background: #fff;color: #000;}.ace-github .ace_keyword {font-weight: bold;}.ace-github .ace_string {color: #D14;}.ace-github .ace_variable.ace_class {color: teal;}.ace-github .ace_constant.ace_numeric {color: #099;}.ace-github .ace_constant.ace_buildin {color: #0086B3;}.ace-github .ace_support.ace_function {color: #0086B3;}.ace-github .ace_comment {color: #998;font-style: italic;}.ace-github .ace_variable.ace_language  {color: #0086B3;}.ace-github .ace_paren {font-weight: bold;}.ace-github .ace_boolean {font-weight: bold;}.ace-github .ace_string.ace_regexp {color: #009926;font-weight: normal;}.ace-github .ace_variable.ace_instance {color: teal;}.ace-github .ace_constant.ace_language {font-weight: bold;}.ace-github .ace_cursor {color: black;}.ace-github.ace_focus .ace_marker-layer .ace_active-line {background: rgb(255, 255, 204);}.ace-github .ace_marker-layer .ace_active-line {background: rgb(245, 245, 245);}.ace-github .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-github.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-github.ace_nobold .ace_line > span {font-weight: normal !important;}.ace-github .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-github .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-github .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-github .ace_gutter-active-line {background-color : rgba(0, 0, 0, 0.07);}.ace-github .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-github .ace_invisible {color: #BFBFBF}.ace-github .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-github .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}
/*# sourceURL=ace/css/ace-github */</style><style id="error_marker.css">    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }
/*# sourceURL=ace/css/error_marker.css */</style><style id="ace-tm">.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}
/*# sourceURL=ace/css/ace-tm */</style><style id="ace_editor.css">.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}.ace_editor {position: relative;overflow: hidden;padding: 0;font: 12px/normal 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;direction: ltr;text-align: left;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;box-sizing: border-box;min-width: 100%;contain: style size layout;font-variant-ligatures: no-common-ligatures;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: '';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;contain: style size layout;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {position: absolute;top: 0;left: 0;right: 0;padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {contain: strict;position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;contain: strict;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: transparent;color: inherit;z-index: 1000;opacity: 1;}.ace_composition_placeholder { color: transparent }.ace_composition_marker { border-bottom: 1px solid;position: absolute;border-radius: 0;margin-top: 1px;}[ace_nocontext=true] {transform: none!important;filter: none!important;clip-path: none!important;mask : none!important;contain: none!important;perspective: none!important;mix-blend-mode: initial!important;z-index: auto;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;height: 1000000px;contain: style size layout;}.ace_text-layer {font: inherit !important;position: absolute;height: 1000000px;width: 1000000px;contain: style size layout;}.ace_text-layer > .ace_line, .ace_text-layer > .ace_line_group {contain: style size layout;position: absolute;top: 0;left: 0;right: 0;}.ace_hidpi .ace_text-layer,.ace_hidpi .ace_gutter-layer,.ace_hidpi .ace_content,.ace_hidpi .ace_gutter {contain: strict;will-change: transform;}.ace_hidpi .ace_text-layer > .ace_line, .ace_hidpi .ace_text-layer > .ace_line_group {contain: strict;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_hasPlaceholder .ace_hidden-cursors .ace_cursor {opacity: 0;}.ace_smooth-blinking .ace_cursor {transition: opacity 0.18s;}.ace_animate-blinking .ace_cursor {animation-duration: 1000ms;animation-timing-function: step-end;animation-name: blink-ace-animate;animation-iteration-count: infinite;}.ace_animate-blinking.ace_smooth-blinking .ace_cursor {animation-duration: 1000ms;animation-timing-function: ease-in-out;animation-name: blink-ace-animate-smooth;}@keyframes blink-ace-animate {from, to { opacity: 1; }60% { opacity: 0; }}@keyframes blink-ace-animate-smooth {from, to { opacity: 1; }45% { opacity: 1; }60% { opacity: 0; }85% { opacity: 0; }}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_error_bracket {position: absolute;border-bottom: 1px solid #DE5555;border-radius: 0;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;box-sizing: border-box;}.ace_line .ace_fold {box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_inline_button {border: 1px solid lightgray;display: inline-block;margin: -1px 8px;padding: 0 5px;pointer-events: auto;cursor: pointer;}.ace_inline_button:hover {border-color: gray;background: rgba(200,200,200,0.2);display: inline-block;pointer-events: auto;}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}.ace_mobile-menu {position: absolute;line-height: 1.5;border-radius: 4px;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;background: white;box-shadow: 1px 3px 2px grey;border: 1px solid #dcdcdc;color: black;}.ace_dark > .ace_mobile-menu {background: #333;color: #ccc;box-shadow: 1px 3px 2px grey;border: 1px solid #444;}.ace_mobile-button {padding: 2px;cursor: pointer;overflow: hidden;}.ace_mobile-button:hover {background-color: #eee;opacity:1;}.ace_mobile-button:active {background-color: #ddd;}.ace_placeholder {font-family: arial;transform: scale(0.9);transform-origin: left;white-space: pre;opacity: 0.7;margin: 0 10px;}
/*# sourceURL=ace/css/ace_editor.css */</style><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link href="exercise_files/css.css" rel="stylesheet"><link href="exercise_files/jquery.css" rel="stylesheet"><title>StrataScratch</title><script type="text/javascript" async="" src="exercise_files/analytics.js"></script><script type="text/javascript" async="" src="exercise_files/js_002"></script><script>!function(n,u){n._rwq=u,n[u]=n[u]||function(){(n[u].q=n[u].q||[]).push(arguments)}}(window,"rewardful")</script><script async="" src="exercise_files/rw.js" data-rewardful="509d71"></script><script async="" src="exercise_files/js"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-115949776-1")</script><link rel="shortcut icon" href="https://platform.stratascratch.com/fav.png"><link href="exercise_files/stylesd7ef1007257ddee643e8.css" rel="stylesheet"><style>.strata-editor-dragbar {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 12px;
  cursor: row-resize;
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9FZGl0b3JEcmFnQmFyLmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQWE7RUFDYix1QkFBdUI7RUFDdkIsbUJBQW1CO0VBQ25CLFlBQVk7RUFDWixrQkFBa0I7QUFDcEIiLCJzb3VyY2VzQ29udGVudCI6WyIuc3RyYXRhLWVkaXRvci1kcmFnYmFyIHtcbiAgZGlzcGxheTogZmxleDtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGhlaWdodDogMTJweDtcbiAgY3Vyc29yOiByb3ctcmVzaXplO1xufVxuIl0sInNvdXJjZVJvb3QiOiIifQ== */</style><style>.strata-editor-container {
  position: relative;
  background-color: #f5f5f5;
  border-radius: 2px;
  border: 1px solid #ccc;
  margin-bottom: 1rem;
}

/* stylelint-disable-next-line selector-class-pattern */
.strata-editor-container .ace_editor {
  line-height: 1.4286;
  word-break: break-all;
  word-wrap: break-word;
  color: #333;
  font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;
}

/* stylelint-disable-next-line selector-class-pattern */
.ace-github .ace_print-margin {
  background: transparent !important;
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9Db2RlRWRpdG9yLmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGtCQUFrQjtFQUNsQix5QkFBeUI7RUFDekIsa0JBQWtCO0VBQ2xCLHNCQUFzQjtFQUN0QixtQkFBbUI7QUFDckI7O0FBRUEsdURBQXVEO0FBQ3ZEO0VBQ0UsbUJBQW1CO0VBQ25CLHFCQUFxQjtFQUNyQixxQkFBcUI7RUFDckIsV0FBVztFQUNYLDhEQUE4RDtBQUNoRTs7QUFFQSx1REFBdUQ7QUFDdkQ7RUFDRSxrQ0FBa0M7QUFDcEMiLCJzb3VyY2VzQ29udGVudCI6WyIuc3RyYXRhLWVkaXRvci1jb250YWluZXIge1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIGJhY2tncm91bmQtY29sb3I6ICNmNWY1ZjU7XG4gIGJvcmRlci1yYWRpdXM6IDJweDtcbiAgYm9yZGVyOiAxcHggc29saWQgI2NjYztcbiAgbWFyZ2luLWJvdHRvbTogMXJlbTtcbn1cblxuLyogc3R5bGVsaW50LWRpc2FibGUtbmV4dC1saW5lIHNlbGVjdG9yLWNsYXNzLXBhdHRlcm4gKi9cbi5zdHJhdGEtZWRpdG9yLWNvbnRhaW5lciAuYWNlX2VkaXRvciB7XG4gIGxpbmUtaGVpZ2h0OiAxLjQyODY7XG4gIHdvcmQtYnJlYWs6IGJyZWFrLWFsbDtcbiAgd29yZC13cmFwOiBicmVhay13b3JkO1xuICBjb2xvcjogIzMzMztcbiAgZm9udC1mYW1pbHk6IE1lbmxvLCBNb25hY28sIENvbnNvbGFzLCAnQ291cmllciBOZXcnLCBtb25vc3BhY2U7XG59XG5cbi8qIHN0eWxlbGludC1kaXNhYmxlLW5leHQtbGluZSBzZWxlY3Rvci1jbGFzcy1wYXR0ZXJuICovXG4uYWNlLWdpdGh1YiAuYWNlX3ByaW50LW1hcmdpbiB7XG4gIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50ICFpbXBvcnRhbnQ7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9 */</style><style>.strata-editor-extension {
  color: #fff;
  background-color: #ccc;
}

.strata-editor-caption-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 2px 9px;
  font-size: 1rem;
}

.strata-editor-dataset-tables {
  border-radius: 0.25rem;
  padding: 0 0.5rem;
  background-color: #b7e9f0;
  color: #249cac;
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9FZGl0b3JDYXB0aW9uQmFyLmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFdBQVc7RUFDWCxzQkFBc0I7QUFDeEI7O0FBRUE7RUFDRSxhQUFhO0VBQ2IsOEJBQThCO0VBQzlCLG1CQUFtQjtFQUNuQixnQkFBZ0I7RUFDaEIsZUFBZTtBQUNqQjs7QUFFQTtFQUNFLHNCQUFzQjtFQUN0QixpQkFBaUI7RUFDakIseUJBQXlCO0VBQ3pCLGNBQWM7QUFDaEIiLCJzb3VyY2VzQ29udGVudCI6WyIuc3RyYXRhLWVkaXRvci1leHRlbnNpb24ge1xuICBjb2xvcjogI2ZmZjtcbiAgYmFja2dyb3VuZC1jb2xvcjogI2NjYztcbn1cblxuLnN0cmF0YS1lZGl0b3ItY2FwdGlvbi1iYXIge1xuICBkaXNwbGF5OiBmbGV4O1xuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIHBhZGRpbmc6IDJweCA5cHg7XG4gIGZvbnQtc2l6ZTogMXJlbTtcbn1cblxuLnN0cmF0YS1lZGl0b3ItZGF0YXNldC10YWJsZXMge1xuICBib3JkZXItcmFkaXVzOiAwLjI1cmVtO1xuICBwYWRkaW5nOiAwIDAuNXJlbTtcbiAgYmFja2dyb3VuZC1jb2xvcjogI2I3ZTlmMDtcbiAgY29sb3I6ICMyNDljYWM7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9 */</style><style>.strata-editor-spin {
  animation: spin 1.5s infinite linear;
}

@keyframes spin {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9RdWVyeUJ1dHRvbi5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxvQ0FBb0M7QUFDdEM7O0FBRUE7RUFDRTtJQUNFLHVCQUF1QjtFQUN6Qjs7RUFFQTtJQUNFLHlCQUF5QjtFQUMzQjtBQUNGIiwic291cmNlc0NvbnRlbnQiOlsiLnN0cmF0YS1lZGl0b3Itc3BpbiB7XG4gIGFuaW1hdGlvbjogc3BpbiAxLjVzIGluZmluaXRlIGxpbmVhcjtcbn1cblxuQGtleWZyYW1lcyBzcGluIHtcbiAgZnJvbSB7XG4gICAgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7XG4gIH1cblxuICB0byB7XG4gICAgdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTtcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ== */</style><style>.strata-editor-buttons-wrapper {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  gap: 0.5rem;
}

.strata-editor-hotkey-message {
  margin-top: 0.25rem;
  color: rgb(130, 130, 130);
  font-size: 0.8125rem;
  text-align: right;
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9RdWVyeUJ1dHRvbnNTZWN0aW9uLmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQWE7RUFDYix5QkFBeUI7RUFDekIsbUJBQW1CO0VBQ25CLFdBQVc7QUFDYjs7QUFFQTtFQUNFLG1CQUFtQjtFQUNuQix5QkFBeUI7RUFDekIsb0JBQW9CO0VBQ3BCLGlCQUFpQjtBQUNuQiIsInNvdXJjZXNDb250ZW50IjpbIi5zdHJhdGEtZWRpdG9yLWJ1dHRvbnMtd3JhcHBlciB7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGdhcDogMC41cmVtO1xufVxuXG4uc3RyYXRhLWVkaXRvci1ob3RrZXktbWVzc2FnZSB7XG4gIG1hcmdpbi10b3A6IDAuMjVyZW07XG4gIGNvbG9yOiByZ2IoMTMwLCAxMzAsIDEzMCk7XG4gIGZvbnQtc2l6ZTogMC44MTI1cmVtO1xuICB0ZXh0LWFsaWduOiByaWdodDtcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0= */</style><style>.strata-editor-result-table {
  font-size: 1rem;
}

.table-striped.strata-editor-result-table tr.wrong {
  background-color: #ffb9b9;
}

.table-striped.strata-editor-result-table tr.correct {
  background-color: #90ee90;
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9RdWVyeVJlc3VsdFRhYmxlLmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGVBQWU7QUFDakI7O0FBRUE7RUFDRSx5QkFBeUI7QUFDM0I7O0FBRUE7RUFDRSx5QkFBeUI7QUFDM0IiLCJzb3VyY2VzQ29udGVudCI6WyIuc3RyYXRhLWVkaXRvci1yZXN1bHQtdGFibGUge1xuICBmb250LXNpemU6IDFyZW07XG59XG5cbi50YWJsZS1zdHJpcGVkLnN0cmF0YS1lZGl0b3ItcmVzdWx0LXRhYmxlIHRyLndyb25nIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmYjliOTtcbn1cblxuLnRhYmxlLXN0cmlwZWQuc3RyYXRhLWVkaXRvci1yZXN1bHQtdGFibGUgdHIuY29ycmVjdCB7XG4gIGJhY2tncm91bmQtY29sb3I6ICM5MGVlOTA7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9 */</style><style>.strata-editor-output-title {
  margin-top: 1rem;
  font-size: 1.1875rem;
  color: rgb(130, 130, 130);
}

.white-space-pre-wrap {
  white-space: pre-wrap;
}

.strata-editor-console-output {
  padding: 1rem 2rem;
}

.strata-editor-alert {
  padding: 0.75rem 1.25rem;
  margin-bottom: 1rem;
  font-size: 1rem;
  border-radius: 0.25rem;
}

.strata-editor-alert.info {
  background-color: #b7e9f0;
  color: #249cac;
}

.strata-editor-alert.warning {
  background-color: #fff3cd;
  color: #856404;
}

.strata-editor-alert.danger {
  background-color: #ffb9b9;
  color: #c60201;
}

.strata-editor-results-table-wrapper {
  max-height: 24rem;
  overflow: auto;
  white-space: nowrap;
}

.strata-editor-results-table-wrapper table {
  margin-bottom: 0;
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9FeGVjdXRpb25SZXN1bHRzLmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGdCQUFnQjtFQUNoQixvQkFBb0I7RUFDcEIseUJBQXlCO0FBQzNCOztBQUVBO0VBQ0UscUJBQXFCO0FBQ3ZCOztBQUVBO0VBQ0Usa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0Usd0JBQXdCO0VBQ3hCLG1CQUFtQjtFQUNuQixlQUFlO0VBQ2Ysc0JBQXNCO0FBQ3hCOztBQUVBO0VBQ0UseUJBQXlCO0VBQ3pCLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSx5QkFBeUI7RUFDekIsY0FBYztBQUNoQjs7QUFFQTtFQUNFLHlCQUF5QjtFQUN6QixjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsaUJBQWlCO0VBQ2pCLGNBQWM7RUFDZCxtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSxnQkFBZ0I7QUFDbEIiLCJzb3VyY2VzQ29udGVudCI6WyIuc3RyYXRhLWVkaXRvci1vdXRwdXQtdGl0bGUge1xuICBtYXJnaW4tdG9wOiAxcmVtO1xuICBmb250LXNpemU6IDEuMTg3NXJlbTtcbiAgY29sb3I6IHJnYigxMzAsIDEzMCwgMTMwKTtcbn1cblxuLndoaXRlLXNwYWNlLXByZS13cmFwIHtcbiAgd2hpdGUtc3BhY2U6IHByZS13cmFwO1xufVxuXG4uc3RyYXRhLWVkaXRvci1jb25zb2xlLW91dHB1dCB7XG4gIHBhZGRpbmc6IDFyZW0gMnJlbTtcbn1cblxuLnN0cmF0YS1lZGl0b3ItYWxlcnQge1xuICBwYWRkaW5nOiAwLjc1cmVtIDEuMjVyZW07XG4gIG1hcmdpbi1ib3R0b206IDFyZW07XG4gIGZvbnQtc2l6ZTogMXJlbTtcbiAgYm9yZGVyLXJhZGl1czogMC4yNXJlbTtcbn1cblxuLnN0cmF0YS1lZGl0b3ItYWxlcnQuaW5mbyB7XG4gIGJhY2tncm91bmQtY29sb3I6ICNiN2U5ZjA7XG4gIGNvbG9yOiAjMjQ5Y2FjO1xufVxuXG4uc3RyYXRhLWVkaXRvci1hbGVydC53YXJuaW5nIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjNjZDtcbiAgY29sb3I6ICM4NTY0MDQ7XG59XG5cbi5zdHJhdGEtZWRpdG9yLWFsZXJ0LmRhbmdlciB7XG4gIGJhY2tncm91bmQtY29sb3I6ICNmZmI5Yjk7XG4gIGNvbG9yOiAjYzYwMjAxO1xufVxuXG4uc3RyYXRhLWVkaXRvci1yZXN1bHRzLXRhYmxlLXdyYXBwZXIge1xuICBtYXgtaGVpZ2h0OiAyNHJlbTtcbiAgb3ZlcmZsb3c6IGF1dG87XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG59XG5cbi5zdHJhdGEtZWRpdG9yLXJlc3VsdHMtdGFibGUtd3JhcHBlciB0YWJsZSB7XG4gIG1hcmdpbi1ib3R0b206IDA7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9 */</style><style>.strata-editor-code-widget {
  margin-bottom: 2rem;
}

.strata-editor-question-link {
  font-size: 1rem;
}

.strata-editor-error-inset {
  position: absolute;
  inset: 1rem;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  background-color: #f2f2f2;
  font-weight: 500;
  z-index: 5;
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9Db2RlRWRpdG9yV2lkZ2V0LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLGVBQWU7QUFDakI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsV0FBVztFQUNYLGFBQWE7RUFDYixzQkFBc0I7RUFDdEIsdUJBQXVCO0VBQ3ZCLG1CQUFtQjtFQUNuQixrQkFBa0I7RUFDbEIseUJBQXlCO0VBQ3pCLGdCQUFnQjtFQUNoQixVQUFVO0FBQ1oiLCJzb3VyY2VzQ29udGVudCI6WyIuc3RyYXRhLWVkaXRvci1jb2RlLXdpZGdldCB7XG4gIG1hcmdpbi1ib3R0b206IDJyZW07XG59XG5cbi5zdHJhdGEtZWRpdG9yLXF1ZXN0aW9uLWxpbmsge1xuICBmb250LXNpemU6IDFyZW07XG59XG5cbi5zdHJhdGEtZWRpdG9yLWVycm9yLWluc2V0IHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBpbnNldDogMXJlbTtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgYmFja2dyb3VuZC1jb2xvcjogI2YyZjJmMjtcbiAgZm9udC13ZWlnaHQ6IDUwMDtcbiAgei1pbmRleDogNTtcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0= */</style><script src="exercise_files/v3"></script><meta name="description" content="StrataScratch" data-react-helmet="true"><style data-emotion="css" data-s=""></style></head><body style="" class=""><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><header class="top" style="position: relative; z-index: 1000;"><nav class="navbar-static-top navbar-inverse navbar navbar-expand-md navbar-light"><a href="https://stratascratch.com/" class="navbar-brand"><img src="exercise_files/superset-logo.png" alt="Superset Logo" width="126"></a><button aria-controls="basic-navbar-nav" type="button" aria-label="Toggle navigation" class="navbar-toggler collapsed" style=""><span class="navbar-toggler-icon"></span></button><div class="navbar-collapse collapse" id="basic-navbar-nav"><div class="mr-auto navbar-nav"><li><a href="https://platform.stratascratch.com/coding" data-rb-event-key="/coding" class="navbar-marging nav-link">Coding Questions</a></li><li><a href="https://platform.stratascratch.com/technical" data-rb-event-key="/technical" class="navbar-marging nav-link">Non-coding Questions</a></li></div><div class="navbar-nav"><li><a href="https://platform.stratascratch.com/pricing" data-rb-event-key="/pricing" class="navbar-marging nav-link"><i class="fa fa-lock" style="color: gold;"></i> Upgrade to Premium</a></li><li class="float-right"><div class="dropdown"><a href="" class="navbar-marging nav-link"><i class="fa fa-user"></i> Profile</a></div></li><li class="float-right"><a href="#" class="navbar-marging nav-link" role="button"><i class="fa fa-fw fa-sign-out"></i> Logout</a></li></div></div></nav></header><main class=""><div class="container-fluid"><div class="row"><div class="col-md-12" style="padding-left: 5%; padding-right: 5%;"><div class="row"><div class="col-md-12"><a style="margin-right: 20px;" href="https://platform.stratascratch.com/coding">Back to Questions</a><select class="custom-select-option select-language" name="language"><option value="1" selected="selected">PostgreSQL</option><option value="2">Python</option><option value="3">MySQL (βeta)</option></select><span style="margin-left: 30px;"><a href="https://platform.stratascratch.com/coding/10352-users-by-avg-session-time?python=" class="btn" style="color: green; margin-top: 4px; margin-right: 6px; font-size: 20px;"><i class="fa fa-arrow-left"></i></a><div class="question-select css-b62m3t-container"><span id="react-select-4-live-region" class="css-7pg0cj-a11yText"></span><span aria-live="polite" aria-atomic="false" aria-relevant="additions text" class="css-7pg0cj-a11yText"></span><div class=" css-1s2u09g-control"><div class=" css-1d8n9bt"><div class=" css-qc6sy-singleValue">Highest Cost Orders</div><div class=" css-ackcql" data-value=""><input class="" style="color: inherit; background: rgba(0, 0, 0, 0) none repeat scroll 0px center; opacity: 1; width: 100%; grid-area: 1 / 2; font: inherit; min-width: 2px; border: 0px none; margin: 0px; outline: currentcolor none 0px; padding: 0px;" autocapitalize="none" autocomplete="off" autocorrect="off" id="react-select-4-input" spellcheck="false" tabindex="0" type="text" aria-autocomplete="list" aria-expanded="false" aria-haspopup="true" aria-controls="react-select-4-listbox" aria-owns="react-select-4-listbox" role="combobox"></div></div><div class=" css-1wy0on6"><span class=" css-1okebmr-indicatorSeparator"></span><div class=" css-tlfecz-indicatorContainer" aria-hidden="true"><svg height="20" width="20" viewBox="0 0 20 20" aria-hidden="true" focusable="false" class="css-8mmkcg"><path d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"></path></svg></div></div></div></div><a href="https://platform.stratascratch.com/coding/10319-monthly-percentage-difference?python=" class="btn" style="color: green; margin-top: 4px; margin-left: 6px; font-size: 20px;"><i class="fa fa-arrow-right"></i></a></span></div></div><div class="row m-t-10"><div class="col-md-6"><div class="m-t-10" style="overflow: hidden scroll;"><div class=""><div><ul class="left_side_tab nav nav-tabs" role="tablist"><li class="nav-item"><a href="#" role="tab" data-rb-event-key="question" id="question-details-tabs-tab-question" aria-controls="question-details-tabs-tabpane-question" aria-selected="true" class="nav-link active">Question</a></li><li class="nav-item"><a href="#" role="tab" data-rb-event-key="submissions" id="question-details-tabs-tab-submissions" aria-controls="question-details-tabs-tabpane-submissions" aria-selected="false" class="nav-link">Your Submissions</a></li><li class="nav-item"><a href="#" role="tab" data-rb-event-key="comments" id="question-details-tabs-tab-comments" aria-controls="question-details-tabs-tabpane-comments" aria-selected="false" class="nav-link">Solution Discussions</a></li><li class="nav-item"><a href="#" role="tab" data-rb-event-key="solutions" id="question-details-tabs-tab-solutions" aria-controls="question-details-tabs-tabpane-solutions" aria-selected="false" class="nav-link">Solutions from Users</a></li></ul><div class="tab-content"><div id="question-details-tabs-tabpane-question" aria-labelledby="question-details-tabs-tab-question" role="tabpanel" aria-hidden="false" class="fade tab-pane active show"><div class="m-t-10" style="max-height: 1045px;"><div class="row m-0"><button type="button" title="Bookmark this question" class="bookmark" style="margin-right: 10px;"><i class="fa fa-lg fa-bookmark-o" aria-hidden="true"></i></button><div><div class="badge badge-pill badge-orange">Medium</div><div class="badge badge-pill badge-primary m-l-5">Amazon</div><span class="badge badge-pill m-l-5 badge-info">Interview Questions</span><div class="badge badge-pill m-l-5 badge-secondary">ID 9915</div></div><div style="align-self: center; margin-left: auto;" class="hotkey-message">Interview Question Date: May 2019</div></div><div class="short_question_text m-t-10">Highest Cost Orders</div><div class="m-t-5 question_text preserve-linebreaks">Find the customer with the highest daily total order cost between 2019-02-01 to 2019-05-01. If customer had more than one order on a certain day, sum the order costs on daily basis. Output their first name, total cost of their items, and the date.
 
 For simplicity, you can assume that every first name in the dataset is unique.</div><div role="alert" class="fade m-t-20 question-alert alert alert-info show"><div>Tables: customers, orders</div></div></div><button type="button" class="m-t-10 btn btn-sm btn-primary">Approach Hints</button><button type="button" class="m-t-10 m-l-10 btn btn-sm btn-primary">Expected Output</button><div class="hint hint_text m-t-20">- Find the total order cost by multiplying the order cost by the quantity, then group this by customer id and order date. 
- Find the max total order cost from all the order dates and customers
- You'll next want to join the order and customer tables and calculate the sum of total order cost by first name and order date with a condition that the sum matches the max total order cost you found in the 2nd step.</div></div><div id="question-details-tabs-tabpane-comments" aria-labelledby="question-details-tabs-tab-comments" role="tabpanel" aria-hidden="true" class="fade tab-pane"><div style="max-height: 1045px;"><div><div class="strata-editor-container"><div id="ace-editor" style="width: 100%; height: 478px; font-size: 0.8125rem;" class=" ace_editor ace-github" draggable="false"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; font-size: 1px; top: 209px; left: 100px; height: 1px; width: 1px;" readonly="readonly" wrap="off">   FROM
     (SELECT sum(total_order_cost) AS total_order_cost

</textarea><div class="ace_gutter" aria-hidden="true" style="left: 0px; width: 47px;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1000000px; top: 0px; left: 0px; width: 47px;"><div class="ace_gutter-cell " style="height: 19px; top: 0px;">1<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 19px;">2<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 38px;">3<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 57px;">4<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 76px;">5<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 95px;">6<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 114px;">7<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 133px;">8<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 152px;">9<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 171px;">10<span style="display: none;"></span></div><div class="ace_gutter-active-line ace_gutter-cell " style="height: 19px; top: 190px;">11<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 209px;">12<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 228px;">13<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 247px;">14<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 266px;">15<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 285px;">16<span style="display: none;"></span></div></div></div><div class="ace_scroller" style="line-height: 19px; left: 47px; right: 0px; bottom: 0px;"><div class="ace_content" style="top: 0px; left: 0px; width: 755px; height: 516px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 564px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div style="height: 19px; right: 0px; top: 190px; left: 53px;" class="ace_selection ace_br1 ace_start"></div><div style="height: 19px; width: 161px; top: 209px; left: 4px;" class="ace_selection ace_br12"></div></div><div class="ace_layer ace_text-layer" style="height: 1000000px; margin: 0px 4px; top: 0px; left: 0px;"><div style="height: 19px; top: 0px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">SELECT</span> <span class="ace_identifier">first_name</span>,</div></div><div style="height: 19px; top: 19px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span>   <span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">total_order_cost</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">AS</span> <span class="ace_identifier">total_order_cost</span>,</div></div><div style="height: 19px; top: 38px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span>   <span class="ace_identifier">order_date</span></div></div><div style="height: 19px; top: 57px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">FROM</span> <span class="ace_identifier">orders</span> <span class="ace_identifier">o</span></div></div><div style="height: 19px; top: 76px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">LEFT</span> <span class="ace_keyword">JOIN</span> <span class="ace_identifier">customers</span> <span class="ace_identifier">c</span> <span class="ace_keyword">ON</span> <span class="ace_identifier">o</span>.<span class="ace_identifier">cust_id</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">c</span>.<span class="ace_identifier">id</span></div></div><div style="height: 19px; top: 95px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">WHERE</span> <span class="ace_identifier">order_date</span> <span class="ace_identifier">BETWEEN</span> <span class="ace_string">'2019-02-1'</span> <span class="ace_keyword">AND</span> <span class="ace_string">'2019-05-1'</span></div></div><div style="height: 19px; top: 114px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">GROUP</span> <span class="ace_keyword">BY</span> <span class="ace_identifier">first_name</span>,</div></div><div style="height: 19px; top: 133px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span> <span class="ace_identifier">order_date</span></div></div><div style="height: 19px; top: 152px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">HAVING</span> <span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">total_order_cost</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">=</span></div></div><div style="height: 19px; top: 171px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">  <span class="ace_paren ace_lparen">(</span><span class="ace_keyword">SELECT</span> <span class="ace_support ace_function">max</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">total_order_cost</span><span class="ace_paren ace_rparen">)</span></div></div><div style="height: 19px; top: 190px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">   <span class="ace_keyword">FROM</span></div></div><div style="height: 19px; top: 209px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span> <span class="ace_paren ace_lparen">(</span><span class="ace_keyword">SELECT</span> <span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">total_order_cost</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">AS</span> <span class="ace_identifier">total_order_cost</span></div></div><div style="height: 19px; top: 228px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span>  <span class="ace_keyword">FROM</span> <span class="ace_identifier">orders</span></div></div><div style="height: 19px; top: 247px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span>  <span class="ace_keyword">WHERE</span> <span class="ace_identifier">order_date</span> <span class="ace_identifier">BETWEEN</span> <span class="ace_string">'2019-02-1'</span> <span class="ace_keyword">AND</span> <span class="ace_string">'2019-05-1'</span></div></div><div style="height: 19px; top: 266px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span>  <span class="ace_keyword">GROUP</span> <span class="ace_keyword">BY</span> <span class="ace_identifier">cust_id</span>,</div></div><div style="height: 19px; top: 285px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>   <span class="ace_identifier">order_date</span><span class="ace_paren ace_rparen">)</span> <span class="ace_identifier">b</span><span class="ace_paren ace_rparen">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="display: block; top: 190px; left: 53px; width: 7px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px; display: none;"><div class="ace_scrollbar-inner" style="width: 22px; height: 304px;">&nbsp;</div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 47px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 785px;">&nbsp;</div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה</div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div class="strata-editor-extension strata-editor-dragbar" role="separator"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg></div></div><hr><button type="button" class="bg-none btn-link-borderless"><h5 class="resources-header"><i class="fa fa-lg fa-angle-double-up font-weight-bold" aria-hidden="true"></i><span style="margin-left: 10px;">Resources</span></h5></button><h5 class="resources-sub-header"><span class="resources-title">Resources For This Question</span></h5><div class="row" style="margin-left: 15px; padding-bottom: 15px;"><a style="margin-right: 20px;" class="resource-item" target="_blank" rel="noopener noreferrer"><i class="fa fa-video-camera" aria-hidden="true" style="margin-right: 5px;"></i>Video Solution for SQL</a></div><h5 class="resources-sub-header"><span class="resources-title">Resources For All Interview Questions</span></h5><div class="row" style="margin-left: 15px;"><a style="margin-right: 20px;" class="resource-item" target="_blank" rel="noopener noreferrer" href="https://www.stratascratch.com/blog/how-to-answer-data-science-coding-interview-questions/">How to Answer Data Science Coding Interview Questions</a><a style="margin-right: 20px;" class="resource-item" target="_blank" rel="noopener noreferrer" href="https://www.stratascratch.com/blog/best-practices-to-write-sql-queries-how-to-structure-your-code/">Best Practices to Write SQL Queries: How To Structure Your Code</a><a style="margin-right: 20px;" class="resource-item" target="_blank" rel="noopener noreferrer" href="https://www.stratascratch.com/blog/python-pandas-interview-questions-for-data-science/">Python Pandas Interview Questions for Data Science</a><a style="margin-right: 20px;" class="resource-item" target="_blank" rel="noopener noreferrer" href="https://www.stratascratch.com/blog/python-pandas-interview-questions-for-data-science-part-2/">Python Pandas Interview Questions for Data Science (Part 2)</a></div></div><div><hr><div class="comment-form"><div class="react-mde react-mde-tabbed-layout"><div class="mde-header"><div class="mde-tabs"><button type="button" class="selected">Write</button><button type="button" class="">Preview</button></div><ul class="mde-header-group"><li class="mde-header-item"><button data-name="header" tabindex="-1" aria-label="Add header" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="heading" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M496 80V48c0-8.837-7.163-16-16-16H320c-8.837 0-16 7.163-16 16v32c0 8.837 7.163 16 16 16h37.621v128H154.379V96H192c8.837 0 16-7.163 16-16V48c0-8.837-7.163-16-16-16H32c-8.837 0-16 7.163-16 16v32c0 8.837 7.163 16 16 16h37.275v320H32c-8.837 0-16 7.163-16 16v32c0 8.837 7.163 16 16 16h160c8.837 0 16-7.163 16-16v-32c0-8.837-7.163-16-16-16h-37.621V288H357.62v128H320c-8.837 0-16 7.163-16 16v32c0 8.837 7.163 16 16 16h160c8.837 0 16-7.163 16-16v-32c0-8.837-7.163-16-16-16h-37.275V96H480c8.837 0 16-7.163 16-16z"></path></svg></button></li><li class="mde-header-item"><button data-name="bold" tabindex="-1" aria-label="Add bold text" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="bold" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" data-fa-i2svg=""><path fill="currentColor" d="M304.793 243.891c33.639-18.537 53.657-54.16 53.657-95.693 0-48.236-26.25-87.626-68.626-104.179C265.138 34.01 240.849 32 209.661 32H24c-8.837 0-16 7.163-16 16v33.049c0 8.837 7.163 16 16 16h33.113v318.53H24c-8.837 0-16 7.163-16 16V464c0 8.837 7.163 16 16 16h195.69c24.203 0 44.834-1.289 66.866-7.584C337.52 457.193 376 410.647 376 350.014c0-52.168-26.573-91.684-71.207-106.123zM142.217 100.809h67.444c16.294 0 27.536 2.019 37.525 6.717 15.828 8.479 24.906 26.502 24.906 49.446 0 35.029-20.32 56.79-53.029 56.79h-76.846V100.809zm112.642 305.475c-10.14 4.056-22.677 4.907-31.409 4.907h-81.233V281.943h84.367c39.645 0 63.057 25.38 63.057 63.057.001 28.425-13.66 52.483-34.782 61.284z"></path></svg></button></li><li class="mde-header-item"><button data-name="italic" tabindex="-1" aria-label="Add italic text" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="italic" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" data-fa-i2svg=""><path fill="currentColor" d="M204.758 416h-33.849l62.092-320h40.725a16 16 0 0 0 15.704-12.937l6.242-32C297.599 41.184 290.034 32 279.968 32H120.235a16 16 0 0 0-15.704 12.937l-6.242 32C96.362 86.816 103.927 96 113.993 96h33.846l-62.09 320H46.278a16 16 0 0 0-15.704 12.935l-6.245 32C22.402 470.815 29.967 480 40.034 480h158.479a16 16 0 0 0 15.704-12.935l6.245-32c1.927-9.88-5.638-19.065-15.704-19.065z"></path></svg></button></li><li class="mde-header-item"><button data-name="strikethrough" tabindex="-1" aria-label="Add strikethrough text" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="strikethrough" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M496 288H16c-8.837 0-16-7.163-16-16v-32c0-8.837 7.163-16 16-16h480c8.837 0 16 7.163 16 16v32c0 8.837-7.163 16-16 16zm-214.666 16c27.258 12.937 46.524 28.683 46.524 56.243 0 33.108-28.977 53.676-75.621 53.676-32.325 0-76.874-12.08-76.874-44.271V368c0-8.837-7.164-16-16-16H113.75c-8.836 0-16 7.163-16 16v19.204c0 66.845 77.717 101.82 154.487 101.82 88.578 0 162.013-45.438 162.013-134.424 0-19.815-3.618-36.417-10.143-50.6H281.334zm-30.952-96c-32.422-13.505-56.836-28.946-56.836-59.683 0-33.92 30.901-47.406 64.962-47.406 42.647 0 64.962 16.593 64.962 32.985V136c0 8.837 7.164 16 16 16h45.613c8.836 0 16-7.163 16-16v-30.318c0-52.438-71.725-79.875-142.575-79.875-85.203 0-150.726 40.972-150.726 125.646 0 22.71 4.665 41.176 12.777 56.547h129.823z"></path></svg></button></li></ul><ul class="mde-header-group"><li class="mde-header-item"><button data-name="link" tabindex="-1" aria-label="Add a link" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></button></li><li class="mde-header-item"><button data-name="quote" tabindex="-1" aria-label="Insert a quote" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="quote-right" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M512 80v128c0 137.018-63.772 236.324-193.827 271.172-15.225 4.08-30.173-7.437-30.173-23.199v-33.895c0-10.057 6.228-19.133 15.687-22.55C369.684 375.688 408 330.054 408 256h-72c-26.51 0-48-21.49-48-48V80c0-26.51 21.49-48 48-48h128c26.51 0 48 21.49 48 48zM176 32H48C21.49 32 0 53.49 0 80v128c0 26.51 21.49 48 48 48h72c0 74.054-38.316 119.688-104.313 143.528C6.228 402.945 0 412.021 0 422.078v33.895c0 15.762 14.948 27.279 30.173 23.199C160.228 444.324 224 345.018 224 208V80c0-26.51-21.49-48-48-48z"></path></svg></button></li><li class="mde-header-item"><button data-name="code" tabindex="-1" aria-label="Insert code" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="code" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" data-fa-i2svg=""><path fill="currentColor" d="M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"></path></svg></button></li><li class="mde-header-item"><button data-name="image" tabindex="-1" aria-label="Add image" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="image" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"></path></svg></button></li></ul><ul class="mde-header-group"><li class="mde-header-item"><button data-name="unordered-list" tabindex="-1" aria-label="Add unordered list" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="list-ul" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M96 96c0 26.51-21.49 48-48 48S0 122.51 0 96s21.49-48 48-48 48 21.49 48 48zM48 208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm0 160c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm96-236h352c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path></svg></button></li><li class="mde-header-item"><button data-name="ordered-list" tabindex="-1" aria-label="Add ordered list" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="list-ol" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M3.263 139.527c0-7.477 3.917-11.572 11.573-11.572h15.131V88.078c0-5.163.534-10.503.534-10.503h-.356s-1.779 2.67-2.848 3.738c-4.451 4.273-10.504 4.451-15.666-1.068l-5.518-6.231c-5.342-5.341-4.984-11.216.534-16.379l21.72-19.938C32.815 33.602 36.732 32 42.785 32H54.89c7.656 0 11.749 3.916 11.749 11.572v84.384h15.488c7.655 0 11.572 4.094 11.572 11.572v8.901c0 7.477-3.917 11.572-11.572 11.572H14.836c-7.656 0-11.573-4.095-11.573-11.572v-8.902zM2.211 304.591c0-47.278 50.955-56.383 50.955-69.165 0-7.18-5.954-8.755-9.28-8.755-3.153 0-6.479 1.051-9.455 3.852-5.079 4.903-10.507 7.004-16.111 2.451l-8.579-6.829c-5.779-4.553-7.18-9.805-2.803-15.409C13.592 201.981 26.025 192 47.387 192c19.437 0 44.476 10.506 44.476 39.573 0 38.347-46.753 46.402-48.679 56.909h39.049c7.529 0 11.557 4.027 11.557 11.382v8.755c0 7.354-4.028 11.382-11.557 11.382h-67.94c-7.005 0-12.083-4.028-12.083-11.382v-4.028zM5.654 454.61l5.603-9.28c3.853-6.654 9.105-7.004 15.584-3.152 4.903 2.101 9.63 3.152 14.359 3.152 10.155 0 14.358-3.502 14.358-8.23 0-6.654-5.604-9.106-15.934-9.106h-4.728c-5.954 0-9.28-2.101-12.258-7.88l-1.05-1.926c-2.451-4.728-1.226-9.806 2.801-14.884l5.604-7.004c6.829-8.405 12.257-13.483 12.257-13.483v-.35s-4.203 1.051-12.608 1.051H16.685c-7.53 0-11.383-4.028-11.383-11.382v-8.755c0-7.53 3.853-11.382 11.383-11.382h58.484c7.529 0 11.382 4.027 11.382 11.382v3.327c0 5.778-1.401 9.806-5.079 14.183l-17.509 20.137c19.611 5.078 28.716 20.487 28.716 34.845 0 21.363-14.358 44.126-48.503 44.126-16.636 0-28.192-4.728-35.896-9.455-5.779-4.202-6.304-9.805-2.626-15.934zM144 132h352c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path></svg></button></li><li class="mde-header-item"><button data-name="checked-list" tabindex="-1" aria-label="Add checked list" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="tasks" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M208 132h288c8.8 0 16-7.2 16-16V76c0-8.8-7.2-16-16-16H208c-8.8 0-16 7.2-16 16v40c0 8.8 7.2 16 16 16zm0 160h288c8.8 0 16-7.2 16-16v-40c0-8.8-7.2-16-16-16H208c-8.8 0-16 7.2-16 16v40c0 8.8 7.2 16 16 16zm0 160h288c8.8 0 16-7.2 16-16v-40c0-8.8-7.2-16-16-16H208c-8.8 0-16 7.2-16 16v40c0 8.8 7.2 16 16 16zM64 368c-26.5 0-48.6 21.5-48.6 48s22.1 48 48.6 48 48-21.5 48-48-21.5-48-48-48zm92.5-299l-72.2 72.2-15.6 15.6c-4.7 4.7-12.9 4.7-17.6 0L3.5 109.4c-4.7-4.7-4.7-12.3 0-17l15.7-15.7c4.7-4.7 12.3-4.7 17 0l22.7 22.1 63.7-63.3c4.7-4.7 12.3-4.7 17 0l17 16.5c4.6 4.7 4.6 12.3-.1 17zm0 159.6l-72.2 72.2-15.7 15.7c-4.7 4.7-12.9 4.7-17.6 0L3.5 269c-4.7-4.7-4.7-12.3 0-17l15.7-15.7c4.7-4.7 12.3-4.7 17 0l22.7 22.1 63.7-63.7c4.7-4.7 12.3-4.7 17 0l17 17c4.6 4.6 4.6 12.2-.1 16.9z"></path></svg></button></li></ul></div><div class=""><div class="mde-textarea-wrapper"><textarea class="mde-text" style="height: 200px;" data-testid="text-area" placeholder="Discuss approaches to solutions here and get an active discussion going. You can also add markdown language to highlight code like ```select * from table_name```."></textarea></div></div></div> <br><button type="button" class="btn btn-sm btn-primary m-t-5"><i class="fa fa-paper-plane"></i> Post</button><a href="https://www.markdownguide.org/getting-started/" target="_blank" class="pull-right markdown-help" rel="noreferrer"><i class="fa fa-question-circle"></i></a></div><hr><div class="comments-tree"><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">8</span></div><div class="right"><b>Team@StrataScratch</b><br><small>12/16/2020, 4:16 AM</small><div class="badge badge-pill m-l-5 badge-secondary btn-gold comment-tag">Top</div></div></div><div class="bottom"><p>This
 question seems simple enough upon first glance but really tests your 
ability to think through real world scenarios and how those scenarios 
(i.e., edge cases) could translate into the data. The real test is if 
you can build a solution that handles all the scenarios. Most people 
will get this question wrong on the first try but kick themselves when 
they see the solution because it's so obvious once you see it.</p><p>Another solution that's simpler is this one below. I removed the subquery from the official solution and from the video.</p><pre><code>SELECT first_name,
       order_date,
       sum(order_cost * order_quantity) AS total_order_cost
FROM orders o
LEFT JOIN customers c ON o.cust_id = c.id
WHERE order_date BETWEEN '2019-02-1' AND '2019-05-1'
GROUP BY first_name,
         order_date
HAVING sum(order_cost * order_quantity) =
  (SELECT max(total_order_cost)
   FROM
     (SELECT sum(order_cost * order_quantity) AS total_order_cost
      FROM orders
      WHERE order_date BETWEEN '2019-02-1' AND '2019-05-1'
      GROUP BY cust_id,
               order_date) b )</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">5</span></div><div class="right"><b>karthik</b><br><small>6/26/2021, 2:12 PM</small></div></div><div class="bottom"><p>with agg_view as (
select A.first_name, B.order_date, SUM(B.order_cost * B.order_quantity) as cst from customers A join orders B
on A.id = B.cust_id
where B.order_date between '2019-02-01' and  '2019-05-01'
group by 1,2)</p><p>Select * from agg_view
where cst=(Select Max(cst) from agg_view)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>6/27/2021, 12:32 PM</small></div></div><div class="bottom"><p>Hi karthik,
Thanks for sharing your solution!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">5</span></div><div class="right"><b>andrewhunt</b><br><small>1/23/2021, 4:50 AM</small></div></div><div class="bottom"><p>For simplicity's sake, would it benefit the problem to have "order_cost" labeled as "item_cost"?</p><p>Unless
 I'm misunderstanding, it doesn't reflect the actual order cost, and 
creates a red herring because the actual sum needs to be calculated.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">2</span></div><div class="right"><b>Team@StrataScratch</b><br><small>1/23/2021, 5:51 AM</small></div></div><div class="bottom"><p>Yea
 you have a point in that the order column is really an item but the row
 itself is the order. The solution is also an order because you're 
summing the quantity and cost of each time and grouping by date and 
customer. It would probably be better to rename these columns but I kept
 them as is mainly because that's how it was presented on an interview 
at Amazon.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">1</span></div><div class="right"><b>priyansh1990</b><br><small>1/24/2022, 5:57 AM</small></div></div><div class="bottom"><p>I
 genuinely the moderators should make the question easy enough to 
understand, what does highest daily total order cost mean, I have also 
gone through other questions, the language it is explained is not 
succent. I seriously think you guys should explain the answer you are 
looking forward too, very confusing question language. Never had this 
issue on Leetcode, the question are not difficult.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>1/28/2022, 4:07 PM</small></div></div><div class="bottom"><p>Hi priyansh1990,</p><p>Thank
 you for your input, we value your opinion. And we agree, question 
readability is important and we want to improve it as much as we can. 
These questions are from actual interviews, so we're between improving 
question readability and leaving question in original form.</p><p>Do you maybe have an idea of how would you rephrase this question so it is more clear? Is maybe this a better option for you: <code>Find the person who spent the most money in one day between 2019-02-01 to 2019-05-01</code>? If not, we could use your help here!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">1</span></div><div class="right"><b>emilycoding</b><br><small>8/23/2021, 11:30 PM</small></div></div><div class="bottom"><p>with summary_ as (
select *,
    rank() over (order by total_order_cost desc) as rnk
from customers a
left join orders b
on a.id = b.cust_id
where order_date between '2019-02-01' and '2019-05-01')</p><p>select first<em>name,
    total_order_cost,
    order_date
from summary</em>
where rnk = 1</p><p>I used rank() function along with a cte table.  Does it make sense to you?</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>8/25/2021, 1:59 PM</small></div></div><div class="bottom"><p>Hi emilycoding,</p><p>Great solution, congratulations! Your solution is pretty readable and you've used window function perfectly.</p><p>Keep up the good work!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>iram</b><br><small>8/29/2021, 11:32 AM</small></div></div><div class="bottom"><p>do we also have to sum total_order_cost if they are on the same day for a customer?</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>8/29/2021, 1:12 PM</small></div></div><div class="bottom"><p>Hi iram,</p><p>Yes, we do! It's explained in the question: <code>...If customer had more than one order on a certain day, sum the order costs on daily basis...</code></p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>emilycoding</b><br><small>8/31/2021, 11:43 PM</small></div></div><div class="bottom"><p>Thank
 you, Marin! I have one more question. For this case, don't you think 
inner join makes more sense because we want to know the customer's name 
and their order details? Therefore this record supposed to be in both 
tables.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>9/2/2021, 6:55 PM</small></div></div><div class="bottom"><p>Hi emilycoding,</p><p>Your argument is valid and it indeed makes sense to use inner join. </p><p>In
 a real-world scenario, using left join also makes sense because it's 
possible that the highest total order is not related to any customer 
because of some error, and this solution will get you that information.</p><p>At interview always explain your solution so your interviewer knows why you picked one join over another etc.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>MasilliKitan</b><br><small>10/22/2021, 9:42 AM</small></div></div><div class="bottom"><p>İnitially
 I found same result, which was Mia, as emilycoding, it did not 
accpeted. Later, everything must be daily bases. then only cust_id = 7 
become correct solution.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>10/26/2021, 3:40 PM</small></div></div><div class="bottom"><p>Hi MasilliKitan,</p><p>Yes, dataset changed a little bit, and emilycoding solution had to be improved then (sum the data on daily basis)!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>PhilMeaup152</b><br><small>3/10/2022, 9:07 PM</small></div></div><div class="bottom"><p>hey thanks for the solution . my approach was the same just got confused :
( select *, rank() over (order by total_order_cost desc) 
why did not we use partition by. i was using that and getting the wrong answer</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>3/12/2022, 1:56 PM</small></div></div><div class="bottom"><p>Hi PhilMeaup152,</p><p>Can you share your full solution with us? So we 100% know why your answer was wrong, thanks!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>SalLadd155</b><br><small>3/13/2022, 1:29 AM</small></div></div><div class="bottom"><p>Sorry, in your code, i just see you rank the total_cost, but I don't see you sum them. 
Can you explain?</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>WilliePas-D'course155</b><br><small>3/14/2022, 9:23 AM</small></div></div><div class="bottom"><p>select * from (
select first_name , sum(total_order_cost) , order_date ,
rank() over ( order by sum(total_order_cost) desc) as rnk 
from customers c 
join 
orders o
on c.id =o.cust_id
where order_date between  '2019-02-01' and '2019-05-01'
group by first_name , order_date
) as x
where rnk =1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>LesTocleanup89</b><br><small>3/8/2022, 8:16 AM</small></div></div><div class="bottom"><p>select c.first_name, sum(o.total_order_cost) as total_order_cost1, o.order_date from customers c 
inner join orders o 
on c.id = o.cust_id
where o.order_date &gt; '2019-02-01' and o.order_date &lt; '2019-05-01'
group by o.order_date, c.first_name
order by total_order_cost1 desc limit 1;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>IsrealDifficult153</b><br><small>3/7/2022, 6:05 PM</small></div></div><div class="bottom"><p>with t1 as (select cust_id person_id, order_date date, sum(total_order_cost) as sum 
from orders 
where order_date between '2019-02-01' and '2019-05-01'
group by 1,2
order by sum desc
limit 1)</p><p>select customers.first_name, t1.sum as total_order_cost, t1.date as 'order_date'
from t1 join customers on t1.person_id=customers.id</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>lcorcodilos</b><br><small>3/4/2022, 7:32 PM</small></div></div><div class="bottom"><p>Second to last line of Python solution is redundant. One can just do the following if the Y-m-d format is really required:</p><pre><code class="language-python">result["order_date"] = result["order_date"].dt.strftime("%Y-%m-%d")</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>3/7/2022, 4:44 PM</small></div></div><div class="bottom"><p>Hi lcorcodilos,</p><p>Good catch. The whole line is not redundant, but only the part of converting the column to datetime.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Dmitriy_Debyolyy</b><br><small>3/4/2022, 2:32 PM</small></div></div><div class="bottom"><p>I went in a little other way by using CTE. And I partly got the right answer. </p><p>with total_order_list as(
select 
    c.first_name as name,
    c.id,
    sum(o.total_order_cost) as total_order,
    o.order_date as date
from customers c
join 
    orders o on c.id = o.cust_id
where o.order_date between '2019-02-01' and '2019-05-01'
group by 1,2,4)</p><p>select
    max(total_order)
from total_order_list;</p><p>BUT, there are some problems to put the name and date in the final output.
If anyone knows what I did wrong, text me please!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>3/7/2022, 4:33 PM</small></div></div><div class="bottom"><p>Hi Dmitriy_Debyolyy,</p><p>To have other columns in the final output you can use subquery or a join. You just need to modify your outer query. One example:</p><pre><code>select * from total_order_list where total_order = (SELECT max(total_order) FROM total_order_list);</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Senthil</b><br><small>2/26/2022, 5:01 AM</small></div></div><div class="bottom"><p>select first_name,sum(total_order_cost) as total_order_cost,order_date from customers c
join orders o on c.id = o.cust_id
where o.order_date between '2019-02-01' and '2019-05-01'
group by first_name,order_date
order by total_order_cost desc
limit 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>DorisNolongeropen115</b><br><small>2/25/2022, 9:22 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><pre><code>select
a.first_name,
sum(b.total_order_cost) as total_cost,
b.order_date
from customers as a
inner join orders b
    on a.id = b.cust_id
where b.order_date between '2019-02-01' and '2019-05-01'
group by a.first_name, b.order_date
order by total_cost desc
fetch first row only</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Wandering_AI</b><br><small>2/25/2022, 1:50 AM</small></div></div><div class="bottom"><p>This seems like the most efficient solution that accounts for ties between total daily order costs:
<code>WITH summed as (
    SELECT 
        SUM(total_order_cost) as daily_total, order_date, first_name
    FROM customers c
    JOIN orders o on o.cust_id = c.id
    WHERE order_date between '2019-02-01' and '2019-05-01'
    GROUP by order_date, first_name
    )
SELECT first_name, daily_total as total_order_cost, order_date
FROM summed s 
WHERE daily_total = (
    SELECT max(daily_total)
    FROM summed
)</code></p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>HoldenYorenose62</b><br><small>2/21/2022, 1:12 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">python</div></div></div><div class="bottom"><h1>Import your libraries</h1><p>import pandas as pd
orders<a href="">'order_date'</a> = pd.to_datetime(orders<a href="">'order_date'</a>).dt.strftime("%Y-%m-%d")
orders = orders.loc<a href="">(orders.order_date &gt;= '2019-02-01') | (orders.order_date &lt;= '2019-05-01')</a>.groupby(<a href="">'cust_id', 'order_date'</a>)<a href="">'total_order_cost'</a>.sum().reset_index()
orders = orders.loc<a href="">orders.total_order_cost == max(orders.total_order_cost)</a>
pd.merge(customers, orders, how='inner', left_on=<a href="">'id'</a>, right_on=<a href="">'cust_id'</a>)[<a href="">'first_name', 'total_order_cost', 'order_date'</a>]</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>HoldenYorenose62</b><br><small>2/21/2022, 1:05 AM</small></div></div><div class="bottom"><p>with cte as (
    select cust_id, order_date, sum(total_order_cost) as total_order
    from orders 
    where order_date between '2019-02-01' and '2019-05-01'
    group by cust_id,
    order_date
),
cte2 as (select * from cte where total_order = (select max(total_order) from cte))
select a.first_name, b.order_date, b.total_order
from customers a join cte2 b
on a.id = b.cust_id</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Mimi7</b><br><small>2/16/2022, 8:03 AM</small></div></div><div class="bottom"><p>#Calculate daily order cost
#identify customer with highest daily order cost</p><p>select 
    first_name, tot_order_cost_daily, order_date
from 
(select 
    c.id, c.first_name, o.order_date
    ,sum(total_order_cost) as tot_order_cost_daily
    ,rank() over (order by sum(total_order_cost) desc) as rnk
from customers c
left join orders o on c.id=o.cust_id
where order_date between '2019-02-01' and '2019-05-01'
group by 1,2,3)x
where rnk=1
;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>KarenLess25</b><br><small>2/13/2022, 4:50 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">python</div></div></div><div class="bottom"><p>import pandas as pd 
df1 = customers
df2 = orders
df2<a href="">'orders_date'</a> = pd.DatetimeIndex(df2<a href="">'order_date'</a>).date
df3 = df2[(df2<a href="">'order_date'</a>&gt;='2019-02-01') &amp;(df2<a href="">'order_date'</a>&lt;='2019-05-01')]
df4 =df3[<a href="">'cust_id','orders_date','total_order_cost'</a>].sort_values(<a href="">'cust_id','orders_date'</a>,ascending=<a href="">True,True</a>)
df5=df4.groupby(<a href="">'cust_id','orders_date'</a>)<a href="">'total_order_cost'</a>.sum().reset_index()
df6 = df5.sort_values('total_order_cost',ascending=False).head(1)
pd.merge(df1,df6,left_on='id',right_on='cust_id',how='inner')[<a href="">'first_name','orders_date','total_order_cost'</a>]</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>PeteMoss133</b><br><small>2/10/2022, 7:10 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>with temp as(
SELECT cust.first_name,sum(total_order_cost) as total_cost,ord.order_date
FROM customers cust
JOIN  orders ord
ON cust.id=ord.cust_id 
GROUP BY cust.first_name,ord.order_date
ORDER BY total_cost DESC
),
rnk_t as
(SELECT first_name,order_date,total_cost,rank() over(order by total_cost desc) AS rnk  FROM temp)
SELECT first_name,total_cost,order_date
FROM rnk_t
WHERE rnk=1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>SiddharthGiri</b><br><small>2/9/2022, 5:46 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>solved the problem with this query
with orderdetail as(
select first_name,order_date,count(order_date)total_orders,sum(total_order_cost)price from customers a
join orders b on  b.cust_id=a.id where order_date between  '2019-02-01' and '2019-05-01' 
group by first_name,order_date
order by first_name,order_date)</p><p>select first_name,price,order_date from orderdetail where total_orders&gt;1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>PhilMcCup124</b><br><small>2/7/2022, 9:24 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>select first_name,sum(total_order_cost) as sum_tot_order,order_date from
(select id,first_name from customers)a
join
(select cust_id,total_order_cost,order_date from orders)b
on a.id=b.cust_id
where order_date between '2019-02-01' and '2019-05-01'
group by order_date,first_name
order by sum_tot_order desc
offset 0 rows fetch next 1 row only</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>pr0crastinat1ng</b><br><small>1/29/2022, 4:28 PM</small></div></div><div class="bottom"><p>This solution was very easy, unsure why it is labelled 'hard'.
Find my solution below.</p><p>SELECT first_name,cust_id, order_date,SUM(total_order_cost) as 'Total_Cost'
FROM orders
JOIN customers
ON customers.id = orders.cust_id
WHERE order_date BETWEEN '2019-02-01' AND '2019-05-01'
GROUP BY cust_id, order_date
ORDER BY Total_Cost DESC
LIMIT 1;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>2/5/2022, 9:27 AM</small></div></div><div class="bottom"><p>Hi HarryPits123,</p><p>Difficulty is changed to MEDIUM, we think it's more appropriate. Thank you for your comment!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>gira</b><br><small>1/28/2022, 10:23 PM</small></div></div><div class="bottom"><p>with cte as
(select first_name, order_date, sum(total_order_cost) as total_sum from 
customers a join orders b on a.id = b.cust_id
where order_date between '2019-02-01' and '2019-05-01'
group by first_name, order_date)</p><p>select first_name, order_date, total_sum from cte 
where total_sum = (select max(total_sum) from cte)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>EileenTouda-Left125</b><br><small>1/26/2022, 4:27 AM</small></div></div><div class="bottom"><p>select order_date, first_name,total_cost
from
(
select o.order_date,c.first_name, sum(total_order_cost) as total_cost, rank() over(order by sum(total_order_cost) desc)
from customers c
join orders o
     on c.id = o.cust_id
where order_date between '2019-02-01' and '2019-05-01'
group by o.order_date,c.first_name
order by o.order_date,c.first_name
) a
where rank = 1;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Doj-i</b><br><small>1/24/2022, 8:15 PM</small></div></div><div class="bottom"><p>WITH orders_spring_2019 AS 
        (SELECT cust_id, order_date, SUM(total_order_cost) as total_cost 
        FROM orders
        GROUP BY cust_id, order_date
        HAVING order_date BETWEEN '2019-02-01' AND '2019-05-01')
SELECT c.first_name, o.total_cost, o.order_date
FROM customers c
JOIN orders_spring_2019 o
ON c.id = o.cust_id
WHERE o.total_cost = (SELECT MAX(o.total_cost) as max_cost
    FROM orders_spring_2019 o
    GROUP BY o.cust_id, o.order_date
    ORDER BY max_cost DESC
    LIMIT 1);</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>adwaittoro</b><br><small>1/17/2022, 6:59 PM</small></div></div><div class="bottom"><p>WITH cte as
(SELECT c.first_name,SUM(o.total_order_cost) as total,o.order_date
FROM customers c
JOIN orders o
ON c.id = o.cust_id
WHERE o.order_date BETWEEN '2019-02-01' AND '2019-05-01'
GROUP BY o.order_date,c.first_name)</p><p>SELECT *
FROM cte
ORDER BY total DESC LIMIT 1;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>CarrieMeehom112</b><br><small>1/16/2022, 11:45 PM</small></div></div><div class="bottom"><p>select 
c.first_name, sum(o.total_order_cost) as total_daily_cost, order_date
from
customers c
join
orders o
on 
c.id = o.cust_id
where order_date between '2019-02-1' and '2019-05-1'
group by c.first_name, o.order_date 
order by total_daily_cost desc
limit 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>SandyShores121</b><br><small>1/15/2022, 10:09 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>Select M.first_name, M.totaldaily, M.order_date
 From
    (
    Select T.first_name, T.totaldaily, Rank() over(Order by T.totaldaily Desc) AS rn, T.order_date
    From
        (
        Select sum(orders.total_order_cost) AS totaldaily, orders.order_date, customers.first_name
        From customers
        Inner join orders on orders.cust_id = customers.id
        Where orders.order_date between '2019-02-01' AND '2019-05-01'
        Group by orders.order_date
        ) AS T
    ) AS M
Where M.rn = 1;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>peter.phan1101</b><br><small>1/4/2022, 9:06 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">R</div></div></div><div class="bottom"><p>@  Team@StrataSratch,
Would it be possible to double-check the result in R for these questions?
library(tidyverse)
rank_table &lt;- customers %&gt;% 
                  inner_join(orders, by = c("id" = "cust_id")) %&gt;%
                  group_by(first_name, order_date) %&gt;%
                  summarize(total_order_cost = sum(total_order_cost)) %&gt;%
                  filter(order_date &gt;= '2019-02-01' &amp; order_date &lt;= '2019-05-01')</p><p>rank_table<a href=""> which.max(rank_table$total_order_cost), </a></p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>ValUation92</b><br><small>1/6/2022, 5:56 AM</small></div></div><div class="bottom"><p>WITH total_expenditure as (
    SELECT cust_id, order_date, sum(total_order_cost) as cost
    FROM orders
    WHERE order_date between cast('2019-02-01' as date) and cast('2019-05-01' as date)
    GROUP BY cust_id, order_date
)
SELECT c.first_name, e.order_date, e.cost as max_cost
from total_expenditure as e
left join customers as c on e.cust_id = c.id
where e.cost = (SELECT max(cost) from total_expenditure);</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>GambleLing112</b><br><small>1/5/2022, 11:51 PM</small></div></div><div class="bottom"><p>with vte as (select first_name, order_date,sum(total_order_cost) as total from customers
join orders on customers.id=cust_id
where order_date between '2019-02-01' and '2019-05-01'
group by first_name, order_date)
select * from vte
where total=(select max(total) from vte)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>CrystalCleer88</b><br><small>1/1/2022, 9:15 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">python</div></div></div><div class="bottom"><p>import pandas as pd</p><p>mergedf = pd.merge(orders,customers,left_on='cust_id',right_on='id',how='left')[<a href="">'order_date','first_name','total_order_cost'</a>]
groupdf = mergedf.groupby(by=<a href="">'first_name','order_date'</a>).sum().reset_index()
groupdf<a href="">'order_date'</a> = pd.to_datetime(groupdf<a href="">'order_date'</a>).dt.date
result = groupdf<a href="">groupdf.total_order_cost == groupdf.total_order_cost.max()</a>
result</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>JoanneBill109</b><br><small>12/23/2021, 6:13 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><pre><code>select d.first_name,d.total_order_cost,d.order_date
from (select  c.first_name,
        sum(case when count&gt;1 then total_order_cost else total_order_cost end) as total_order_cost,
        a.order_date,
        dense_rank()over(order by sum(case when count&gt;1 then total_order_cost else total_order_cost end) desc) rk
from customers c join 
(select *,count(order_date)over(partition by cust_id,order_date) count from orders)a on c.id = a.cust_id
where a.order_date between '2019-02-01' and '2019-05-01'
group by c.first_name,a.order_date)d
where rk =1</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>CarrieMeehom101</b><br><small>12/21/2021, 5:39 AM</small></div></div><div class="bottom"><p>From
 my POV, I feel that the description of the question is a bit ambiguous 
since it seems that the question asks us to calculate the total order 
cost <strong> between the specified dates</strong>. But after seeing the official answer, I realize that the question is asking us to find the highest cost orders on <strong>daily basis</strong> and the cost orders should be within the specified dates.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>12/23/2021, 7:56 PM</small></div></div><div class="bottom"><p>Hi CarrieMeehom101,</p><p>Thank you for your comment. I've added <code>daily</code> word to the so it is more clear on what you need to do.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>dwisjp</b><br><small>12/14/2021, 10:17 AM</small></div></div><div class="bottom"><p>with a as (select distinct cust_id,
        order_date,
        sum(total_order_cost) over (partition by order_date, cust_id) as total_cost
        from orders
        where order_date between '2019-02-01' AND '2019-05-01'
        order by total_cost desc)</p><pre><code>SELECT c.first_name,
        b.order_date,
        b.total_cost
    FROM (SELECT cust_id,
            order_date,
            total_cost,
            rank() over (ORDER BY total_cost DESC) AS ranking
        FROM a) b
    JOIN customers c ON b.cust_id = c.id
    WHERE ranking = 1</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>JoanneBill103</b><br><small>12/10/2021, 12:27 PM</small></div></div><div class="bottom"><p>with cte as( select a.first_name,sum(b.total_order_cost) as total_order_cost,b.order_date from customers a
join orders b on a.id = b.cust_id
where b.order_date between '2019-02-01' and '2019-05-01'
group by a.first_name,b.order_date )
select first_name,total_order_cost,order_date from cte
order by total_order_cost desc 
limit 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>JoanneBill103</b><br><small>12/10/2021, 12:27 PM</small></div></div><div class="bottom"><p>with cte as( select a.first_name,sum(b.total_order_cost) as total_order_cost,b.order_date from customers a
join orders b on a.id = b.cust_id
where b.order_date between '2019-02-01' and '2019-05-01'
group by a.first_name,b.order_date )
select first_name,total_order_cost,order_date from cte
order by total_order_cost desc 
limit 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>MistyShores97</b><br><small>12/5/2021, 10:52 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>select first_name,sum(total_order_cost) as total_order_cost,order_date
from orders o join customers c on o.cust_id=c.id
where o.order_date between '2019-02-01' and '2019-05-01'
group by first_name,order_date
order by total_order_cost desc
limit 1 ;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>MistyShores97</b><br><small>12/5/2021, 10:51 AM</small></div></div><div class="bottom"><p>select first_name,sum(total_order_cost) as total_order_cost,order_date
from orders o join customers c on o.cust_id=c.id
where o.order_date between '2019-02-01' and '2019-05-01'
group by first_name,order_date
order by total_order_cost desc
limit 1 ;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>CandiKane64</b><br><small>12/4/2021, 11:31 PM</small></div></div><div class="bottom"><p>SELECT a.first_name,SUM(b.total_order_cost) AS total_order_cost, b.order_date
FROM customers a
LEFT JOIN orders b
ON a.id=b.cust_id
WHERE b.order_date BETWEEN '2019-02-01' AND '2019-05-01'
GROUP BY 1,3
ORDER BY 2 DESC
LIMIT 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>MorrisLess99</b><br><small>12/3/2021, 9:30 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>with table1 as (select * , sum(total_order_cost) over(partition by cust_id,order_date)  as total_order_cost_daily from orders),</p><p>table2 as (select cust_id,order_date,total_order_cost_daily, max(total_order_cost_daily) over() as max_daily_cost from table1 ),</p><p>table3 as (select distinct * from table2 where total_order_cost_daily = max_daily_cost)</p><p>select first_name, total_order_cost_daily,order_date from customers join table3 on customers.id=table3.cust_id</p><p>/<em>select </em>, max(total_order_cost) over()  high_total_order from orders where order_date between  '2019-02-01' and '2019-05-01'*/</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>RoxanneStyx80</b><br><small>11/17/2021, 2:07 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>select a.first_name, a.total_order_cost, a.order_date
from
(
select c.first_name as first_name, o.order_date as order_date, sum(o.total_order_cost) as total_order_cost 
from customers c join orders o
    on c.id=o.cust_id
where order_date between '2019-02-01' and '2019-05-01'
group by first_name, order_date
) a
order by total_order_cost desc
limit 1;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>wiccawill420</b><br><small>11/16/2021, 8:42 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>This
 is my first "hard" question, and I was able to knock it out without 
error. I opted to use cte and rank() to allow for the potential of a 
potential tie for first place, and to practice those as I feel I'm 
weakest in those areas. The accepted solution also makes sense to me. 
I'm pretty proud of my solution.</p><pre><code>with cte as (
    select cust_id, order_date, sum(total_order_cost) as total_for_day
    from orders
    where order_date between '2019-02-01' and '2019-05-01'
    group by 1,2),
ranked as (
    select cust_id, order_date, total_for_day, 
    rank() over (order by total_for_day desc) as ranks
    from cte)
select r.first_name, l.total_for_day, l.order_date
from ranked l
inner join customers r on l.cust_id = r.id
where l.ranks = 1</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>11/19/2021, 1:37 PM</small></div></div><div class="bottom"><p>Hi wiccawill420,</p><p>Wow, good job. Just keep it up!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>AprilFirst94</b><br><small>11/11/2021, 7:59 PM</small></div></div><div class="bottom"><pre><code>select c.first_name,o.order_date,sum(total_order_cost) as total_cost from customers c , orders o where
c.id=o.cust_id and order_date between '2019-02-01' and '2019-05-01'
group by c.first_name,o.order_date
order by total_cost desc
limit 1</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>varlok</b><br><small>11/10/2021, 11:05 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>I
 know, there is no point using Group by here. But I was experimenting 
something &amp; getting an error saying column total_order_cost should 
be in group by or used in an aggregate function. I want to understand 
what's going on internally and why the logic is incorrect.
Let's say I have a table : </p><pre><code>name | date | category | cost,   
jill  | 2019-04-01 | pen | 10 , 
jill  | 2019-04-01 | pen | 40 , 
jill  | 2019-04-01 | coat | 20 , 
Farida | 2019-03-01 | coat | 25,
Farida | 2019-03-02 | coat | 15</code></pre><p>Writing the code as :</p><pre><code>select
	 first_name, cast(o_date as date), sum(cost) over(partition by first_name) as tot 
from tab1
group by 
        1,2;</code></pre><p>According to the query, first group by will be executed  which will give:</p><pre><code>Jill | 2019-04-01
Farida | 2019-03-01
Farida | 2019-03-02</code></pre><p>and then we are squashing the rows by taking sum of cost column but for every partition of first_name.</p><p>The code is working fine without group by clause. Please tell where am I logically incorrect?</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>11/13/2021, 2:12 PM</small></div></div><div class="bottom"><p>Hi varlock,</p><p>You can either do sum with group by:</p><pre><code>select
	 first_name, order_date::date, sum(total_order_cost) 
from customers join orders ON customers.id = orders.cust_id
group by 
        1,2;</code></pre><p>or sum with the window function:</p><pre><code>select
	 first_name, order_date::date, sum(total_order_cost) over(partition by first_name, order_date::date)
from customers join orders ON customers.id = orders.cust_id</code></pre><p>You can't combine both inside one query, and it doesn't make much sense.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>davidedesi</b><br><small>11/5/2021, 5:31 PM</small></div></div><div class="bottom"><p>Am I wrong or this table is different from the one shown in the Video Solution?</p><pre><code>**orders**
id
cust_id
order_date
order_details
total_order_cost</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>11/7/2021, 10:17 PM</small></div></div><div class="bottom"><p>Hi davidedesi,</p><p>Yes,
 table is slightly different. But it's similar enough so video solution 
still makes sense and can be helpful and we hope you'll find it helpful 
for this problem. </p><p>Good luck!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>WadeNeedeep89</b><br><small>10/31/2021, 4:55 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>/<em>
Approach:
1. transaction table, aggregate transaction by day, within those period
2. Join customer and trasaction table
3. select only top1 from the output with specific columns
Output: highest daily transaction amount between these dates
</em>/
with od as
(select cust_id,order_date,sum(total_order_cost) as total_order_cost
from orders o
where order_date between '2019-02-02' and '2019-05-01'
group by order_date,cust_id)</p><p>select c.first_name,d.total_order_cost,d.order_date
from od d
left join customers c on c.id=d.cust_id
order by total_order_cost desc
Limit 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>glebmikh</b><br><small>10/31/2021, 2:52 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">python</div></div></div><div class="bottom"><p>t = orders[orders<a href="">'order_date'</a>.between('2019-02-01','2019-05-01')].groupby(<a href="">'order_date','cust_id'</a>)<a href="">'total_order_cost'</a>.sum().sort_values(ascending=False).reset_index().merge(customers,left_on='cust_id',right_on='id')[<a href="">'first_name','order_date','total_order_cost',</a>].head(1)</p><p>t<a href="">'order_date'</a> = t<a href="">'order_date'</a>.dt.date</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>hectorv</b><br><small>10/26/2021, 7:13 AM</small></div></div><div class="bottom"><p>This solution is too complicated, please see my solution, where there is no need of subqueries or CTEs.</p><p>select c.id, c.first_name, o.order_date, sum(o.total_order_cost) as total_cost from customers as c
inner join orders o
on c.id = o.cust_id
where 
o.order_date between '2019-02-01' and '2019-05-01'
group by c.id, c.first_name, o.order_date
order by total_cost desc
limit 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>10/28/2021, 9:28 PM</small></div></div><div class="bottom"><p>Hi hectorv,</p><p>Your
 solution is more simple, but it is less robust. What if there is a tie 
in the dataset? E.g. two customers have exact same total order and their
 total order is the highest!</p><p>Your solution would output only one customer, while our solution outputs both customers!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>jollyrancher47</b><br><small>10/25/2021, 2:37 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><pre><code>WITH higest_total_order 
AS 
(SELECT  c.first_name, c.rnk, SUM(c.total_order_cost) as total_order_cost, c.order_date
FROM 
    (SELECT 
        a.id, 
        a.first_name, 
        rank() OVER (PARTITION BY a.first_name ORDER BY b.order_date DESC) as rnk,
        b.total_order_cost, b.order_date
    FROM customers a
    INNER JOIN orders b on b.cust_id = a.id) as c
    WHERE rnk =1
    GROUP BY 1,2,4)

SELECT  first_name, total_order_cost, order_date
FROM higest_total_order
WHERE order_date between  '2019-02-01' and '2019-05-01'
ORDER BY 2 desc
LIMIT 1</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>CliftonOwhere81</b><br><small>10/20/2021, 1:59 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">python</div></div></div><div class="bottom"><p>merge = customers.merge(orders, how = 'inner', left_on = 'id', right_on = 'cust_id')</p><p>duration = merge[(merge<a href="">'order_date'</a> &gt;= '2019-02-01 00:00:00') &amp; (merge<a href="">'order_date'</a> &lt;= '2019-05-01 00:00:00')]</p><p>group1 = duration.groupby(<a href="">'first_name', 'order_date'</a>)<a href="">'total_order_cost'</a>.sum().reset_index(name = 'total cost per day')</p><p>group2 = group1.groupby(<a href="">'first_name', 'order_date'</a>)<a href="">'total cost per day'</a>.max().reset_index()</p><p>sort = group2.sort_values('total cost per day', ascending = False)</p><p>highest = sort.head(1)</p><p>highest<a href="">'date'</a> = pd.to_datetime(highest<a href="">'order_date'</a>).dt.date</p><p>result = highest[<a href="">'first_name','date','total cost per day'</a>]</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Momin.maq</b><br><small>10/13/2021, 7:05 PM</small></div></div><div class="bottom"><p>with cte_1 as (
select first_name,order_date,sum(total_order_cost) 
from(select a.first_name,b.id,b.order_date,b.total_order_cost from customers a 
inner join orders b on a.id=b.cust_id
where b.order_date between '2019-02-01' and '2019-05-01') c
group by first_name,order_date),
cte_2 as (
select max(sum) as maxx from cte_1)
select cte_1.first_name,cte_1.order_date,cte_2.maxx
from cte_1  join cte_2 on cte_1.sum=cte_2.maxx</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>ashwin4ever</b><br><small>10/12/2021, 11:12 PM</small></div></div><div class="bottom"><pre><code>-- customer had more than one order on a certain day, sum the order costs on daily basis
WITH cust_cost_day AS (
SELECT
C.first_name,
o.order_date,
SUM(o.total_order_cost) AS total_order_cost

FROM customers C INNER JOIN orders O ON c.id = O.cust_id
GROUP BY
C.first_name,
o.order_date
ORDER BY c.first_name ),

--the customer with the highest total order cost
max_total_cost AS (
SELECT MAX(total_order_cost) AS highest_cost FROM cust_cost_day)

-- Find the customer with the highest total order cost between 2019-02-01 to 2019-05-01
SELECT
first_name,
total_order_cost,
order_date 
FROM cust_cost_day
WHERE order_date BETWEEN '2019-02-01' AND '2019-05-01'
GROUP BY
first_name,
total_order_cost,
order_date 
HAVING total_order_cost = (SELECT highest_cost FROM max_total_cost)</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>lavahammer</b><br><small>10/2/2021, 9:41 AM</small></div></div><div class="bottom"><p>I
 have used multiple CTE's to make the thought process more readable to 
me. Will using multiple CTE's be considered as an inefficient querying 
practice ?</p><p>WITH main AS
(SELECT c.first_name,o.order_date,SUM(o.total_order_cost) AS tot_cost
FROM customers c LEFT JOIN orders o 
on c.id = o.cust_id
WHERE o.order_date BETWEEN '2019-02-01' AND '2019-05-01'
GROUP BY 1,2),</p><p>main2 AS
(SELECT first_name,order_date,tot_cost,
SUM(tot_cost) OVER (PARTITION BY first_name) AS cum_tot
FROM main)</p><p>SELECT *
FROM main2
WHERE cum_tot IN (SELECT MAX(cum_tot) FROM main2)
ORDER BY tot_cost DESC
LIMIT 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>10/5/2021, 2:18 PM</small></div></div><div class="bottom"><p>Hi lavahammer,</p><p>Performance
 wise, using CTEs is same as using subqueries, they provide same 
information to the query optimizer. CTEs make queries readable and 
easier to understand, it's really a good practice to use them like you 
do!</p><p>Keep up the good work!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>PennyPincher35</b><br><small>9/29/2021, 2:27 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>Does this solution make sense? Am I missing any edge cases?</p><blockquote><blockquote><p>select * from
(
select c.first_name, sum(total_order_cost) as total_cost, order_date,
row_number() over (order by sum(total_order_cost) desc) from
customers c
left join orders o on
c.id = o.cust_id
where order_date between '2019-02-01'::date and '2019-05-01'::date
group by order_date, cust_id, c.first_name
order by 2 desc 
) a
where row_number = 1</p></blockquote></blockquote><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">1</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>10/2/2021, 1:39 PM</small></div></div><div class="bottom"><p>Hi PennyPincher35,</p><p>Your solution is pretty good! Only change I would do is usage or <code>rank</code> function instead of <code>row_number</code> function. In case there is a tie in the dataset <code>rank</code> would rnk=1 for all rows in a tie, <code>row_number</code> has that only for one row!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>BoEnarreau63</b><br><small>9/25/2021, 5:44 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>The
 input database need to add more total_order_cost per day, otherwise, I 
don't need sum(total_order_cost) and I still can get correct result</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>9/26/2021, 8:45 AM</small></div></div><div class="bottom"><p>Hi BoEnarreau63,</p><p>We'll work on that, thank you for your comment!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">1</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>9/26/2021, 10:31 PM</small></div></div><div class="bottom"><p>Hi BoEnarreau63,</p><p>Good news, we've added the edge case that ensures simple solutions that don't sum(total_order_cost) won't be correct!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Doug</b><br><small>9/25/2021, 4:58 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>This
 is the currently posted question below. And it didn't have 
order_quantity in the table. But I would have liked to see this part 
below touched on in the video solution since I wasn't sure how to 
interpret it or account for it. Ultimately, I found out that there were 
none that had multiple orders on the same date.</p><p>Find the customer 
with the highest total order cost between 2019-02-01 to 2019-05-01. If 
customer had more than one order on a certain day, <strong>sum the order costs on daily basis</strong>. Output their first name, total cost of their items, and the date.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>9/26/2021, 8:44 AM</small></div></div><div class="bottom"><p>Hi Doug,</p><p>It means that if e.g. on Friday user has two orders with 100 and 70 costs, but on Thursday it has one order with 150 cost. </p><p>Question: What is the day with highest total order cost?
Answer: It's Friday because summed up total cost is 170, which is bigger than Thursday's summed up total cost of 150!</p><p>I hope it's more clear now!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>vijayroy28</b><br><small>9/24/2021, 1:59 PM</small></div></div><div class="bottom"><p>Please let me know how is this solution? My solution was told it is correct</p><p>With sum_order_cte as(
select c.first_name,order_date,total_order_cost,
sum(total_order_cost)over(partition by c.first_name,order_date) as sum_order
from customers c left join orders o 
ON c.id=o.cust_id
where order_date between '2019-02-01' and '2019-05-01'
order by c.first_name asc,order_date asc)
select  first_name,sum_order,order_date from sum_order_cte
where sum_order in (select max(sum_order) from sum_order_cte)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>9/26/2021, 8:13 AM</small></div></div><div class="bottom"><p>Hi vijayroy28,</p><p>It's a pretty good and robust solution! Good job, keep it up!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Panchal</b><br><small>9/21/2021, 4:35 PM</small></div></div><div class="bottom"><p>Hi ,</p><p>is it ok if I create a solution like this(having multiple CTE for each step)?
in general, will the interviewer have any objections to such an approch?</p><pre><code>with dataset1 as (
select 
cust_id,order_date,sum(total_order_cost) as total_cost
from orders
where order_date between '2019-02-01' and '2019-05-01'
group by cust_id,order_date

),
dataset2 as (
select
cust_id,order_date, total_cost, rank()over(order by total_cost desc) as rnk
from dataset1
)
select 
first_name,total_cost as total_order_cost,order_date
from dataset2
left outer join customers
on id=cust_id
where rnk=1</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>9/24/2021, 1:30 PM</small></div></div><div class="bottom"><p>Hi Panchal,</p><p>It's perfectly ok if you do that. I prefer solutions like yours because they're easy to understand! Good job, keep it up!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Xusong1998</b><br><small>9/20/2021, 1:36 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>SELECT c.first_name, SUM(total_order_cost) AS total_order_cost, o.order_date FROM customers c
LEFT JOIN orders o
ON c.id = o.cust_id
WHERE order_date BETWEEN '2019-02-01'::date AND '2019-05-01'::date
GROUP BY 1,3
HAVING SUM(total_order_cost) = 
(SELECT MAX(total_c)
FROM
(SELECT c.first_name, o.order_date, SUM(total_order_cost) AS total_c FROM customers c
LEFT JOIN orders o
ON c.id = o.cust_id
WHERE order_date BETWEEN '2019-02-01'::date AND '2019-05-01'::date
GROUP BY 1,2) A);</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>WillowWisp70</b><br><small>9/16/2021, 4:32 AM</small></div></div><div class="bottom"><p>select c.first_name, SUM(total_order_cost) as total_cost, o.order_date
from customers c
LEFT JOIN orders o ON c.id = o.cust_id
WHERE order_date BETWEEN '2019-02-01' AND '2019-05-01'
GROUP BY o.order_date, c.first_name
ORDER BY total_cost DESC
LIMIT 1</p><p>this one might be faster than the provided solution as it requires less "table grabbing" as I would call it.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Matt@StrataScratch</b><br><small>9/20/2021, 10:01 PM</small></div></div><div class="bottom"><p>Hi WillowWisp70,
Thanks for sharing your solution!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>BarbBarion64</b><br><small>9/14/2021, 10:21 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>What would be wrong with this solution?</p><p>`--assumption: total order cost is sum of all costs per customer per day </p><p>--1. summarize based on customer, order date to get total cost for values filtered for 3 months
--2. filter to only the highest cost entry from above table</p><p>select first_name, total_cost,order_date 
from(
    select first_name, sum(total_order_cost)as total_cost,order_date,rank()over(order by sum(total_order_cost)desc)as rnk
    from orders o
    join customers c on c.id=o.cust_id
    where order_date between '02-01-2019' and '05-01-2019'
    group by cust_id,first_name,order_date
    order by total_cost desc
--limit 1
)t
where  rnk=1`</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>9/19/2021, 7:16 PM</small></div></div><div class="bottom"><p>Hi BarbBarion64,</p><p>Nothing is wrong with this solution! Great usage of <code>rank</code> function</p><p>Thank you for sharing it with us!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>hyena</b><br><small>9/10/2021, 11:58 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>Not a hard one. I would rate this one medium/easy.</p><p>The
 hardness of the question should be rated as how easy the simplest 
solution could be, not how complicated the solution could get. 
Otherwise, every problem could be rated as hard.</p><pre><code>select c.first_name, sum(o.total_order_cost) total_cost, o.order_date  
from customers c 
inner join orders o 
on c.id = o.cust_id 
where order_date between '2019-02-01' and '2019-05-01'
group by c.first_name, o.order_date
order by o.order_date desc
limit 1;</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>9/19/2021, 8:53 AM</small></div></div><div class="bottom"><p>Hi hyena,</p><p>Your
 solution is really simple and correct. But it has one problem, it's not
 robust. E.g. what if there is more than one customer with highest total
 order cost, there is a tie in other words. Your <code>LIMIT 1</code> would not output them both!</p><p>And
 robust solution (like ours) is more complex, that's why we rated this 
question as a hard one. It's somewhere between medium and hard in my 
honest opinion!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>hyena</b><br><small>9/20/2021, 5:28 PM</small></div></div><div class="bottom"><p>thanks for you reply. I didn't consider the possibility of a tie.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>DrewApicture41</b><br><small>9/9/2021, 7:20 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">python</div></div></div><div class="bottom"><p>Last part is different but using apply method to change the timestamp format to date</p><h1>Import your libraries</h1><p>import pandas as pd</p><h1>Start writing code</h1><p>df=pd.merge(customers,orders,how='left',left_on= 'id', right_on = 'cust_id')
df<a href="">'order_date'</a>= df<a href="">'order_date'</a>.apply(pd.to_datetime)
df=df[df<a href="">'order_date'</a>.between('2019-02-01','2019-05-01')]
df=df.groupby(<a href="">'first_name','order_date'</a>)<a href="">'total_order_cost'</a>.sum().reset_index().sort_values('total_order_cost',ascending=False)
df<a href="">'rank'</a>=df<a href="">'total_order_cost'</a>.rank(method='min',ascending=False)
df =df[df<a href="">'rank'</a>&lt;=1][<a href="">'first_name','total_order_cost','order_date'</a>]
df<a href="">"order_date"</a> = df<a href="">'order_date'</a>.apply(lambda x: x.date())
df</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>PhilItall-Theweigh67</b><br><small>9/8/2021, 12:19 AM</small></div></div><div class="bottom"><p>Hey there,
I got the same result with a query using dense_rank:</p><p>with tabelao 
as (select first_name, order_date, sum(total_order_cost) as 
total_order_cost, dense_rank() over (order by sum(total_order_cost) 
desc) as rank1 from customers A
inner join orders B
on A.id=B.cust_id
where order_date BETWEEN '2019-02-01' and '2019-05-01'
group by first_name, order_date
order by sum(total_order_cost) desc)
select first_name, total_order_cost, order_date from tabelao
where rank1=1;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>9/8/2021, 3:29 PM</small></div></div><div class="bottom"><p>Hi Theweigh67,</p><p>Great solution! Thank you for sharing it with us!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>kruf91</b><br><small>9/4/2021, 12:50 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">python</div></div></div><div class="bottom"><p>In what way can I achieve the same results using 'id_x' instead of first_name in groupby(<a href="">'first_name','order_date'</a>). I don't think it's prudent to groupby in using names, but I couldn't achieve the result using id_x.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>9/4/2021, 10:33 AM</small></div></div><div class="bottom"><p>Hi kruf91,</p><p>The question has the following assumption: <code>For simplicity, you can assume that every first name in the dataset is unique.</code></p><p>That's
 why the solution that's using id differs from the official solution, 
but it doesn't mean it's wrong! Always read questions carefully!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>aditya0721</b><br><small>8/29/2021, 10:09 AM</small></div></div><div class="bottom"><p>with cte as (
SELECT first_name 
,b.total_cost
,b.order_date 
,DENSE_RANK()OVER( order by total_cost DESC) as rnk 
from customers c 
INNER JOIN<br>(SELECT sum(total_order_cost) as total_cost 
,cust_id 
,order_date 
from orders o 
where order_date between '2019-02-01' and '2019-05-01'
group by 2,3
) b
ON  c.id=b.cust_id
)</p><p>Select first_name
,total_cost
,order_date
from cte 
where rnk =1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>iram</b><br><small>8/29/2021, 3:34 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><pre><code>with custcostforaday as(
select c.id,c.first_name,o.order_date,sum(o.total_order_cost) totalCost from customers c join orders o on c.id= o.cust_id
    where order_date between '2019-02-01'::date and '2019-05-01'::date
    group by 1,2,3
    order by totalCost desc
)
select first_name, totalcost, order_date from custcostforaday limit 1

``</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>8/29/2021, 9:36 AM</small></div></div><div class="bottom"><p>Hi iram_javed,</p><p>Your
 solution is correct! But even though it's correct it's not the most 
robust one, e.g. what will you output in case there is a tie in the 
highest total order costs? </p><p>You'll output only one customer, but probably you should output them all!</p><p>Best practice in questions like this is to use <code>rank</code> functions, and then to compare ranks!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>iram</b><br><small>8/29/2021, 11:29 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>Thanks
 for the feedback Marin- here is the SQL using rank, However, I am not 
sure if using CTE within subquery was a good solution.</p><p>select * from (</p><p>with custcostforaday as(
select c.id,c.first_name,o.order_date,max(o.total_order_cost) totalCost 
from customers c join orders o on c.id= o.cust_id
    where order_date between '2019-02-01'::date and '2019-05-01'::date
    group by 1,2,3
    order by totalCost desc
)
select id,first_name, totalcost, order_date,rank() over(order by totalCost desc)  as costRank
from custcostforaday )sub where costRank = 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>8/29/2021, 1:09 PM</small></div></div><div class="bottom"><p>This is a great solution iram,</p><p>Thank you for sharing it with us. </p><p><code>However, I am not sure if using CTE within subquery was a good solution.</code></p><p>In this case, it's justified, so it's not a problem.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>TeraDactyl64</b><br><small>8/27/2021, 3:27 PM</small></div></div><div class="bottom"><p>So I went with this approach, must more simple and would get you out of a hurry. Would an interviewer approve this solution?</p><p>select * from (select first_name,sum(total_order_cost),order_date from customers as c
left join orders as o on
c.id = o.cust_id
where order_date between '2019-02-01' and '2019-05-01'</p><p>group by 1,3
order by 2 desc) as a
limit 1;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>8/29/2021, 10:28 AM</small></div></div><div class="bottom"><p>Hi TereaDactyl64,</p><p>Your
 solution is correct! But even though it's correct it's not the most 
robust one, e.g. what will you output in case there is a tie in the 
highest total order costs? </p><p>You'll output only one customer, but probably you should output them all!</p><p>Best practice in questions like this is to use rank functions, and then to compare ranks!</p><p><code>Would an interviewer approve this solution?</code>
It depends on the interviewer but I think most of them will prefer 
robust solutions and solutions like this will slightly lower your chance
 of passing the interview</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Charan_sarap</b><br><small>8/21/2021, 1:02 PM</small></div></div><div class="bottom"><p>select first_name,total_order_cost,order_date from customers c
join orders o on o.cust_id = c.id
where c.id = (select cust_id from orders
where total_order_cost = (select max(total_order_cost) from orders))
order by total_order_cost desc
limit 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Charan_sarap</b><br><small>8/21/2021, 1:00 PM</small></div></div><div class="bottom"><p>#Try this it was accepted but, am wrong with logic</p><p>select first_name,total_order_cost,order_date from customers c
join orders o on o.cust_id = c.id
group by 1,2,3
having total_order_cost in (select max(total_order_cost) from orders)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Kat@StrataScratch</b><br><small>8/23/2021, 10:57 AM</small></div></div><div class="bottom"><p>Hi Charan_sarap,</p><p>thanks for sharing your solution, but you don't have to group by the 3rd column as it is already an aggregate value.</p><p>Another
 thing is that your solution didn't take into account date criteria, 
even if the dataset has no data for dates out of the criteria bound, you
 need to ensure your solution is robust and will work according to the 
criteria being asked.</p><p>final comment, we compare against <code>max</code> of <code>sum of orders</code> per <code>cust &amp; date</code> ..</p><p>kindly review our solution again and let us know if you still need further assistance.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>SueMii61</b><br><small>8/15/2021, 6:07 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>Now we see "total_order_cost" in the "Orders" table. We can make use of this field to find the max total order cost. </p><p>I don't see order quantity and order cost in the "Orders" table. Is this something related to updating the Orders table?</p><p>My solution is very simple: </p><p>SELECT 
        c.first_name,
        o.order_date,
        SUM(o.total_order_cost) as total_cost
FROM customers as c
INNER JOIN orders as o
on c.id = o.cust_id
WHERE o.order_date between '2019-02-01' AND '2019-05-01'
GROUP BY c.first_name,
         o.order_date
ORDER BY total_cost DESC LIMIT 1</p><p>and it retrieves the right answer as well. Can someone help on this?</p><p>Thanks</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Kat@StrataScratch</b><br><small>8/17/2021, 1:09 PM</small></div></div><div class="bottom"><p>Hi SueMii61,</p><p>Yes,
 we have updated our dataset.
Thanks for sharing your solution which is correct in our case here, but 
takes note that if you have more than one customer with max total order 
value .. limit will output only 1 depending on how your are listing the 
records.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>SueMii61</b><br><small>8/17/2021, 5:16 PM</small></div></div><div class="bottom"><p>Thank you for the response! It's good to know there are some edge cases we need to take care of..</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>heabvensEyes</b><br><small>8/11/2021, 9:01 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>I don't understand the need for complexity in codes maybe because am new to sql but here is what I consider a simple solution...
select first_name,max(total_order_cost) as total_order_cost,order_date
from customers a  join orders b
on a.id=b.cust_id
where order_date between '2019-02-01' and '2019-05-01'
group by first_name,total_order_cost,order_date
order by total_order_cost desc
limit 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Kat@StrataScratch</b><br><small>8/11/2021, 3:52 PM</small></div></div><div class="bottom"><p>Hi heabvensEyes,</p><p>thank you for sharing your thoughts &amp; solution!</p><p>please
 note that the question is asking for Find the customer with the highest
 total order cost and since customers can make more than a single 
purchase, then we need to sum total_cost_order (which is per order) 
within the requested time-bound.</p><p>hope this makes it clear.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>heabvensEyes</b><br><small>8/13/2021, 9:01 AM</small></div></div><div class="bottom"><p>yes,
 it does make it clear, in that case, I can switch the 'max' with 'sum' 
and use the 'order by ' and 'limit' clauses to pick the highest 
customer.
still, why do we need sub-queries for this questions?</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Kat@StrataScratch</b><br><small>8/16/2021, 12:56 PM</small></div></div><div class="bottom"><p>Hi heabvensEyes,</p><p>can you work on this solution and let's have it posted here ;)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>AdamAntium54</b><br><small>8/10/2021, 1:43 PM</small></div></div><div class="bottom"><p>following
 is my answer and it got the correct solution, but i could see were 
complex solution than the following, can anyone tell, is there in error 
in my query</p><p><strong>select first_name,total_order_cost,order_date
from customers c
inner join orders o 
on c.id = o.cust_id
where 
total_order_cost = 
(select max(total_order_cost)
from orders) and 
order_date between '2019-02-01' and 
'2019-05-01'</strong></p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Kat@StrataScratch</b><br><small>8/11/2021, 3:51 PM</small></div></div><div class="bottom"><p>Hi AdamAntium54,</p><p>thank you for sharing your thoughts &amp; solution!</p><p>please note that the question is asking for <code>Find the customer with the highest total order cost</code>
 and since customers can make more than a single purchase, then we need 
to sum total_cost_order (which is per order) within requested 
time-bound.</p><p>hope this makes it clear.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Shrutikakati</b><br><small>8/8/2021, 2:28 AM</small></div></div><div class="bottom"><p>with 
cte as
(select cust_id, total_order_cost, order_date,
rank () over (partition by order_date order by total_order_cost desc) as rnk
from orders
where order_date between '2019-02-01' and '2019-05-01'
order by total_order_cost desc)</p><p>select a.first_name, c.total_order_cost, c.order_date
from customers a left join cte c on
a.id = c.cust_id
group by a.first_name, c.order_date, c.total_order_cost
having c.total_order_cost = (select max(total_order_cost) from cte)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>brand123</b><br><small>8/7/2021, 5:09 PM</small></div></div><div class="bottom"><p>select 
first_name
,order_date
,sum(total_order_cost) as total_order_cost
from customers c
    join orders o
    on o.cust_id = c.id
where o.order_date between '2019-02-01' and '2019-05-01'
group by first_name,order_date
order by sum(total_order_cost) desc
limit 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>aditya0721</b><br><small>7/29/2021, 3:12 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>with  cte as 
(select sum(order_quantity*order_cost) as Total_cost
,cust_id as cid
,order_date 
from orders 
where order_date between '2019-02-01' AND '2019-05-01'
GROUP BY cust_id,order_date
),</p><p>cte2 as (SELECT c.first_name
,c.last_name
,cte.Total_cost
,cte.order_date
,ROW_NUMBER()OVER(PARTITION BY cte.cid,cte.order_date order by cte.Total_cost DESC) as RNK
FROM 
cte
inner join customers c
on c.id=cte.cid
)</p><p>,cte3 as (SELECT 
DENSE_RANK()OVER(ORDER BY total_cost DESC) RNK2
,*
FROM cte2)</p><p>SELECT * FROM cte3
where RNK2=1
ORDER BY order_date</p><p>-- GROUP BY first_name,order_date</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>mani78</b><br><small>7/28/2021, 4:15 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>with cte as (
select cust_id, order_date, 
sum(order_quantity <em> order_cost) as total_cost
from orders
where order_date between '2019-02-01' and '2019-05-01'
group by cust_id, order_date
order by sum(order_quantity </em> order_cost) desc )</p><p>select b.first_name, b.order_date, b.total_cost from
(select cust_id, c.first_name, order_date, total_cost, rank() over(order by total_cost desc) rnk from cte 
inner join customers c on c.id=cte.cust_id)b
where b.rnk=1
;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>JustinThyme32</b><br><small>7/7/2021, 8:15 PM</small></div></div><div class="bottom"><p>Can you please evaluate the solution below and suggest any optimizations further..</p><p>select
 first_name,order_date,total_order_cost as sum from (select 
first_name,order_date, total_order_cost, rank() over (order by 
total_order_cost desc) as sm from (select first_name, order_date, 
sum(order_cost*order_quantity) as total_order_cost from orders o join 
customers c on o.cust_id=c.id where order_date &gt;= '2019-02-01' and 
order_date &lt;= '2019-05-01' group by first_name, order_date) a ) b 
where sm=1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Kat@StrataScratch</b><br><small>7/8/2021, 10:51 AM</small></div></div><div class="bottom"><p>Hi JustinThyme32,</p><p>thank you for sharing your solution, which is working great!</p><p>when
 we talk about optimization we consider factors like; execution-time, 
generalization, reusability, readability, ease of debugging.</p><p>so if
 I were to optimize this code any further, I would consider having less 
subqueries and maybe use of CTE for the first inner query.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>shandeep92</b><br><small>7/3/2021, 8:12 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>Any thoughts on how to optimise this further?</p><p>WITH cte as
(SELECT first_name, order_date, SUM(sum) OVER(PARTITION BY first_name, order_date) AS total_order_on_given_date
FROM (
    SELECT
    first_name,
    order_date,
    (order_quantity * order_cost) AS sum
    FROM orders AS o
    JOIN customers AS c
    ON c.id = o.cust_id
    WHERE order_date BETWEEN '2019-02-01' AND '2019-05-01'
    ORDER BY 3 DESC) AS subq),</p><p>rank AS (SELECT 
DISTINCT first_name, order_date, total_order_on_given_date AS sum,
DENSE_RANK() OVER(ORDER BY total_order_on_given_date DESC) as r
FROM cte
ORDER BY sum DESC)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Kat@StrataScratch</b><br><small>7/3/2021, 9:27 AM</small></div></div><div class="bottom"><p>Hi shandeep92,</p><p>thank you for sharing your approach and solution, which is correct, just needs slight modification.</p><p>first cte has processed all the hard work already, no need for the second, here is how your solution should be:</p><pre><code>WITH cte AS
  (SELECT first_name,
          order_date,
          SUM(order_sum) OVER(PARTITION BY first_name, order_date) AS total_order_on_given_date
   FROM
     (SELECT first_name,
             order_date,
             (order_quantity * order_cost) AS order_sum
      FROM orders AS o
      JOIN customers AS c ON c.id = o.cust_id
      WHERE order_date BETWEEN '2019-02-01' AND '2019-05-01'
      ORDER BY 3 DESC) AS subq)
      
select distinct *
from cte
where total_order_on_given_date = (
select max(total_order_on_given_date)
from cte)</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>RoxanneStyx45</b><br><small>6/30/2021, 5:18 PM</small></div></div><div class="bottom"><p>with cte as
(select cust_id,order_date,sum(order_quantity*order_cost) total_cost from orders
 where order_date between '2019-02-01 ' and '2019-05-01'
group by cust_id,order_date)</p><p>select cs.first_name,c.order_date,c.total_cost from cte c 
inner join customers cs
on c.cust_id = cs.id
where total_cost = (select max(total_cost) from cte)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>7/2/2021, 11:52 AM</small></div></div><div class="bottom"><p>Thanks for sharing your solution!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>DrewApicture41</b><br><small>6/21/2021, 5:02 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>with new as(select a.first_name,sum(order_cost<em>order_quantity) as total_cost,b.order_date,
dense_Rank() over (order by sum(order_cost</em>order_quantity) desc) as r
from customers a
join (select <em> from orders where order_date between '2019-02-01' and '2019-05-01') b
on a.id=b.cust_id
group by first_name,b.order_date
order by total_cost desc)
select </em> from new
where r=1;</p><p>here is my solution tell me your opinion</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>6/23/2021, 2:38 PM</small></div></div><div class="bottom"><p>Hi DrewApicture41,</p><p>This
 is a very good solution. Window functions are maybe even a better 
option here. Keep up with good work and thanks for sharing your 
solution!</p><p>Formating deleted <code>*</code> signs so I'm posting the fixed solution below:</p><pre><code>with new as(select a.first_name,sum(order_cost*order_quantity) as total_cost,b.order_date, dense_Rank() over (order by sum(order_cost*order_quantity) desc) as r from customers a join (select * from orders where order_date between '2019-02-01' and '2019-05-01') b on a.id=b.cust_id group by first_name,b.order_date order by total_cost desc) select * from new where r=1;</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>TeraCotta36</b><br><small>6/15/2021, 9:35 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>select B.first_name, B.total_cost, B.order_date from(
select A.first_name, A.total_cost, A.order_date,
rank () over (Order by total_cost DESC) as Rank 
from (
select first_name, sum(order_cost * order_quantity) as total_cost,  order_date
from customers
inner join orders
On customers.id= orders.cust_id</p><p>where cast(order_date as date) Between '2019-02-01' And '2019-05-01'
group by first_name, order_date
Order by Total_cost DESC 
) as A 
) as B
where Rank =1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>TeraCotta36</b><br><small>6/15/2021, 9:30 PM</small></div></div><div class="bottom"><p>Very EASY please refer to my query </p><p>select B.first_name, B.total_cost, B.order_date from(
select A.first_name, A.total_cost, A.order_date,
rank () over ( order by total_cost DESC) as Rank 
from (
select first_name, sum(order_cost * order_quantity) as total_cost,  order_date
from customers
inner join orders
On customers.id= orders.cust_id</p><p>where cast(order_date as date) Between '2019-02-01' And '2019-05-01'
group by first_name, order_date
Order by Total_cost DESC 
) as A 
) as B
where Rank =1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>6/16/2021, 1:42 PM</small></div></div><div class="bottom"><p>Thank you for sharing your great solution with others!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>SalBoat35</b><br><small>6/12/2021, 8:23 PM</small></div></div><div class="bottom"><p>Hey there! I have an alternative solution that avoids <code>HAVING</code>, and uses <code>RANK</code> instead:</p><pre><code>with cte as (
    select cust_id, 
        order_date,
        sum(order_cost * order_quantity) as cost,
        rank() over (
            order by sum(order_cost * order_quantity) desc
        ) as rn
      from orders
    where order_date &gt; '2019-02-1'::date and order_date &lt; '2019-05-01'::date
    group by cust_id, order_date
)
select customers.first_name, cte.order_date, cte.cost as sum 
from cte inner join customers
on cte.cust_id = customers.id
where cte.rn &lt; 2
order by cte.order_date</code></pre><p>I'm curious how it compares to 
the official solution in terms of performance. I'd say this should be 
faster? The having filter seems to do a bit of extra work in the 
official solution. I think this is related to @ziozib's question as 
well.</p><p>Thank you!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">1</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>6/14/2021, 9:38 AM</small></div></div><div class="bottom"><p>Hi SalBoat35,</p><p>Thank
 you for your great solution. I tried to analyze both queries and there 
seems to be no significant difference in their performance. Your 
intuition is correct, having can cause slow execution time, but that is 
not the case here. It could be the case that on a bigger dataset your 
solution could be more efficient.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>BetteAlott32</b><br><small>6/10/2021, 3:02 PM</small></div></div><div class="bottom"><p>Can someone point out what's wrong with my solution? 
select c.first_name, order_date, sum(order_quantity*order_cost) as total_roder_cost from customers c
join orders o on o.cust_id = c.id
where order_date between '2019-02-01' and '2019-05-01'
group by c.first_name, order_date
order by total_roder_cost desc
limit 2</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>6/11/2021, 11:06 PM</small></div></div><div class="bottom"><p>Hi
 BetteAlott32,
When I execute your query it accepted as the correct solution. Can you 
please try again? Also, make sure you're using SQL kernel, not the 
python kernel</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>WillieWork29</b><br><small>5/20/2021, 5:42 PM</small></div></div><div class="bottom"><p>select first_name,order_date,sumed
from
(
select
first_name,
order_date,
sum(order_cost<em>order_quantity) as sumed,
rank() over(order by sum(order_cost</em>order_quantity) desc) rank
from customers c
inner join orders o
on c.id=o.cust_id
where order_date between '2019-02-01' AND '2019-05-01'
group by 1,2
order by 3 desc
) sub
where rank=1;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>MikeRophone24</b><br><small>4/21/2021, 1:13 AM</small></div></div><div class="bottom"><p>Can someone point to me what's wrong here (it looks exactly like the solution):</p><p>df = orders.merge(customers, left_on='cust_id', right_on='id')
df<a href="">'total_cost'</a> = df<a href="">'order_quantity'</a> * df<a href="">'order_cost'</a></p><p>start_date = '2019-02-01'
end_date = '2019-05-01'
mask = (df<a href="">'order_date'</a> &gt; start_date) &amp; (df<a href="">'order_date'</a> &lt;= end_date)
df2 = df.loc<a href="">mask</a>
df2<a href="">'order_date'</a> = pd.to_datetime(df2<a href="">'order_date'</a>).dt.date</p><p>df3 = df2.groupby(<a href="">'cust_id','order_date','first_name'</a>).sum().reset_index()
df4= df3[<a href="">"first_name", "total_cost", "order_date"</a>]</p><p>result = df4<a href="">df4.total_cost == df4.total_cost.max()</a>
result</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Team@StrataScratch</b><br><small>4/21/2021, 1:32 AM</small></div></div><div class="bottom"><p>Hi, it looks like the <code>order_date</code> field wasn't in the proper datetime format. If you add this line <code>df4['order_date'] = pd.to_datetime(df4['order_date'], format='%Y-%m-%d').dt.strftime('%Y-%m-%d')</code> to the 2nd to last line in your code, you'll get the solution validated. </p><p>I'll try to relax the solution checker a bit to account for these differences.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>ziozib</b><br><small>3/31/2021, 3:42 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>Hi, Thanks for this!
I have a quick question:</p><ul><li>is it better to avoid WINDOW FUNCTION when possible? Maybe for a computational reason?</li><li>What is the difference in performance between using a RANK and the HAVING = ...?
Thank you,
Davide</li></ul><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Team@StrataScratch</b><br><small>3/31/2021, 4:48 PM</small></div></div><div class="bottom"><p>Window
 functions are pretty efficient computational-wise so it's preferred 
over alternatives. Other approaches to get rankings without a window 
function would probably include a few CTEs/subqueries which are more 
computationally expensive. </p><p><code>RANK</code> and <code>HAVING</code> are usually used to do totally different things. <code>RANK</code>
 obviously to get rankings based off of the data. You can get rankings 
off the entire dataset or off of partitions that you create. That's why 
you see so many window functions with rankings + partition by. <code>HAVING</code> is a filter that's applied after an aggregation. In this solution, after we apply a <code>sum(total_order_cost)</code> we then have some logic to filter down the output further by only selecting the <code>max()</code>. </p><p>Hope that helps! Great question.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>WoodrowAboate15</b><br><small>3/7/2021, 4:23 AM</small></div></div><div class="bottom"><p>the two orders on 2019-03-04 should have the same id if your going to count the order as 430 being the highest not 400</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Kasia@StrataScratch</b><br><small>3/9/2021, 5:40 PM</small></div></div><div class="bottom"><p>Actually
 the two orders from 2019-03-04 and 2019-04-19 with total cost of 430 
are result of the solution. If you have any other concerns, you can 
share your code to review it together.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>AuroraBorealis8</b><br><small>1/19/2021, 8:59 AM</small></div></div><div class="bottom"><p>--select * from customers</p><p>select first_name,order_date,sum from</p><p>(select id,first_name from customers) A</p><p>inner join(</p><p>with B as
(
with A as
(select cust_id,order_date,sum(order_cost<em>order_quantity) from orders
where order_date between '2019-02-01' and '2019-05-01'
group by 1,2)
select </em> from A where sum = (select max(sum) from A))
select * from B) B
on
A.id = B.cust_id order by 2;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>pauls60r</b><br><small>12/21/2020, 7:13 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>I
 think I might be misunderstanding something. My query gives 1 answer 
(Mia at a total cost of 430). 
To check my sanity, I did a basic query for Mia's purchases on 
2019-04-19 and it does appear to add to 430 (2 items at $200 and 1 item 
at $30). Any idea what I might be missing? probably some mundane detail</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Team@StrataScratch</b><br><small>12/22/2020, 6:02 PM</small></div></div><div class="bottom"><p>No
 misunderstanding. The original solution only took the max total order 
cost by date but didn't sum it first. So you're right that Mia should 
have had a total of $430 not $400 that you saw in the original solution.
 I did a quick fix so feel free to check your code against the official 
solution. Thanks for letting me know about this.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>npericherla</b><br><small>12/20/2020, 2:12 PM</small></div></div><div class="bottom"><p>total order cost should be sum(order_cost) between the dates given,
how is your solution given  based on cost*Quantity as total cost ?</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>npericherla</b><br><small>12/20/2020, 2:18 PM</small></div></div><div class="bottom"><p>Oh.. ok the output requirement of date makes sense to get the total order cost in this way</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>george-frazee</b><br><small>12/15/2020, 6:07 AM</small></div></div><div class="bottom"><p>The expected output doesn't make sense.</p><p>Why shouldn't we account for the total order cost by date, including quantity?</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Team@StrataScratch</b><br><small>12/17/2020, 11:59 PM</small></div></div><div class="bottom"><p>That's
 a good point. I do think it does make more sense to account for total 
order cost which is a function of item cost and quantity. I believe the 
original interview question didn't ask the interviewee to solve it that 
way. But your suggestion makes sense so I've updated the question to 
output for total order cost.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div></div></div></div></div><div id="question-details-tabs-tabpane-submissions" aria-labelledby="question-details-tabs-tab-submissions" role="tabpanel" aria-hidden="true" class="fade tab-pane"><div style="max-height: 1045px;"><div class="row"><div style="height: 100%;" class="col-12"><div style="margin: 1.5rem;"><h5 style="font-size: 16px;"><span style="font-weight: 600;">Total Number of Attempts:</span> <span style="padding-left: 5px;">0</span></h5><h5 style="font-size: 16px;"><span style="font-weight: 600;">Success Rate:</span> <span style="padding-left: 5px;">0.00%</span></h5></div><div class="submissions"><div class="full-height"><div class="dtContainer dataTables_wrapper full-height"><table id="dt" class="table display dataTable no-footer full-height"><thead><tr class="dataTableHiddenHeaders"><th role="columnheader" scope="col">Date<br></th><th role="columnheader" scope="col">Status<br></th><th role="columnheader" scope="col">Language<br></th><th role="columnheader" scope="col">Solution<br></th></tr></thead><tbody><tr class="text-center"><td>No solutions found.</td></tr></tbody></table><div class="dataTables_length" id="dt_length">Show <div style="display: inline-block; width: 80px;"><div class="popular-modules css-b62m3t-container"><span id="react-select-3-live-region" class="css-7pg0cj-a11yText"></span><span aria-live="polite" aria-atomic="false" aria-relevant="additions text" class="css-7pg0cj-a11yText"></span><div class=" css-1s2u09g-control"><div class=" css-1d8n9bt"><div class=" css-qc6sy-singleValue">10</div><div class=" css-ackcql" data-value=""><input class="" style="color: inherit; background: rgba(0, 0, 0, 0) none repeat scroll 0px center; opacity: 1; width: 100%; grid-area: 1 / 2; font: inherit; min-width: 2px; border: 0px none; margin: 0px; outline: currentcolor none 0px; padding: 0px;" autocapitalize="none" autocomplete="off" autocorrect="off" id="react-select-3-input" spellcheck="false" tabindex="0" type="text" aria-autocomplete="list" aria-expanded="false" aria-haspopup="true" aria-controls="react-select-3-listbox" aria-owns="react-select-3-listbox" role="combobox"></div></div><div class=" css-1wy0on6"><span class=" css-1okebmr-indicatorSeparator"></span><div class=" css-tlfecz-indicatorContainer" aria-hidden="true"><svg height="20" width="20" viewBox="0 0 20 20" aria-hidden="true" focusable="false" class="css-8mmkcg"><path d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"></path></svg></div></div></div><input name="pageSize" type="hidden" value="10"></div></div> entries</div></div></div></div></div></div></div></div><div id="question-details-tabs-tabpane-solutions" aria-labelledby="question-details-tabs-tab-solutions" role="tabpanel" aria-hidden="true" class="fade tab-pane"><div style="max-height: 1045px;"><div class="row justify-content-end m-0"><div style="margin-right: 5px;" class="sort-dropdown dropdown"><button type="button" style="border: 0px none; background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%;"><span style="margin-right: 5px;">Sort By</span><i class="fa fa-sort-amount-desc" aria-hidden="true"></i></button></div></div><div><div><div><div class="user-solution-upvote"><span class="upvotes-number" style="margin-right: 5px;">5</span><button type="button" class="upvote-link" style="background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%; border: 0px none; color: rgb(0, 166, 153);"><i class="fa fa-arrow-up"></i></button></div><b>CookMyefoud105 on 26/1/2022</b></div><div class="m-t-5 m-r-5"><div class="strata-editor-container"><div id="ace-editor" style="width: 100%; height: 200px; font-size: 0.8125rem;" class=" ace_editor ace-github" draggable="false"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; font-size: 1px; height: 1px; width: 1px; top: 19px; left: 44px;" readonly="readonly" wrap="off">select first_name, sum(total_order_cost) as total, order_date
from orders o left join customers c

</textarea><div class="ace_gutter" aria-hidden="true" style="left: 0px; width: 40px;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1000000px; top: 0px; left: 0px; width: 40px;"><div class="ace_gutter-active-line ace_gutter-cell " style="height: 19px; top: 0px;">1<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 19px;">2<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 38px;">3<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 57px;">4<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 76px;">5<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 95px;">6<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 114px;">7<span style="display: none;"></span></div></div></div><div class="ace_scroller" style="line-height: 19px; left: 40px; right: 0px; bottom: 0px; cursor: default;"><div class="ace_content" style="top: 0px; left: 0px; width: 757px; height: 238px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 564px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div style="height: 19px; right: 0px; top: 0px; left: 4px;" class="ace_selection ace_br1 ace_start"></div><div style="height: 19px; width: 49px; top: 114px; left: 4px;" class="ace_selection ace_br12"></div><div style="height: 95px; right: 0px; top: 19px; left: 4px;" class="ace_selection"></div></div><div class="ace_layer ace_text-layer" style="height: 1000000px; margin: 0px 4px; top: 0px; left: 0px;"><div style="height: 19px; top: 0px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">select</span> <span class="ace_identifier">first_name</span>, <span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">total_order_cost</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">as</span> <span class="ace_identifier">total</span>, <span class="ace_identifier">order_date</span></div></div><div style="height: 19px; top: 19px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">from</span> <span class="ace_identifier">orders</span> <span class="ace_identifier">o</span> <span class="ace_keyword">left</span> <span class="ace_keyword">join</span> <span class="ace_identifier">customers</span> <span class="ace_identifier">c</span></div></div><div style="height: 19px; top: 38px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">on</span> <span class="ace_identifier">o</span>.<span class="ace_identifier">cust_id</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">c</span>.<span class="ace_identifier">id</span></div></div><div style="height: 19px; top: 57px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">where</span> <span class="ace_identifier">order_date</span> <span class="ace_identifier">between</span> <span class="ace_string">'2019-02-01'</span> <span class="ace_keyword">and</span> <span class="ace_string">'2019-05-01'</span></div></div><div style="height: 19px; top: 76px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">group</span> <span class="ace_keyword">by</span> <span class="ace_identifier">first_name</span>, <span class="ace_identifier">order_date</span></div></div><div style="height: 19px; top: 95px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">order</span> <span class="ace_keyword">by</span> <span class="ace_identifier">total</span> <span class="ace_keyword">desc</span></div></div><div style="height: 19px; top: 114px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">limit</span> <span class="ace_constant ace_numeric">1</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="display: block; top: 0px; left: 4px; width: 7px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="display: none; width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 133px;">&nbsp;</div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 40px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 797px;">&nbsp;</div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה</div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div class="strata-editor-extension strata-editor-dragbar" role="separator"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg></div></div></div></div><div><div><div class="user-solution-upvote"><span class="upvotes-number" style="margin-right: 5px;">4</span><button type="button" class="upvote-link" style="background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%; border: 0px none; color: rgb(0, 166, 153);"><i class="fa fa-arrow-up"></i></button></div><b>arek3101 on 31/12/2021</b></div><div class="m-t-5 m-r-5"><div class="strata-editor-container"><div id="ace-editor" style="width: 100%; height: 200px; font-size: 0.8125rem;" class=" ace_editor ace-github"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; font-size: 1px; height: 1px; width: 1px; top: 199px; left: 100px;" readonly="readonly" wrap="off"></textarea><div class="ace_gutter" aria-hidden="true" style="left: 0px; width: 47px;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1000000px; top: 0px; left: 0px; width: 47px;"><div class="ace_gutter-cell " style="height: 19px; top: 0px;">1<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 19px;">2<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 38px;">3<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 57px;">4<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 76px;">5<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 95px;">6<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 114px;">7<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 133px;">8<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 152px;">9<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 171px;">10<span style="display: none;"></span></div><div class="ace_gutter-cell ace_gutter-active-line " style="height: 19px; top: 190px;">11<span style="display: none;"></span></div></div></div><div class="ace_scroller" style="line-height: 19px; left: 47px; right: 17px; bottom: 0px;"><div class="ace_content" style="top: 0px; left: 0px; width: 733px; height: 238px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 564px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div style="height: 19px; top: 190px; left: 0px; right: 0px;" class="ace_active-line"></div></div><div class="ace_layer ace_text-layer" style="height: 1000000px; margin: 0px 4px; top: 0px; left: 0px;"><div style="height: 19px; top: 0px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">select</span></div></div><div style="height: 19px; top: 19px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_identifier">c</span>.<span class="ace_identifier">first_name</span>,</div></div><div style="height: 19px; top: 38px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">o</span>.<span class="ace_identifier">total_order_cost</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">as</span> <span class="ace_identifier">total_order_cost</span>,</div></div><div style="height: 19px; top: 57px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_identifier">o</span>.<span class="ace_identifier">order_date</span></div></div><div style="height: 19px; top: 76px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">from</span> <span class="ace_identifier">customers</span> <span class="ace_identifier">c</span></div></div><div style="height: 19px; top: 95px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">inner</span> <span class="ace_keyword">join</span> <span class="ace_identifier">orders</span> <span class="ace_identifier">o</span></div></div><div style="height: 19px; top: 114px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">on</span> <span class="ace_identifier">c</span>.<span class="ace_identifier">id</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">o</span>.<span class="ace_identifier">cust_id</span></div></div><div style="height: 19px; top: 133px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">where</span> <span class="ace_identifier">o</span>.<span class="ace_identifier">order_date</span> <span class="ace_identifier">between</span> <span class="ace_string">'2019-02-01'</span> <span class="ace_keyword">and</span> <span class="ace_string">'2019-05-01'</span></div></div><div style="height: 19px; top: 152px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">group</span> <span class="ace_keyword">by</span> <span class="ace_identifier">first_name</span>, <span class="ace_identifier">cust_id</span>, <span class="ace_identifier">order_date</span></div></div><div style="height: 19px; top: 171px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">order</span> <span class="ace_keyword">by</span> <span class="ace_identifier">total_order_cost</span> <span class="ace_keyword">desc</span></div></div><div style="height: 19px; top: 190px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">limit</span> <span class="ace_constant ace_numeric">1</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="display: block; top: 190px; left: 53px; width: 7px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 209px;">&nbsp;</div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 47px; right: 17px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 780px;">&nbsp;</div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה</div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div class="strata-editor-extension strata-editor-dragbar" role="separator"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg></div></div></div></div><div><div><div class="user-solution-upvote"><span class="upvotes-number" style="margin-right: 5px;">2</span><button type="button" class="upvote-link" style="background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%; border: 0px none; color: rgb(0, 166, 153);"><i class="fa fa-arrow-up"></i></button></div><b>BetteItall87 on 12/1/2022</b></div><div class="m-t-5 m-r-5"><div class="strata-editor-container"><div id="ace-editor" style="width: 100%; height: 200px; font-size: 0.8125rem;" class=" ace_editor ace-github"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; font-size: 1px; top: 0px; left: 0px;" readonly="readonly" wrap="off"></textarea><div class="ace_gutter" aria-hidden="true" style="left: 0px; width: 47px;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1000000px; top: 0px; left: 0px; width: 47px;"><div class="ace_gutter-cell " style="height: 19px; top: 0px;">1<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 19px;">2<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 38px;">3<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 57px;">4<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 76px;">5<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 95px;">6<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 114px;">7<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 133px;">8<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 152px;">9<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 171px;">10<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 190px;">11<span style="display: none;"></span></div><div class="ace_gutter-cell ace_gutter-active-line " style="height: 19px; top: 209px;">12<span style="display: none;"></span></div></div></div><div class="ace_scroller" style="line-height: 19px; left: 47px; right: 17px; bottom: 0px;"><div class="ace_content" style="top: 0px; left: 0px; width: 733px; height: 238px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 564px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div style="height: 19px; top: 209px; left: 0px; right: 0px;" class="ace_active-line"></div><div style="height: 19px; width: 7px; top: 209px; left: 228px;" class="ace_bracket ace_start ace_br15"></div><div style="height: 19px; width: 7px; top: 133px; left: 4px;" class="ace_bracket ace_start ace_br15"></div></div><div class="ace_layer ace_text-layer" style="height: 1000000px; margin: 0px 4px; top: 0px; left: 0px;"><div style="height: 19px; top: 0px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">select</span> <span class="ace_identifier">first_name</span>,<span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">total_order_cost</span><span class="ace_paren ace_rparen">)</span>, <span class="ace_identifier">order_date</span> <span class="ace_keyword">from</span></div></div><div style="height: 19px; top: 19px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_identifier">orders</span> <span class="ace_identifier">o</span></div></div><div style="height: 19px; top: 38px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">join</span> <span class="ace_identifier">customers</span> <span class="ace_identifier">c</span></div></div><div style="height: 19px; top: 57px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">on</span> <span class="ace_identifier">c</span>.<span class="ace_identifier">id</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">o</span>.<span class="ace_identifier">cust_id</span></div></div><div style="height: 19px; top: 76px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">where</span> <span class="ace_identifier">o</span>.<span class="ace_identifier">order_date</span> <span class="ace_identifier">between</span> <span class="ace_string">'2019-02-01'</span> <span class="ace_keyword">and</span> <span class="ace_string">'2019-05-01'</span></div></div><div style="height: 19px; top: 95px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">group</span> <span class="ace_keyword">by</span> <span class="ace_identifier">first_name</span>, <span class="ace_identifier">order_date</span></div></div><div style="height: 19px; top: 114px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">having</span> <span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">total_order_cost</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword ace_operator">=</span> </div></div><div style="height: 19px; top: 133px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_paren ace_lparen">(</span><span class="ace_keyword">select</span> <span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">total_order_cost</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">as</span> <span class="ace_identifier">total_cost</span></div></div><div style="height: 19px; top: 152px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">from</span> <span class="ace_identifier">orders</span> <span class="ace_identifier">o</span></div></div><div style="height: 19px; top: 171px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">where</span> <span class="ace_identifier">o</span>.<span class="ace_identifier">order_date</span> <span class="ace_identifier">between</span> <span class="ace_string">'2019-02-01'</span> <span class="ace_keyword">and</span> <span class="ace_string">'2019-05-01'</span></div></div><div style="height: 19px; top: 190px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">group</span> <span class="ace_keyword">by</span> <span class="ace_identifier">cust_id</span>, <span class="ace_identifier">order_date</span></div></div><div style="height: 19px; top: 209px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">order</span> <span class="ace_keyword">by</span> <span class="ace_identifier">total_cost</span> <span class="ace_keyword">desc</span> <span class="ace_keyword">limit</span> <span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="display: block; top: 209px; left: 235px; width: 7px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 228px;">&nbsp;</div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 47px; right: 17px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 780px;">&nbsp;</div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה</div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div class="strata-editor-extension strata-editor-dragbar" role="separator"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg></div></div></div></div><div><div><div class="user-solution-upvote"><span class="upvotes-number" style="margin-right: 5px;">1</span><button type="button" class="upvote-link" style="background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%; border: 0px none; color: rgb(0, 166, 153);"><i class="fa fa-arrow-up"></i></button></div><b>Jeff_the_manning on 2/2/2022</b></div><div class="m-t-5 m-r-5"><div class="strata-editor-container"><div id="ace-editor" style="width: 100%; height: 200px; font-size: 0.8125rem;" class=" ace_editor ace-github"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; font-size: 1px; top: 0px; left: 0px;" readonly="readonly" wrap="off"></textarea><div class="ace_gutter" aria-hidden="true" style="left: 0px; width: 47px;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1000000px; top: 0px; left: 0px; width: 47px;"><div class="ace_gutter-cell " style="height: 19px; top: 0px;">1<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 19px;">2<span class="ace_fold-widget ace_start ace_open" style="height: 19px; display: inline-block;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 38px;">3<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 57px;">4<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 76px;">5<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 95px;">6<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 114px;">7<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 133px;">8<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 152px;">9<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 171px;">10<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 190px;">11<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 209px;">12<span style="display: none;"></span></div></div></div><div class="ace_scroller" style="line-height: 19px; left: 47px; right: 17px; bottom: 0px;"><div class="ace_content" style="top: 0px; left: 0px; width: 733px; height: 238px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 564px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="height: 1000000px; margin: 0px 4px; top: 0px; left: 0px;"><div style="height: 19px; top: 0px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_identifier">WITH</span> <span class="ace_identifier">ate</span> <span class="ace_keyword">AS</span></div></div><div style="height: 19px; top: 19px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_paren ace_lparen">(</span></div></div><div style="height: 19px; top: 38px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">SELECT</span> <span class="ace_identifier">cust</span>.<span class="ace_identifier">id</span></div></div><div style="height: 19px; top: 57px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    , <span class="ace_identifier">cust</span>.<span class="ace_identifier">first_name</span> <span class="ace_keyword">AS</span> <span class="ace_identifier">first_name</span></div></div><div style="height: 19px; top: 76px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    , <span class="ace_identifier">ord</span>.<span class="ace_identifier">order_date</span> <span class="ace_keyword">AS</span> <span class="ace_identifier">order_date</span></div></div><div style="height: 19px; top: 95px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    , <span class="ace_identifier">ord</span>.<span class="ace_identifier">total_order_cost</span> <span class="ace_keyword">AS</span> <span class="ace_identifier">total_cost</span></div></div><div style="height: 19px; top: 114px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    , <span class="ace_support ace_function">COUNT</span><span class="ace_paren ace_lparen">(</span><span class="ace_constant ace_numeric">1</span><span class="ace_paren ace_rparen">)</span> <span class="ace_identifier">OVER</span> <span class="ace_paren ace_lparen">(</span><span class="ace_identifier">PARTITION</span> <span class="ace_keyword">BY</span> <span class="ace_identifier">cust</span>.<span class="ace_identifier">id</span>, <span class="ace_identifier">ord</span>.<span class="ace_identifier">order_date</span> <span class="ace_keyword">ORDER</span> <span class="ace_keyword">BY</span> <span class="ace_identifier">ord</span>.<span class="ace_identifier">order_date</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">AS</span> <span class="ace_identifier">day_count</span></div></div><div style="height: 19px; top: 133px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">FROM</span> <span class="ace_identifier">customers</span> <span class="ace_identifier">cust</span> <span class="ace_keyword">JOIN</span> <span class="ace_identifier">orders</span> <span class="ace_identifier">ord</span> <span class="ace_keyword">ON</span> <span class="ace_identifier">cust</span>.<span class="ace_identifier">id</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">ord</span>.<span class="ace_identifier">cust_id</span></div></div><div style="height: 19px; top: 152px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">WHERE</span> <span class="ace_identifier">ord</span>.<span class="ace_identifier">order_date</span> <span class="ace_identifier">BETWEEN</span> <span class="ace_string">'2019-02-01'</span> <span class="ace_keyword">AND</span> <span class="ace_string">'2019-05-01'</span></div></div><div style="height: 19px; top: 171px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_paren ace_rparen">)</span></div></div><div style="height: 19px; top: 190px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"></div></div><div style="height: 19px; top: 209px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">SELECT</span> <span class="ace_identifier">first_name</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="display: block; top: 380px; left: 53px; width: 7px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 399px;">&nbsp;</div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 47px; right: 17px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 780px;">&nbsp;</div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה</div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div class="strata-editor-extension strata-editor-dragbar" role="separator"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg></div></div></div></div><div><div><div class="user-solution-upvote"><span class="upvotes-number" style="margin-right: 5px;">1</span><button type="button" class="upvote-link" style="background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%; border: 0px none; color: rgb(0, 166, 153);"><i class="fa fa-arrow-up"></i></button></div><b>pnguyentang on 26/1/2022</b></div><div class="m-t-5 m-r-5"><div class="strata-editor-container"><div id="ace-editor" style="width: 100%; height: 200px; font-size: 0.8125rem;" class=" ace_editor ace-github"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; font-size: 1px; top: 0px; left: 0px;" readonly="readonly" wrap="off"></textarea><div class="ace_gutter" aria-hidden="true" style="left: 0px; width: 47px;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1000000px; top: 0px; left: 0px; width: 47px;"><div class="ace_gutter-cell " style="height: 19px; top: 0px;">1<span class="ace_fold-widget ace_start ace_open" style="height: 19px; display: inline-block;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 19px;">2<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 38px;">3<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 57px;">4<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 76px;">5<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 95px;">6<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 114px;">7<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 133px;">8<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 152px;">9<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 171px;">10<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 190px;">11<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 209px;">12<span style="display: none;"></span></div></div></div><div class="ace_scroller" style="line-height: 19px; left: 47px; right: 17px; bottom: 0px;"><div class="ace_content" style="top: 0px; left: 0px; width: 733px; height: 238px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 564px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="height: 1000000px; margin: 0px 4px; top: 0px; left: 0px;"><div style="height: 19px; top: 0px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_identifier">WITH</span> <span class="ace_identifier">output</span> <span class="ace_keyword">AS</span> <span class="ace_paren ace_lparen">(</span><span class="ace_keyword">SELECT</span> <span class="ace_identifier">customers</span>.<span class="ace_identifier">first_name</span>, </div></div><div style="height: 19px; top: 19px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_identifier">orders</span>.<span class="ace_identifier">order_date</span>, </div></div><div style="height: 19px; top: 38px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_support ace_function">SUM</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">orders</span>.<span class="ace_identifier">total_order_cost</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">AS</span> <span class="ace_identifier">daily_purchase</span></div></div><div style="height: 19px; top: 57px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    </div></div><div style="height: 19px; top: 76px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">FROM</span> <span class="ace_identifier">orders</span></div></div><div style="height: 19px; top: 95px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">INNER</span> <span class="ace_keyword">JOIN</span> <span class="ace_identifier">customers</span> <span class="ace_keyword">ON</span> <span class="ace_identifier">orders</span>.<span class="ace_identifier">cust_id</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">customers</span>.<span class="ace_identifier">id</span></div></div><div style="height: 19px; top: 114px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">WHERE</span> <span class="ace_identifier">orders</span>.<span class="ace_identifier">order_date</span> <span class="ace_identifier">BETWEEN</span> <span class="ace_string">'2019-02-01'</span> <span class="ace_keyword">AND</span> <span class="ace_string">'2019-05-01'</span></div></div><div style="height: 19px; top: 133px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">GROUP</span> <span class="ace_keyword">BY</span> <span class="ace_identifier">customers</span>.<span class="ace_identifier">first_name</span>, <span class="ace_identifier">orders</span>.<span class="ace_identifier">order_date</span><span class="ace_paren ace_rparen">)</span></div></div><div style="height: 19px; top: 152px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">SELECT</span> <span class="ace_identifier">output</span>.<span class="ace_identifier">first_name</span>, </div></div><div style="height: 19px; top: 171px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_identifier">output</span>.<span class="ace_identifier">daily_purchase</span>, </div></div><div style="height: 19px; top: 190px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_identifier">output</span>.<span class="ace_identifier">order_date</span></div></div><div style="height: 19px; top: 209px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">FROM</span> <span class="ace_identifier">output</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="display: block; top: 266px; left: 487px; width: 7px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 285px;">&nbsp;</div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 47px; right: 17px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 780px;">&nbsp;</div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה</div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div class="strata-editor-extension strata-editor-dragbar" role="separator"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg></div></div></div></div></div><div style="margin-top: 20px;" class="row"><div class="col-12"><button disabled="disabled" style="margin-right: 10px;" xs="1" type="button" class="btn btn-primary">1</button><button style="margin-right: 10px;" xs="1" type="button" class="btn btn-primary">2</button><button style="margin-right: 10px;" xs="1" type="button" class="btn btn-primary">3</button><button style="margin-right: 10px;" xs="1" type="button" class="btn btn-primary">4</button><button style="margin-right: 10px;" xs="1" type="button" class="btn btn-primary">5</button><button style="margin-right: 10px;" xs="1" type="button" class="btn btn-primary">Next</button><div style="width: 80px; height: 38px; display: inline-block; float: right; margin-right: 5px;"><div class=" css-b62m3t-container"><span id="react-select-5-live-region" class="css-7pg0cj-a11yText"></span><span aria-live="polite" aria-atomic="false" aria-relevant="additions text" class="css-7pg0cj-a11yText"></span><div class=" css-1s2u09g-control"><div class=" css-1d8n9bt"><div class=" css-qc6sy-singleValue">5</div><div class=" css-ackcql" data-value=""><input class="" style="color: inherit; background: rgba(0, 0, 0, 0) none repeat scroll 0px center; opacity: 1; width: 100%; grid-area: 1 / 2; font: inherit; min-width: 2px; border: 0px none; margin: 0px; outline: currentcolor none 0px; padding: 0px;" autocapitalize="none" autocomplete="off" autocorrect="off" id="react-select-5-input" spellcheck="false" tabindex="0" type="text" aria-autocomplete="list" aria-expanded="false" aria-haspopup="true" aria-controls="react-select-5-listbox" aria-owns="react-select-5-listbox" role="combobox"></div></div><div class=" css-1wy0on6"><span class=" css-1okebmr-indicatorSeparator"></span><div class=" css-tlfecz-indicatorContainer" aria-hidden="true"><svg height="20" width="20" viewBox="0 0 20 20" aria-hidden="true" focusable="false" class="css-8mmkcg"><path d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"></path></svg></div></div></div><input name="pageSize" type="hidden" value="5"></div></div></div></div></div></div></div></div></div><div><hr class="green-hr-bold"><div class="scrollbar-container"><div class="scrollbar-content"><div><div class="TableElement collapse in show"><div class="clearfix"><div class="pull-left"><div class="table-name color-green">customers<button type="button" class="bg-none btn-link-borderless"><small class="m-l-5 table-name-icon"><i class="fa fa-minus-square-o"></i></small></button></div></div><div class="pull-right"><div class="ws-el-controls pull-right btn-group"><button type="button" class="m-l-5 btn btn-sm btn-primary">Preview</button></div></div></div><div class="collapse in show"><div class="table-columns"><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">id</div><div class="pull-right text-muted"><small>int</small></div></div><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">first_name</div><div class="pull-right text-muted"><small>varchar</small></div></div><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">last_name</div><div class="pull-right text-muted"><small>varchar</small></div></div><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">city</div><div class="pull-right text-muted"><small>varchar</small></div></div><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">address</div><div class="pull-right text-muted"><small>varchar</small></div></div><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">phone_number</div><div class="pull-right text-muted"><small>varchar</small></div></div></div></div></div><div class="TableElement collapse in show"><div class="clearfix"><div class="pull-left"><div class="table-name color-green">orders<button type="button" class="bg-none btn-link-borderless"><small class="m-l-5 table-name-icon"><i class="fa fa-minus-square-o"></i></small></button></div></div><div class="pull-right"><div class="ws-el-controls pull-right btn-group"><button type="button" class="m-l-5 btn btn-sm btn-primary">Preview</button></div></div></div><div class="collapse in show"><div class="table-columns"><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">id</div><div class="pull-right text-muted"><small>int</small></div></div><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">cust_id</div><div class="pull-right text-muted"><small>int</small></div></div><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">order_date</div><div class="pull-right text-muted"><small>datetime</small></div></div><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">order_details</div><div class="pull-right text-muted"><small>varchar</small></div></div><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">total_order_cost</div><div class="pull-right text-muted"><small>int</small></div></div></div></div></div></div></div></div><hr><div role="alert" class="fade alert alert-warning show"><div><div>Recommended <b>Medium Interview</b> Questions</div><div><a href="https://platform.stratascratch.com/coding/9624-accommodates-to-bed-ratio?python=undefined"> &gt;&gt; Accommodates-To-Bed Ratio</a></div><div><a href="https://platform.stratascratch.com/coding/10124-bookings-vs-non-bookings?python=undefined"> &gt;&gt; Bookings vs Non-Bookings</a></div><div><a href="https://platform.stratascratch.com/coding/9636-cheapest-neighborhoods-with-real-beds-and-internet?python=undefined"> &gt;&gt; Cheapest Neighborhoods With Real Beds And Internet</a></div></div><br><div><div>Recommended <b>Amazon</b> Questions</div><div><a href="https://platform.stratascratch.com/coding/9891-customer-details?python=undefined"> &gt;&gt; Customer Details</a></div><div><a href="https://platform.stratascratch.com/coding/10322-finding-user-purchases?python=undefined"> &gt;&gt; Finding User Purchases</a></div><div><a href="https://platform.stratascratch.com/coding/9915-highest-cost-orders?python=undefined"> &gt;&gt; Highest Cost Orders</a></div></div></div></div></div></div><div class="col-md-6"><div class="m-t-10 position-relative" style="width: 100%;"><button class="btn btn-primary editor-resize" type="button"><i class="fa fa-arrow-left" aria-hidden="true"></i></button><div class="strata-editor-container"><div id="ace-editor" style="width: 100%; height: 200px; font-size: 0.8125rem;" class=" ace_editor ace-github" draggable="false"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; font-size: 1px; height: 1px; width: 1px; top: 19px; left: 51px;" wrap="off">SELECT
    c.first_name,

</textarea><div class="ace_gutter" aria-hidden="true" style="left: 0px; width: 47px;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1000000px; top: 0px; left: 0px; width: 47px;"><div class="ace_gutter-cell ace_gutter-active-line " style="height: 19px; top: 0px;">1<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 19px;">2<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 38px;">3<span style="display: none; height: 19px;" class="ace_fold-widget ace_start ace_open"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 57px;">4<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 76px;">5<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 95px;">6<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 114px;">7<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 133px;">8<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 152px;">9<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 171px;">10<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 190px;">11<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 209px;">12<span style="display: none;"></span></div></div></div><div class="ace_scroller" style="line-height: 19px; left: 47px; right: 17px; bottom: 0px; cursor: default;"><div class="ace_content" style="top: 0px; left: 0px; width: 783px; height: 238px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 564px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div style="height: 19px; right: 0px; top: 0px; left: 4px;" class="ace_selection ace_br1 ace_start"></div><div style="height: 19px; width: 49px; top: 190px; left: 4px;" class="ace_selection ace_br12"></div><div style="height: 171px; right: 0px; top: 19px; left: 4px;" class="ace_selection"></div></div><div class="ace_layer ace_text-layer" style="height: 1000000px; margin: 0px 4px; top: 0px; left: 0px;"><div style="height: 19px; top: 0px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">SELECT</span></div></div><div style="height: 19px; top: 19px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_identifier">c</span>.<span class="ace_identifier">first_name</span>,</div></div><div style="height: 19px; top: 38px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_support ace_function">SUM</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">o</span>.<span class="ace_identifier">total_order_cost</span><span class="ace_paren ace_rparen">)</span>,</div></div><div style="height: 19px; top: 57px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_identifier">o</span>.<span class="ace_identifier">order_date</span></div></div><div style="height: 19px; top: 76px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">FROM</span></div></div><div style="height: 19px; top: 95px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_identifier">customers</span> <span class="ace_keyword">AS</span> <span class="ace_identifier">c</span></div></div><div style="height: 19px; top: 114px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">JOIN</span> <span class="ace_identifier">orders</span> <span class="ace_keyword">AS</span> <span class="ace_identifier">o</span> <span class="ace_keyword">ON</span> <span class="ace_identifier">o</span>.<span class="ace_identifier">cust_id</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">c</span>.<span class="ace_identifier">id</span></div></div><div style="height: 19px; top: 133px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">WHERE</span> <span class="ace_identifier">order_date</span> <span class="ace_identifier">BETWEEN</span> <span class="ace_string">'2019-02-01'</span> <span class="ace_keyword">AND</span> <span class="ace_string">'2019-05-01'</span></div></div><div style="height: 19px; top: 152px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">GROUP</span> <span class="ace_keyword">BY</span> <span class="ace_identifier">first_name</span>, <span class="ace_identifier">order_date</span></div></div><div style="height: 19px; top: 171px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">ORDER</span> <span class="ace_keyword">BY</span> <span class="ace_support ace_function">SUM</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">o</span>.<span class="ace_identifier">total_order_cost</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">DESC</span></div></div><div style="height: 19px; top: 190px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">LIMIT</span> <span class="ace_constant ace_numeric">1</span></div></div><div style="height: 19px; top: 209px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="display: block; top: 0px; left: 4px; width: 7px; height: 19px; animation-duration: 1000ms;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 228px;">&nbsp;</div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 47px; right: 17px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 847px;">&nbsp;</div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה</div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div class="strata-editor-extension strata-editor-dragbar" role="separator"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg></div></div></div><div class="strata-editor-buttons-wrapper"><button type="button" class="btn btn-sm btn-default" style="display: inline-flex; align-items: center;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" style="width: 12px; height: 14px; margin-right: 0.4em;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28 77.418-.07 144.315-53.144 162.787-126.849 1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z"></path></svg>Run Code</button><button type="button" class="btn btn-sm btn-primary" style="display: inline-flex; align-items: center;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" style="width: 12px; height: 14px; margin-right: 0.4em;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"></path></svg>Solved</button><a href="https://platform.stratascratch.com/coding/10319-monthly-percentage-difference?python=" class="btn" style="color: green; margin-top: 2px; font-size: 16px;"><i class="fa fa-caret-square-o-right fa-2x" aria-hidden="true" title="Next question"></i></a></div><p class="strata-editor-hotkey-message">Use Alt + Enter to run query</p><div class="m-t-10"><ul class="left_side_tab nav nav-tabs" role="tablist"><li class="nav-item"><a href="#" role="tab" data-rb-event-key="output" id="code-output-tabs-tab-output" aria-controls="code-output-tabs-tabpane-output" aria-selected="true" class="nav-link active">Output</a></li><button style="position: absolute; right: 0px;" type="button" class="btn btn-link">View the output in a separate browser tab</button></ul><div class="tab-content"><div id="code-output-tabs-tabpane-output" aria-labelledby="code-output-tabs-tab-output" role="tabpanel" aria-hidden="false" class="fade tab-pane active show"><div style="width: 100%; height: 20px; overflow-x: scroll;"><div style="width: 0px; height: 20px;"></div></div><div class="scroll-horizontal scroll-vertical table-fixed-height"><div role="alert" class="fade alert alert-info show">Your solution is correct.
          Congratulations, your solution has now been logged in the Solution From Users tab
          </div><p class="text-grey">Your Solution Output:</p><table class="table table-bordered table-striped fixed-width strata-editor-result-table "><thead><tr><th>first_name</th><th>sum</th><th>order_date</th></tr></thead><tbody id="myTable"><tr class="correct"><td>Jill</td><td>275</td><td>2019-04-19</td></tr></tbody></table></div></div></div></div></div></div></div><div class="col-md-1"></div></div></div></main><footer class="footer"><div class="container" style="width: 310px;"><div style="display: flex; justify-content: space-between;"><a href="https://platform.stratascratch.com/terms-and-conditions">Terms and Conditions</a><span>•</span><a href="https://platform.stratascratch.com/privacy-policy">Privacy Policy</a></div></div></footer></div><script type="text/javascript" src="exercise_files/runtime.js"></script><script type="text/javascript" src="exercise_files/styles.js"></script><script type="text/javascript" src="exercise_files/vendorsmain.js"></script><script type="text/javascript" src="exercise_files/main.js"></script><div class="ReactModalPortal"></div><iframe name="__privateStripeMetricsController5490" allowtransparency="true" scrolling="no" allow="payment *" src="exercise_files/m-outer-9fe86c29346daf61dc2cc0586b4fad18.htm" tabindex="-1" style="border: medium none !important; margin: 0px !important; padding: 0px !important; width: 1px !important; min-width: 100% !important; overflow: hidden !important; display: block !important; visibility: hidden !important; position: fixed !important; height: 1px !important; pointer-events: none !important; user-select: none !important;" frameborder="0"></iframe></body></html>