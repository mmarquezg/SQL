<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><style id="ace-github">.ace-github .ace_gutter {background: #e8e8e8;color: #AAA;}.ace-github  {background: #fff;color: #000;}.ace-github .ace_keyword {font-weight: bold;}.ace-github .ace_string {color: #D14;}.ace-github .ace_variable.ace_class {color: teal;}.ace-github .ace_constant.ace_numeric {color: #099;}.ace-github .ace_constant.ace_buildin {color: #0086B3;}.ace-github .ace_support.ace_function {color: #0086B3;}.ace-github .ace_comment {color: #998;font-style: italic;}.ace-github .ace_variable.ace_language  {color: #0086B3;}.ace-github .ace_paren {font-weight: bold;}.ace-github .ace_boolean {font-weight: bold;}.ace-github .ace_string.ace_regexp {color: #009926;font-weight: normal;}.ace-github .ace_variable.ace_instance {color: teal;}.ace-github .ace_constant.ace_language {font-weight: bold;}.ace-github .ace_cursor {color: black;}.ace-github.ace_focus .ace_marker-layer .ace_active-line {background: rgb(255, 255, 204);}.ace-github .ace_marker-layer .ace_active-line {background: rgb(245, 245, 245);}.ace-github .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-github.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-github.ace_nobold .ace_line > span {font-weight: normal !important;}.ace-github .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-github .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-github .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-github .ace_gutter-active-line {background-color : rgba(0, 0, 0, 0.07);}.ace-github .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-github .ace_invisible {color: #BFBFBF}.ace-github .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-github .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}
/*# sourceURL=ace/css/ace-github */</style><style id="error_marker.css">    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }
/*# sourceURL=ace/css/error_marker.css */</style><style id="ace-tm">.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}
/*# sourceURL=ace/css/ace-tm */</style><style id="ace_editor.css">.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}.ace_editor {position: relative;overflow: hidden;padding: 0;font: 12px/normal 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;direction: ltr;text-align: left;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;box-sizing: border-box;min-width: 100%;contain: style size layout;font-variant-ligatures: no-common-ligatures;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: '';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;contain: style size layout;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {position: absolute;top: 0;left: 0;right: 0;padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {contain: strict;position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;contain: strict;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: transparent;color: inherit;z-index: 1000;opacity: 1;}.ace_composition_placeholder { color: transparent }.ace_composition_marker { border-bottom: 1px solid;position: absolute;border-radius: 0;margin-top: 1px;}[ace_nocontext=true] {transform: none!important;filter: none!important;clip-path: none!important;mask : none!important;contain: none!important;perspective: none!important;mix-blend-mode: initial!important;z-index: auto;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;height: 1000000px;contain: style size layout;}.ace_text-layer {font: inherit !important;position: absolute;height: 1000000px;width: 1000000px;contain: style size layout;}.ace_text-layer > .ace_line, .ace_text-layer > .ace_line_group {contain: style size layout;position: absolute;top: 0;left: 0;right: 0;}.ace_hidpi .ace_text-layer,.ace_hidpi .ace_gutter-layer,.ace_hidpi .ace_content,.ace_hidpi .ace_gutter {contain: strict;will-change: transform;}.ace_hidpi .ace_text-layer > .ace_line, .ace_hidpi .ace_text-layer > .ace_line_group {contain: strict;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_hasPlaceholder .ace_hidden-cursors .ace_cursor {opacity: 0;}.ace_smooth-blinking .ace_cursor {transition: opacity 0.18s;}.ace_animate-blinking .ace_cursor {animation-duration: 1000ms;animation-timing-function: step-end;animation-name: blink-ace-animate;animation-iteration-count: infinite;}.ace_animate-blinking.ace_smooth-blinking .ace_cursor {animation-duration: 1000ms;animation-timing-function: ease-in-out;animation-name: blink-ace-animate-smooth;}@keyframes blink-ace-animate {from, to { opacity: 1; }60% { opacity: 0; }}@keyframes blink-ace-animate-smooth {from, to { opacity: 1; }45% { opacity: 1; }60% { opacity: 0; }85% { opacity: 0; }}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_error_bracket {position: absolute;border-bottom: 1px solid #DE5555;border-radius: 0;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;box-sizing: border-box;}.ace_line .ace_fold {box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_inline_button {border: 1px solid lightgray;display: inline-block;margin: -1px 8px;padding: 0 5px;pointer-events: auto;cursor: pointer;}.ace_inline_button:hover {border-color: gray;background: rgba(200,200,200,0.2);display: inline-block;pointer-events: auto;}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}.ace_mobile-menu {position: absolute;line-height: 1.5;border-radius: 4px;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;background: white;box-shadow: 1px 3px 2px grey;border: 1px solid #dcdcdc;color: black;}.ace_dark > .ace_mobile-menu {background: #333;color: #ccc;box-shadow: 1px 3px 2px grey;border: 1px solid #444;}.ace_mobile-button {padding: 2px;cursor: pointer;overflow: hidden;}.ace_mobile-button:hover {background-color: #eee;opacity:1;}.ace_mobile-button:active {background-color: #ddd;}.ace_placeholder {font-family: arial;transform: scale(0.9);transform-origin: left;white-space: pre;opacity: 0.7;margin: 0 10px;}
/*# sourceURL=ace/css/ace_editor.css */</style><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link href="Data_files/css.css" rel="stylesheet"><link href="Data_files/jquery.css" rel="stylesheet"><title>StrataScratch</title><script type="text/javascript" async="" src="Data_files/analytics.js"></script><script type="text/javascript" async="" src="Data_files/js_002"></script><script>!function(n,u){n._rwq=u,n[u]=n[u]||function(){(n[u].q=n[u].q||[]).push(arguments)}}(window,"rewardful")</script><script async="" src="Data_files/rw.js" data-rewardful="509d71"></script><script async="" src="Data_files/js"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-115949776-1")</script><link rel="shortcut icon" href="https://platform.stratascratch.com/fav.png"><link href="Data_files/stylesd7ef1007257ddee643e8.css" rel="stylesheet"><style>.strata-editor-dragbar {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 12px;
  cursor: row-resize;
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9FZGl0b3JEcmFnQmFyLmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQWE7RUFDYix1QkFBdUI7RUFDdkIsbUJBQW1CO0VBQ25CLFlBQVk7RUFDWixrQkFBa0I7QUFDcEIiLCJzb3VyY2VzQ29udGVudCI6WyIuc3RyYXRhLWVkaXRvci1kcmFnYmFyIHtcbiAgZGlzcGxheTogZmxleDtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGhlaWdodDogMTJweDtcbiAgY3Vyc29yOiByb3ctcmVzaXplO1xufVxuIl0sInNvdXJjZVJvb3QiOiIifQ== */</style><style>.strata-editor-container {
  position: relative;
  background-color: #f5f5f5;
  border-radius: 2px;
  border: 1px solid #ccc;
  margin-bottom: 1rem;
}

/* stylelint-disable-next-line selector-class-pattern */
.strata-editor-container .ace_editor {
  line-height: 1.4286;
  word-break: break-all;
  word-wrap: break-word;
  color: #333;
  font-family: Menlo, Monaco, Consolas, 'Courier New', monospace;
}

/* stylelint-disable-next-line selector-class-pattern */
.ace-github .ace_print-margin {
  background: transparent !important;
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9Db2RlRWRpdG9yLmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGtCQUFrQjtFQUNsQix5QkFBeUI7RUFDekIsa0JBQWtCO0VBQ2xCLHNCQUFzQjtFQUN0QixtQkFBbUI7QUFDckI7O0FBRUEsdURBQXVEO0FBQ3ZEO0VBQ0UsbUJBQW1CO0VBQ25CLHFCQUFxQjtFQUNyQixxQkFBcUI7RUFDckIsV0FBVztFQUNYLDhEQUE4RDtBQUNoRTs7QUFFQSx1REFBdUQ7QUFDdkQ7RUFDRSxrQ0FBa0M7QUFDcEMiLCJzb3VyY2VzQ29udGVudCI6WyIuc3RyYXRhLWVkaXRvci1jb250YWluZXIge1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIGJhY2tncm91bmQtY29sb3I6ICNmNWY1ZjU7XG4gIGJvcmRlci1yYWRpdXM6IDJweDtcbiAgYm9yZGVyOiAxcHggc29saWQgI2NjYztcbiAgbWFyZ2luLWJvdHRvbTogMXJlbTtcbn1cblxuLyogc3R5bGVsaW50LWRpc2FibGUtbmV4dC1saW5lIHNlbGVjdG9yLWNsYXNzLXBhdHRlcm4gKi9cbi5zdHJhdGEtZWRpdG9yLWNvbnRhaW5lciAuYWNlX2VkaXRvciB7XG4gIGxpbmUtaGVpZ2h0OiAxLjQyODY7XG4gIHdvcmQtYnJlYWs6IGJyZWFrLWFsbDtcbiAgd29yZC13cmFwOiBicmVhay13b3JkO1xuICBjb2xvcjogIzMzMztcbiAgZm9udC1mYW1pbHk6IE1lbmxvLCBNb25hY28sIENvbnNvbGFzLCAnQ291cmllciBOZXcnLCBtb25vc3BhY2U7XG59XG5cbi8qIHN0eWxlbGludC1kaXNhYmxlLW5leHQtbGluZSBzZWxlY3Rvci1jbGFzcy1wYXR0ZXJuICovXG4uYWNlLWdpdGh1YiAuYWNlX3ByaW50LW1hcmdpbiB7XG4gIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50ICFpbXBvcnRhbnQ7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9 */</style><style>.strata-editor-extension {
  color: #fff;
  background-color: #ccc;
}

.strata-editor-caption-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 2px 9px;
  font-size: 1rem;
}

.strata-editor-dataset-tables {
  border-radius: 0.25rem;
  padding: 0 0.5rem;
  background-color: #b7e9f0;
  color: #249cac;
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9FZGl0b3JDYXB0aW9uQmFyLmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFdBQVc7RUFDWCxzQkFBc0I7QUFDeEI7O0FBRUE7RUFDRSxhQUFhO0VBQ2IsOEJBQThCO0VBQzlCLG1CQUFtQjtFQUNuQixnQkFBZ0I7RUFDaEIsZUFBZTtBQUNqQjs7QUFFQTtFQUNFLHNCQUFzQjtFQUN0QixpQkFBaUI7RUFDakIseUJBQXlCO0VBQ3pCLGNBQWM7QUFDaEIiLCJzb3VyY2VzQ29udGVudCI6WyIuc3RyYXRhLWVkaXRvci1leHRlbnNpb24ge1xuICBjb2xvcjogI2ZmZjtcbiAgYmFja2dyb3VuZC1jb2xvcjogI2NjYztcbn1cblxuLnN0cmF0YS1lZGl0b3ItY2FwdGlvbi1iYXIge1xuICBkaXNwbGF5OiBmbGV4O1xuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIHBhZGRpbmc6IDJweCA5cHg7XG4gIGZvbnQtc2l6ZTogMXJlbTtcbn1cblxuLnN0cmF0YS1lZGl0b3ItZGF0YXNldC10YWJsZXMge1xuICBib3JkZXItcmFkaXVzOiAwLjI1cmVtO1xuICBwYWRkaW5nOiAwIDAuNXJlbTtcbiAgYmFja2dyb3VuZC1jb2xvcjogI2I3ZTlmMDtcbiAgY29sb3I6ICMyNDljYWM7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9 */</style><style>.strata-editor-spin {
  animation: spin 1.5s infinite linear;
}

@keyframes spin {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9RdWVyeUJ1dHRvbi5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxvQ0FBb0M7QUFDdEM7O0FBRUE7RUFDRTtJQUNFLHVCQUF1QjtFQUN6Qjs7RUFFQTtJQUNFLHlCQUF5QjtFQUMzQjtBQUNGIiwic291cmNlc0NvbnRlbnQiOlsiLnN0cmF0YS1lZGl0b3Itc3BpbiB7XG4gIGFuaW1hdGlvbjogc3BpbiAxLjVzIGluZmluaXRlIGxpbmVhcjtcbn1cblxuQGtleWZyYW1lcyBzcGluIHtcbiAgZnJvbSB7XG4gICAgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7XG4gIH1cblxuICB0byB7XG4gICAgdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTtcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ== */</style><style>.strata-editor-buttons-wrapper {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  gap: 0.5rem;
}

.strata-editor-hotkey-message {
  margin-top: 0.25rem;
  color: rgb(130, 130, 130);
  font-size: 0.8125rem;
  text-align: right;
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9RdWVyeUJ1dHRvbnNTZWN0aW9uLmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGFBQWE7RUFDYix5QkFBeUI7RUFDekIsbUJBQW1CO0VBQ25CLFdBQVc7QUFDYjs7QUFFQTtFQUNFLG1CQUFtQjtFQUNuQix5QkFBeUI7RUFDekIsb0JBQW9CO0VBQ3BCLGlCQUFpQjtBQUNuQiIsInNvdXJjZXNDb250ZW50IjpbIi5zdHJhdGEtZWRpdG9yLWJ1dHRvbnMtd3JhcHBlciB7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGdhcDogMC41cmVtO1xufVxuXG4uc3RyYXRhLWVkaXRvci1ob3RrZXktbWVzc2FnZSB7XG4gIG1hcmdpbi10b3A6IDAuMjVyZW07XG4gIGNvbG9yOiByZ2IoMTMwLCAxMzAsIDEzMCk7XG4gIGZvbnQtc2l6ZTogMC44MTI1cmVtO1xuICB0ZXh0LWFsaWduOiByaWdodDtcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0= */</style><style>.strata-editor-result-table {
  font-size: 1rem;
}

.table-striped.strata-editor-result-table tr.wrong {
  background-color: #ffb9b9;
}

.table-striped.strata-editor-result-table tr.correct {
  background-color: #90ee90;
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9RdWVyeVJlc3VsdFRhYmxlLmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGVBQWU7QUFDakI7O0FBRUE7RUFDRSx5QkFBeUI7QUFDM0I7O0FBRUE7RUFDRSx5QkFBeUI7QUFDM0IiLCJzb3VyY2VzQ29udGVudCI6WyIuc3RyYXRhLWVkaXRvci1yZXN1bHQtdGFibGUge1xuICBmb250LXNpemU6IDFyZW07XG59XG5cbi50YWJsZS1zdHJpcGVkLnN0cmF0YS1lZGl0b3ItcmVzdWx0LXRhYmxlIHRyLndyb25nIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmYjliOTtcbn1cblxuLnRhYmxlLXN0cmlwZWQuc3RyYXRhLWVkaXRvci1yZXN1bHQtdGFibGUgdHIuY29ycmVjdCB7XG4gIGJhY2tncm91bmQtY29sb3I6ICM5MGVlOTA7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9 */</style><style>.strata-editor-output-title {
  margin-top: 1rem;
  font-size: 1.1875rem;
  color: rgb(130, 130, 130);
}

.white-space-pre-wrap {
  white-space: pre-wrap;
}

.strata-editor-console-output {
  padding: 1rem 2rem;
}

.strata-editor-alert {
  padding: 0.75rem 1.25rem;
  margin-bottom: 1rem;
  font-size: 1rem;
  border-radius: 0.25rem;
}

.strata-editor-alert.info {
  background-color: #b7e9f0;
  color: #249cac;
}

.strata-editor-alert.warning {
  background-color: #fff3cd;
  color: #856404;
}

.strata-editor-alert.danger {
  background-color: #ffb9b9;
  color: #c60201;
}

.strata-editor-results-table-wrapper {
  max-height: 24rem;
  overflow: auto;
  white-space: nowrap;
}

.strata-editor-results-table-wrapper table {
  margin-bottom: 0;
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9FeGVjdXRpb25SZXN1bHRzLmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGdCQUFnQjtFQUNoQixvQkFBb0I7RUFDcEIseUJBQXlCO0FBQzNCOztBQUVBO0VBQ0UscUJBQXFCO0FBQ3ZCOztBQUVBO0VBQ0Usa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0Usd0JBQXdCO0VBQ3hCLG1CQUFtQjtFQUNuQixlQUFlO0VBQ2Ysc0JBQXNCO0FBQ3hCOztBQUVBO0VBQ0UseUJBQXlCO0VBQ3pCLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSx5QkFBeUI7RUFDekIsY0FBYztBQUNoQjs7QUFFQTtFQUNFLHlCQUF5QjtFQUN6QixjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsaUJBQWlCO0VBQ2pCLGNBQWM7RUFDZCxtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSxnQkFBZ0I7QUFDbEIiLCJzb3VyY2VzQ29udGVudCI6WyIuc3RyYXRhLWVkaXRvci1vdXRwdXQtdGl0bGUge1xuICBtYXJnaW4tdG9wOiAxcmVtO1xuICBmb250LXNpemU6IDEuMTg3NXJlbTtcbiAgY29sb3I6IHJnYigxMzAsIDEzMCwgMTMwKTtcbn1cblxuLndoaXRlLXNwYWNlLXByZS13cmFwIHtcbiAgd2hpdGUtc3BhY2U6IHByZS13cmFwO1xufVxuXG4uc3RyYXRhLWVkaXRvci1jb25zb2xlLW91dHB1dCB7XG4gIHBhZGRpbmc6IDFyZW0gMnJlbTtcbn1cblxuLnN0cmF0YS1lZGl0b3ItYWxlcnQge1xuICBwYWRkaW5nOiAwLjc1cmVtIDEuMjVyZW07XG4gIG1hcmdpbi1ib3R0b206IDFyZW07XG4gIGZvbnQtc2l6ZTogMXJlbTtcbiAgYm9yZGVyLXJhZGl1czogMC4yNXJlbTtcbn1cblxuLnN0cmF0YS1lZGl0b3ItYWxlcnQuaW5mbyB7XG4gIGJhY2tncm91bmQtY29sb3I6ICNiN2U5ZjA7XG4gIGNvbG9yOiAjMjQ5Y2FjO1xufVxuXG4uc3RyYXRhLWVkaXRvci1hbGVydC53YXJuaW5nIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjNjZDtcbiAgY29sb3I6ICM4NTY0MDQ7XG59XG5cbi5zdHJhdGEtZWRpdG9yLWFsZXJ0LmRhbmdlciB7XG4gIGJhY2tncm91bmQtY29sb3I6ICNmZmI5Yjk7XG4gIGNvbG9yOiAjYzYwMjAxO1xufVxuXG4uc3RyYXRhLWVkaXRvci1yZXN1bHRzLXRhYmxlLXdyYXBwZXIge1xuICBtYXgtaGVpZ2h0OiAyNHJlbTtcbiAgb3ZlcmZsb3c6IGF1dG87XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG59XG5cbi5zdHJhdGEtZWRpdG9yLXJlc3VsdHMtdGFibGUtd3JhcHBlciB0YWJsZSB7XG4gIG1hcmdpbi1ib3R0b206IDA7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9 */</style><style>.strata-editor-code-widget {
  margin-bottom: 2rem;
}

.strata-editor-question-link {
  font-size: 1rem;
}

.strata-editor-error-inset {
  position: absolute;
  inset: 1rem;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  background-color: #f2f2f2;
  font-weight: 500;
  z-index: 5;
}

/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9Db2RlRWRpdG9yV2lkZ2V0LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLGVBQWU7QUFDakI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsV0FBVztFQUNYLGFBQWE7RUFDYixzQkFBc0I7RUFDdEIsdUJBQXVCO0VBQ3ZCLG1CQUFtQjtFQUNuQixrQkFBa0I7RUFDbEIseUJBQXlCO0VBQ3pCLGdCQUFnQjtFQUNoQixVQUFVO0FBQ1oiLCJzb3VyY2VzQ29udGVudCI6WyIuc3RyYXRhLWVkaXRvci1jb2RlLXdpZGdldCB7XG4gIG1hcmdpbi1ib3R0b206IDJyZW07XG59XG5cbi5zdHJhdGEtZWRpdG9yLXF1ZXN0aW9uLWxpbmsge1xuICBmb250LXNpemU6IDFyZW07XG59XG5cbi5zdHJhdGEtZWRpdG9yLWVycm9yLWluc2V0IHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBpbnNldDogMXJlbTtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgYmFja2dyb3VuZC1jb2xvcjogI2YyZjJmMjtcbiAgZm9udC13ZWlnaHQ6IDUwMDtcbiAgei1pbmRleDogNTtcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0= */</style><script src="Data_files/v3"></script><style data-emotion="css" data-s=""></style><script charset="utf-8" src="Data_files/19.js"></script><meta name="description" content="StrataScratch" data-react-helmet="true"></head><body style="" class=""><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><header class="top" style="position: relative; z-index: 1000;"><nav class="navbar-static-top navbar-inverse navbar navbar-expand-md navbar-light"><a href="https://stratascratch.com/" class="navbar-brand"><img src="Data_files/superset-logo.png" alt="Superset Logo" width="126"></a><button aria-controls="basic-navbar-nav" type="button" aria-label="Toggle navigation" class="navbar-toggler collapsed" style=""><span class="navbar-toggler-icon"></span></button><div class="navbar-collapse collapse" id="basic-navbar-nav"><div class="mr-auto navbar-nav"><li><a href="https://platform.stratascratch.com/coding" data-rb-event-key="/coding" class="navbar-marging nav-link">Coding Questions</a></li><li><a href="https://platform.stratascratch.com/technical" data-rb-event-key="/technical" class="navbar-marging nav-link">Non-coding Questions</a></li></div><div class="navbar-nav"><li><a href="https://platform.stratascratch.com/pricing" data-rb-event-key="/pricing" class="navbar-marging nav-link"><i class="fa fa-lock" style="color: gold;"></i> Upgrade to Premium</a></li><li class="float-right"><div class="dropdown"><a href="" class="navbar-marging nav-link"><i class="fa fa-user"></i> Profile</a></div></li><li class="float-right"><a href="#" class="navbar-marging nav-link" role="button"><i class="fa fa-fw fa-sign-out"></i> Logout</a></li></div></div></nav></header><main class=""><div class="container-fluid"><div class="row"><div class="col-md-12" style="padding-left: 5%; padding-right: 5%;"><div class="row"><div class="col-md-12"><a style="margin-right: 20px;" href="https://platform.stratascratch.com/coding">Back to Questions</a><select class="custom-select-option select-language" name="language"><option value="1" selected="selected">PostgreSQL</option><option value="2">Python</option><option value="3">MySQL (βeta)</option></select><span style="margin-left: 30px;"><a href="https://platform.stratascratch.com/coding/10285-acceptance-rate-by-date?python=" class="btn" style="color: green; margin-top: 4px; margin-right: 6px; font-size: 20px;"><i class="fa fa-arrow-left"></i></a><div class="question-select css-b62m3t-container"><span id="react-select-40-live-region" class="css-7pg0cj-a11yText"></span><span aria-live="polite" aria-atomic="false" aria-relevant="additions text" class="css-7pg0cj-a11yText"></span><div class=" css-1s2u09g-control"><div class=" css-1d8n9bt"><div class=" css-qc6sy-singleValue">Highest Energy Consumption</div><div class=" css-ackcql" data-value=""><input class="" style="color: inherit; background: rgba(0, 0, 0, 0) none repeat scroll 0px center; opacity: 1; width: 100%; grid-area: 1 / 2; font: inherit; min-width: 2px; border: 0px none; margin: 0px; outline: currentcolor none 0px; padding: 0px;" autocapitalize="none" autocomplete="off" autocorrect="off" id="react-select-40-input" spellcheck="false" tabindex="0" type="text" aria-autocomplete="list" aria-expanded="false" aria-haspopup="true" aria-controls="react-select-40-listbox" aria-owns="react-select-40-listbox" role="combobox"></div></div><div class=" css-1wy0on6"><span class=" css-1okebmr-indicatorSeparator"></span><div class=" css-tlfecz-indicatorContainer" aria-hidden="true"><svg height="20" width="20" viewBox="0 0 20 20" aria-hidden="true" focusable="false" class="css-8mmkcg"><path d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"></path></svg></div></div></div></div><a href="https://platform.stratascratch.com/coding/10322-finding-user-purchases?python=" class="btn" style="color: green; margin-top: 4px; margin-left: 6px; font-size: 20px;"><i class="fa fa-arrow-right"></i></a></span></div></div><div class="row m-t-10"><div class="col-md-6"><div class="m-t-10" style="overflow: hidden scroll;"><div class=""><div><ul class="left_side_tab nav nav-tabs" role="tablist"><li class="nav-item"><a href="#" role="tab" data-rb-event-key="question" id="question-details-tabs-tab-question" aria-controls="question-details-tabs-tabpane-question" aria-selected="true" class="nav-link active">Question</a></li><li class="nav-item"><a href="#" role="tab" data-rb-event-key="submissions" id="question-details-tabs-tab-submissions" aria-controls="question-details-tabs-tabpane-submissions" aria-selected="false" class="nav-link">Your Submissions</a></li><li class="nav-item"><a href="#" role="tab" data-rb-event-key="comments" id="question-details-tabs-tab-comments" aria-controls="question-details-tabs-tabpane-comments" aria-selected="false" class="nav-link">Solution Discussions</a></li><li class="nav-item"><a href="#" role="tab" data-rb-event-key="solutions" id="question-details-tabs-tab-solutions" aria-controls="question-details-tabs-tabpane-solutions" aria-selected="false" class="nav-link">Solutions from Users</a></li></ul><div class="tab-content"><div id="question-details-tabs-tabpane-question" aria-labelledby="question-details-tabs-tab-question" role="tabpanel" aria-hidden="false" class="fade tab-pane active show"><div class="m-t-10" style="max-height: 1045px;"><div class="row m-0"><button type="button" title="Bookmark this question" class="bookmark" style="margin-right: 10px;"><i class="fa fa-lg fa-bookmark-o" aria-hidden="true"></i></button><div><div class="badge badge-pill badge-orange">Medium</div><div class="badge badge-pill badge-primary m-l-5">Meta/Facebook</div><span class="badge badge-pill m-l-5 badge-info">Interview Questions</span><div class="badge badge-pill m-l-5 badge-secondary">ID 10064</div></div><div style="align-self: center; margin-left: auto;" class="hotkey-message">Interview Question Date: Mar 2020</div></div><div class="short_question_text m-t-10">Highest Energy Consumption</div><div class="m-t-5 question_text preserve-linebreaks">Find the date with the highest total energy consumption from the Meta/Facebook data centers. Output the date along with the total energy consumption across all data centers.</div><div role="alert" class="fade m-t-20 question-alert alert alert-info show"><div>Tables: fb_eu_energy, fb_asia_energy, fb_na_energy</div></div></div><button type="button" class="m-t-10 btn btn-sm btn-primary">Approach Hints</button><button type="button" class="m-t-10 m-l-10 btn btn-sm btn-primary">Expected Output</button><div class="hint hint_text m-t-20"><div class="hotkey-message" style="margin-bottom: 7px;">All required columns and the first 5 rows of the solution are shown</div><div style="width: 100%; height: 20px; overflow-x: scroll;"><div style="width: 0px; height: 20px;"></div></div><div class="scroll-horizontal scroll-vertical table-fixed-height"><table class="table table-bordered table-striped fixed-width strata-editor-result-table "><thead><tr><th>date</th><th>total_energy</th></tr></thead><tbody id="myTable"><tr class=""><td>2020-01-06</td><td>1250</td></tr><tr class=""><td>2020-01-07</td><td>1250</td></tr></tbody></table></div></div></div><div id="question-details-tabs-tabpane-comments" aria-labelledby="question-details-tabs-tab-comments" role="tabpanel" aria-hidden="true" class="fade tab-pane"><div style="max-height: 1045px;"><div><div class="strata-editor-container"><div id="ace-editor" style="width: 100%; height: 382px; font-size: 0.8125rem;" class=" ace_editor ace-github"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; font-size: 1px; top: 361px; left: 429px; height: 1px; width: 1px;" readonly="readonly" wrap="off"></textarea><div class="ace_gutter" aria-hidden="true" style="left: 0px; width: 47px;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1000000px; top: 0px; left: 0px; width: 47px;"><div class="ace_gutter-cell " style="height: 19px; top: 0px;">1<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 19px;">2<span class="ace_fold-widget ace_start ace_open" style="height: 19px; display: inline-block;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 38px;">3<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 57px;">4<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 76px;">5<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 95px;">6<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 114px;">7<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 133px;">8<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 152px;">9<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 171px;">10<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 190px;">11<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 209px;">12<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 228px;">13<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 247px;">14<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 266px;">15<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 285px;">16<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 304px;">17<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 323px;">18<span style="display: none;"></span></div><div class="ace_gutter-cell ace_gutter-active-line " style="height: 19px; top: 342px;">19<span style="display: none;"></span></div></div></div><div class="ace_scroller" style="line-height: 19px; left: 47px; right: 0px; bottom: 0px;"><div class="ace_content" style="top: 0px; left: 0px; width: 755px; height: 420px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 564px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div style="height: 19px; top: 342px; left: 0px; right: 0px;" class="ace_active-line"></div></div><div class="ace_layer ace_text-layer" style="height: 1000000px; margin: 0px 4px; top: 0px; left: 0px;"><div style="height: 19px; top: 0px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_identifier">WITH</span> <span class="ace_identifier">total_energy</span> <span class="ace_keyword">AS</span></div></div><div style="height: 19px; top: 19px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">  <span class="ace_paren ace_lparen">(</span><span class="ace_keyword">SELECT</span> *</div></div><div style="height: 19px; top: 38px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">   <span class="ace_keyword">FROM</span> <span class="ace_identifier">fb_eu_energy</span> <span class="ace_identifier">eu</span></div></div><div style="height: 19px; top: 57px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">   <span class="ace_keyword">UNION</span> <span class="ace_identifier">ALL</span> <span class="ace_keyword">SELECT</span> *</div></div><div style="height: 19px; top: 76px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">   <span class="ace_keyword">FROM</span> <span class="ace_identifier">fb_asia_energy</span> <span class="ace_identifier">asia</span></div></div><div style="height: 19px; top: 95px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">   <span class="ace_keyword">UNION</span> <span class="ace_identifier">ALL</span> <span class="ace_keyword">SELECT</span> *</div></div><div style="height: 19px; top: 114px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">   <span class="ace_keyword">FROM</span> <span class="ace_identifier">fb_na_energy</span> <span class="ace_identifier">na</span><span class="ace_paren ace_rparen">)</span>,</div></div><div style="height: 19px; top: 133px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span> <span class="ace_identifier">energy_by_date</span> <span class="ace_keyword">AS</span></div></div><div style="height: 19px; top: 152px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">  <span class="ace_paren ace_lparen">(</span><span class="ace_keyword">SELECT</span> <span class="ace_storage ace_type">date</span>, <span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">consumption</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">AS</span> <span class="ace_identifier">total_energy</span></div></div><div style="height: 19px; top: 171px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">   <span class="ace_keyword">FROM</span> <span class="ace_identifier">total_energy</span></div></div><div style="height: 19px; top: 190px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">   <span class="ace_keyword">GROUP</span> <span class="ace_keyword">BY</span> <span class="ace_storage ace_type">date</span></div></div><div style="height: 19px; top: 209px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">   <span class="ace_keyword">ORDER</span> <span class="ace_keyword">BY</span> <span class="ace_storage ace_type">date</span> <span class="ace_keyword">ASC</span><span class="ace_paren ace_rparen">)</span>,</div></div><div style="height: 19px; top: 228px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span> <span class="ace_identifier">max_energy</span> <span class="ace_keyword">AS</span></div></div><div style="height: 19px; top: 247px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">  <span class="ace_paren ace_lparen">(</span><span class="ace_keyword">SELECT</span> <span class="ace_support ace_function">max</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">total_energy</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">AS</span> <span class="ace_identifier">max_energy</span></div></div><div style="height: 19px; top: 266px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">   <span class="ace_keyword">FROM</span> <span class="ace_identifier">energy_by_date</span><span class="ace_paren ace_rparen">)</span></div></div><div style="height: 19px; top: 285px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">SELECT</span> <span class="ace_identifier">ebd</span>.<span class="ace_storage ace_type">date</span>,</div></div><div style="height: 19px; top: 304px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span>   <span class="ace_identifier">ebd</span>.<span class="ace_identifier">total_energy</span></div></div><div style="height: 19px; top: 323px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">FROM</span> <span class="ace_identifier">energy_by_date</span> <span class="ace_identifier">ebd</span></div></div><div style="height: 19px; top: 342px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">JOIN</span> <span class="ace_identifier">max_energy</span> <span class="ace_identifier">me</span> <span class="ace_keyword">ON</span> <span class="ace_identifier">ebd</span>.<span class="ace_identifier">total_energy</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_identifier">me</span>.<span class="ace_identifier">max_energy</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="display: block; top: 342px; left: 382px; width: 7px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px; display: none;"><div class="ace_scrollbar-inner" style="width: 22px; height: 361px;">&nbsp;</div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 47px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 785px;">&nbsp;</div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה</div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div class="strata-editor-extension strata-editor-dragbar" role="separator"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg></div></div><hr><button type="button" class="bg-none btn-link-borderless"><h5 class="resources-header"><i class="fa fa-lg fa-angle-double-up font-weight-bold" aria-hidden="true"></i><span style="margin-left: 10px;">Resources</span></h5></button><h5 class="resources-sub-header"><span class="resources-title">Resources For This Question</span></h5><div class="row" style="margin-left: 15px; padding-bottom: 15px;"><a style="margin-right: 20px;" class="resource-item" target="_blank" rel="noopener noreferrer"><i class="fa fa-video-camera" aria-hidden="true" style="margin-right: 5px;"></i>Video Solution for SQL</a><a style="margin-right: 20px;" class="resource-item" target="_blank" rel="noopener noreferrer" href="https://www.stratascratch.com/blog/facebook-meta-sql-interview-questions/">Facebook (Meta) SQL Interview Questions</a></div><h5 class="resources-sub-header"><span class="resources-title">Resources For All Interview Questions</span></h5><div class="row" style="margin-left: 15px;"><a style="margin-right: 20px;" class="resource-item" target="_blank" rel="noopener noreferrer" href="https://www.stratascratch.com/blog/how-to-answer-data-science-coding-interview-questions/">How to Answer Data Science Coding Interview Questions</a><a style="margin-right: 20px;" class="resource-item" target="_blank" rel="noopener noreferrer" href="https://www.stratascratch.com/blog/best-practices-to-write-sql-queries-how-to-structure-your-code/">Best Practices to Write SQL Queries: How To Structure Your Code</a><a style="margin-right: 20px;" class="resource-item" target="_blank" rel="noopener noreferrer" href="https://www.stratascratch.com/blog/python-pandas-interview-questions-for-data-science/">Python Pandas Interview Questions for Data Science</a><a style="margin-right: 20px;" class="resource-item" target="_blank" rel="noopener noreferrer" href="https://www.stratascratch.com/blog/python-pandas-interview-questions-for-data-science-part-2/">Python Pandas Interview Questions for Data Science (Part 2)</a></div></div><div><hr><div class="comment-form"><div class="react-mde react-mde-tabbed-layout"><div class="mde-header"><div class="mde-tabs"><button type="button" class="selected">Write</button><button type="button" class="">Preview</button></div><ul class="mde-header-group"><li class="mde-header-item"><button data-name="header" tabindex="-1" aria-label="Add header" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="heading" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M496 80V48c0-8.837-7.163-16-16-16H320c-8.837 0-16 7.163-16 16v32c0 8.837 7.163 16 16 16h37.621v128H154.379V96H192c8.837 0 16-7.163 16-16V48c0-8.837-7.163-16-16-16H32c-8.837 0-16 7.163-16 16v32c0 8.837 7.163 16 16 16h37.275v320H32c-8.837 0-16 7.163-16 16v32c0 8.837 7.163 16 16 16h160c8.837 0 16-7.163 16-16v-32c0-8.837-7.163-16-16-16h-37.621V288H357.62v128H320c-8.837 0-16 7.163-16 16v32c0 8.837 7.163 16 16 16h160c8.837 0 16-7.163 16-16v-32c0-8.837-7.163-16-16-16h-37.275V96H480c8.837 0 16-7.163 16-16z"></path></svg></button></li><li class="mde-header-item"><button data-name="bold" tabindex="-1" aria-label="Add bold text" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="bold" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" data-fa-i2svg=""><path fill="currentColor" d="M304.793 243.891c33.639-18.537 53.657-54.16 53.657-95.693 0-48.236-26.25-87.626-68.626-104.179C265.138 34.01 240.849 32 209.661 32H24c-8.837 0-16 7.163-16 16v33.049c0 8.837 7.163 16 16 16h33.113v318.53H24c-8.837 0-16 7.163-16 16V464c0 8.837 7.163 16 16 16h195.69c24.203 0 44.834-1.289 66.866-7.584C337.52 457.193 376 410.647 376 350.014c0-52.168-26.573-91.684-71.207-106.123zM142.217 100.809h67.444c16.294 0 27.536 2.019 37.525 6.717 15.828 8.479 24.906 26.502 24.906 49.446 0 35.029-20.32 56.79-53.029 56.79h-76.846V100.809zm112.642 305.475c-10.14 4.056-22.677 4.907-31.409 4.907h-81.233V281.943h84.367c39.645 0 63.057 25.38 63.057 63.057.001 28.425-13.66 52.483-34.782 61.284z"></path></svg></button></li><li class="mde-header-item"><button data-name="italic" tabindex="-1" aria-label="Add italic text" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="italic" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" data-fa-i2svg=""><path fill="currentColor" d="M204.758 416h-33.849l62.092-320h40.725a16 16 0 0 0 15.704-12.937l6.242-32C297.599 41.184 290.034 32 279.968 32H120.235a16 16 0 0 0-15.704 12.937l-6.242 32C96.362 86.816 103.927 96 113.993 96h33.846l-62.09 320H46.278a16 16 0 0 0-15.704 12.935l-6.245 32C22.402 470.815 29.967 480 40.034 480h158.479a16 16 0 0 0 15.704-12.935l6.245-32c1.927-9.88-5.638-19.065-15.704-19.065z"></path></svg></button></li><li class="mde-header-item"><button data-name="strikethrough" tabindex="-1" aria-label="Add strikethrough text" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="strikethrough" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M496 288H16c-8.837 0-16-7.163-16-16v-32c0-8.837 7.163-16 16-16h480c8.837 0 16 7.163 16 16v32c0 8.837-7.163 16-16 16zm-214.666 16c27.258 12.937 46.524 28.683 46.524 56.243 0 33.108-28.977 53.676-75.621 53.676-32.325 0-76.874-12.08-76.874-44.271V368c0-8.837-7.164-16-16-16H113.75c-8.836 0-16 7.163-16 16v19.204c0 66.845 77.717 101.82 154.487 101.82 88.578 0 162.013-45.438 162.013-134.424 0-19.815-3.618-36.417-10.143-50.6H281.334zm-30.952-96c-32.422-13.505-56.836-28.946-56.836-59.683 0-33.92 30.901-47.406 64.962-47.406 42.647 0 64.962 16.593 64.962 32.985V136c0 8.837 7.164 16 16 16h45.613c8.836 0 16-7.163 16-16v-30.318c0-52.438-71.725-79.875-142.575-79.875-85.203 0-150.726 40.972-150.726 125.646 0 22.71 4.665 41.176 12.777 56.547h129.823z"></path></svg></button></li></ul><ul class="mde-header-group"><li class="mde-header-item"><button data-name="link" tabindex="-1" aria-label="Add a link" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="link" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></button></li><li class="mde-header-item"><button data-name="quote" tabindex="-1" aria-label="Insert a quote" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="quote-right" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M512 80v128c0 137.018-63.772 236.324-193.827 271.172-15.225 4.08-30.173-7.437-30.173-23.199v-33.895c0-10.057 6.228-19.133 15.687-22.55C369.684 375.688 408 330.054 408 256h-72c-26.51 0-48-21.49-48-48V80c0-26.51 21.49-48 48-48h128c26.51 0 48 21.49 48 48zM176 32H48C21.49 32 0 53.49 0 80v128c0 26.51 21.49 48 48 48h72c0 74.054-38.316 119.688-104.313 143.528C6.228 402.945 0 412.021 0 422.078v33.895c0 15.762 14.948 27.279 30.173 23.199C160.228 444.324 224 345.018 224 208V80c0-26.51-21.49-48-48-48z"></path></svg></button></li><li class="mde-header-item"><button data-name="code" tabindex="-1" aria-label="Insert code" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="code" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" data-fa-i2svg=""><path fill="currentColor" d="M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"></path></svg></button></li><li class="mde-header-item"><button data-name="image" tabindex="-1" aria-label="Add image" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="image" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"></path></svg></button></li></ul><ul class="mde-header-group"><li class="mde-header-item"><button data-name="unordered-list" tabindex="-1" aria-label="Add unordered list" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="list-ul" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M96 96c0 26.51-21.49 48-48 48S0 122.51 0 96s21.49-48 48-48 48 21.49 48 48zM48 208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm0 160c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm96-236h352c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path></svg></button></li><li class="mde-header-item"><button data-name="ordered-list" tabindex="-1" aria-label="Add ordered list" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="list-ol" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M3.263 139.527c0-7.477 3.917-11.572 11.573-11.572h15.131V88.078c0-5.163.534-10.503.534-10.503h-.356s-1.779 2.67-2.848 3.738c-4.451 4.273-10.504 4.451-15.666-1.068l-5.518-6.231c-5.342-5.341-4.984-11.216.534-16.379l21.72-19.938C32.815 33.602 36.732 32 42.785 32H54.89c7.656 0 11.749 3.916 11.749 11.572v84.384h15.488c7.655 0 11.572 4.094 11.572 11.572v8.901c0 7.477-3.917 11.572-11.572 11.572H14.836c-7.656 0-11.573-4.095-11.573-11.572v-8.902zM2.211 304.591c0-47.278 50.955-56.383 50.955-69.165 0-7.18-5.954-8.755-9.28-8.755-3.153 0-6.479 1.051-9.455 3.852-5.079 4.903-10.507 7.004-16.111 2.451l-8.579-6.829c-5.779-4.553-7.18-9.805-2.803-15.409C13.592 201.981 26.025 192 47.387 192c19.437 0 44.476 10.506 44.476 39.573 0 38.347-46.753 46.402-48.679 56.909h39.049c7.529 0 11.557 4.027 11.557 11.382v8.755c0 7.354-4.028 11.382-11.557 11.382h-67.94c-7.005 0-12.083-4.028-12.083-11.382v-4.028zM5.654 454.61l5.603-9.28c3.853-6.654 9.105-7.004 15.584-3.152 4.903 2.101 9.63 3.152 14.359 3.152 10.155 0 14.358-3.502 14.358-8.23 0-6.654-5.604-9.106-15.934-9.106h-4.728c-5.954 0-9.28-2.101-12.258-7.88l-1.05-1.926c-2.451-4.728-1.226-9.806 2.801-14.884l5.604-7.004c6.829-8.405 12.257-13.483 12.257-13.483v-.35s-4.203 1.051-12.608 1.051H16.685c-7.53 0-11.383-4.028-11.383-11.382v-8.755c0-7.53 3.853-11.382 11.383-11.382h58.484c7.529 0 11.382 4.027 11.382 11.382v3.327c0 5.778-1.401 9.806-5.079 14.183l-17.509 20.137c19.611 5.078 28.716 20.487 28.716 34.845 0 21.363-14.358 44.126-48.503 44.126-16.636 0-28.192-4.728-35.896-9.455-5.779-4.202-6.304-9.805-2.626-15.934zM144 132h352c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path></svg></button></li><li class="mde-header-item"><button data-name="checked-list" tabindex="-1" aria-label="Add checked list" type="button"><svg class="svg-icon" aria-hidden="true" data-prefix="fas" data-icon="tasks" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M208 132h288c8.8 0 16-7.2 16-16V76c0-8.8-7.2-16-16-16H208c-8.8 0-16 7.2-16 16v40c0 8.8 7.2 16 16 16zm0 160h288c8.8 0 16-7.2 16-16v-40c0-8.8-7.2-16-16-16H208c-8.8 0-16 7.2-16 16v40c0 8.8 7.2 16 16 16zm0 160h288c8.8 0 16-7.2 16-16v-40c0-8.8-7.2-16-16-16H208c-8.8 0-16 7.2-16 16v40c0 8.8 7.2 16 16 16zM64 368c-26.5 0-48.6 21.5-48.6 48s22.1 48 48.6 48 48-21.5 48-48-21.5-48-48-48zm92.5-299l-72.2 72.2-15.6 15.6c-4.7 4.7-12.9 4.7-17.6 0L3.5 109.4c-4.7-4.7-4.7-12.3 0-17l15.7-15.7c4.7-4.7 12.3-4.7 17 0l22.7 22.1 63.7-63.3c4.7-4.7 12.3-4.7 17 0l17 16.5c4.6 4.7 4.6 12.3-.1 17zm0 159.6l-72.2 72.2-15.7 15.7c-4.7 4.7-12.9 4.7-17.6 0L3.5 269c-4.7-4.7-4.7-12.3 0-17l15.7-15.7c4.7-4.7 12.3-4.7 17 0l22.7 22.1 63.7-63.7c4.7-4.7 12.3-4.7 17 0l17 17c4.6 4.6 4.6 12.2-.1 16.9z"></path></svg></button></li></ul></div><div class=""><div class="mde-textarea-wrapper"><textarea class="mde-text" style="height: 200px;" data-testid="text-area" placeholder="Discuss approaches to solutions here and get an active discussion going. You can also add markdown language to highlight code like ```select * from table_name```."></textarea></div></div></div> <br><button type="button" class="btn btn-sm btn-primary m-t-5"><i class="fa fa-paper-plane"></i> Post</button><a href="https://www.markdownguide.org/getting-started/" target="_blank" class="pull-right markdown-help" rel="noreferrer"><i class="fa fa-question-circle"></i></a></div><hr><div class="comments-tree"><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">14</span></div><div class="right"><b>Team@StrataScratch</b><br><small>12/11/2020, 6:00 PM</small><div class="badge badge-pill m-l-5 badge-secondary btn-gold comment-tag">Top</div><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div><div class="badge badge-pill m-l-5 badge-secondary comment-tag">python</div></div></div><div class="bottom"><p>This
 question has been slightly rewritten on Dec 11, 2020. I changed the 
names of the database table and added a scenario that you'll need to 
handle to get to the right solution. Joining/Merging the table will not 
work because you'll lose dates when you join all 3 tables. You could use
 a cross join but that is compute heavy and the official solution shows a
 more optimal way of preserving all the dates and energy values. There's
 also the situation where there could be 2 dates where there are max 
energy consumptions so you'll need to write your query to handle that 
situation. </p><p>I like this question because it's reflective of what 
interviewers will test you on and these are real scenarios you'd need to
 handle on the job.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">22</span></div><div class="right"><b>frederikmuller</b><br><small>5/7/2021, 10:50 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>quite happy with this one:</p><pre><code>SELECT date, total_energy FROM
(SELECT date, SUM(consumption) AS total_energy, RANK() OVER (ORDER BY SUM(consumption) DESC) AS r 
FROM
(SELECT * FROM fb_eu_energy
UNION ALL
SELECT * FROM fb_asia_energy
UNION ALL
SELECT * FROM fb_na_energy) fb_energy
GROUP BY date) fb_energy_ranked
WHERE r = 1</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">3</span></div><div class="right"><b>frederikmuller</b><br><small>5/7/2021, 11:09 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>If
 someone were to ask for the top 5 dates with the highest energy 
consumption, I could easily change up my query by changing the rank 
filter, making it more flexible than working with MAX().</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">1</span></div><div class="right"><b>Kasia@StrataScratch</b><br><small>5/8/2021, 3:33 PM</small></div></div><div class="bottom"><p>Actually rank is successful choice. I encourage you to check the difference between <code>rank</code> and <code>dense_rank</code> functions especially when looking for top n results. </p><p><a href="https://www.eversql.com/rank-vs-dense_rank-vs-row_number-in-postgresql/">https://www.eversql.com/rank-vs-dense_rank-vs-row_number-in-postgresql/</a></p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">2</span></div><div class="right"><b>JackO'Lantern92</b><br><small>11/12/2021, 5:29 PM</small></div></div><div class="bottom"><p>I still believe it's dense_Rank()</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>11/13/2021, 2:50 PM</small></div></div><div class="bottom"><p>Hi JackO'Lantern92,</p><p>And we value your opinion, it always depends on what you want to do.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>dwisjp</b><br><small>12/11/2021, 9:02 AM</small></div></div><div class="bottom"><p>Why do we use union All here? I use Union and got the same answer</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>12/14/2021, 8:59 AM</small></div></div><div class="bottom"><p>Hi dwisjp,</p><p>In
 case there there is a duplicate between different data centers - 
exactly the same consumption on the same date, solution with UNION would
 be incorrect because it would remove the duplicate which will lead to 
the wrong total (summed up) consumption.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">1</span></div><div class="right"><b>MacDonalds88</b><br><small>12/28/2021, 1:45 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>You can solve it using outer joins by using the <code>coalesce</code> function.</p><pre><code class="language-sql">WITH totals AS (
    SELECT
        COALESCE(a.date, b.date, c.date) date,
        COALESCE(a.consumption, 0) + COALESCE(b.consumption, 0) + COALESCE(c.consumption, 0) total_consumption
    FROM fb_eu_energy a
    FULL OUTER JOIN fb_asia_energy b ON a.date = b.date
    FULL OUTER JOIN fb_na_energy c ON COALESCE(a.date, b.date) = c.date
    ORDER BY total_consumption DESC)

SELECT date, total_consumption
FROM totals
WHERE total_consumption = (SELECT MAX(total_consumption) FROM totals)</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>zhewang</b><br><small>1/21/2022, 2:50 AM</small></div></div><div class="bottom"><p>is union going to be better than full join?</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>1/23/2022, 9:48 AM</small></div></div><div class="bottom"><p>Hi zhewang,</p><p>Both solutions are fine for us. Execution time is very similar so there's no benefit of one solution over the other.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">1</span></div><div class="right"><b>priyansh1990</b><br><small>10/9/2021, 7:46 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><pre><code>with cte as (select *, 'EU' as place from fb_eu_energy
union all 
select *, 'Asia' as place from fb_asia_energy
union all 
select *, 'NA' as place from fb_na_energy)

select date, consumption from (select date, sum(consumption) as consumption, dense_rank() over(order by sum(consumption) desc)  as consumption_rank
from cte
group by date) as a
where consumption_rank=1</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">1</span></div><div class="right"><b>BraydenYourhair42</b><br><small>6/26/2021, 8:35 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">python</div></div></div><div class="bottom"><h1>5 line code</h1><ul><li>import pandas as pd</li><li>final_energy= pd.concat(<a href="">fb_eu_energy, fb_asia_energy, fb_na_energy</a>)</li><li>final_energy=final_energy.groupby(<a href="">'date'</a>).sum()<a href="">'consumption'</a>.reset_index()</li><li>max_consumption= final_energy.consumption.max()
final_energy<a href="">final_energy.consumption==max_consumption</a></li></ul><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">1</span></div><div class="right"><b>SonnyDayz3</b><br><small>11/29/2020, 5:16 AM</small></div></div><div class="bottom"><p>shouldn't
 we group by year-month-day (ignore hr-min-sec) here since it's asking 
for the day and not a specific time in a day. I'd extract y-m-d from the
 date column and use a group by function to sum the total consumption 
per day.</p><p>df.groupby(<a href="">'y-m-d'</a>)<a href="">'total_consumption'</a>.sum().reset_index().sort_values('total_consumption', ascending = False)[<a href="">'y-m-d', 'total_consumption'</a>].head(1)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Team@StrataScratch</b><br><small>11/30/2020, 12:12 AM</small></div></div><div class="bottom"><p>I extracted the dt.dayofyear since we want the DOY rather than the year-month-day. I agree with you about the <code>groupby</code> and <code>sum()</code> to get the total consumption per day. Hope that's helpful.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>BobEnweave6</b><br><small>12/6/2020, 6:31 AM</small></div></div><div class="bottom"><p>is the query in PostgreSQL or MySQL</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">1</span></div><div class="right"><b>Team@StrataScratch</b><br><small>12/6/2020, 5:19 PM</small></div></div><div class="bottom"><p>It's in Postgres</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>RustyCarz144</b><br><small>3/21/2022, 1:42 PM</small></div></div><div class="bottom"><p>WITH total as 
(select <em> from fb_eu_energy 
union
select </em> from fb_asia_energy 
union 
select * from fb_na_energy ),
max_rank as(
select Date, Sum(consumption) as total_cons, dense_rank() over(Order by 
Sum(consumption) desc) as ranking from total group by date)
select 
Date,
total_cons
from max_rank
where ranking = 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>cma</b><br><small>3/17/2022, 11:20 AM</small></div></div><div class="bottom"><p>The order by is unnecessary, unless there's something I'm missing.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Buse@StrataScratch</b><br><small>3/17/2022, 11:34 PM</small></div></div><div class="bottom"><p>Hi cma,</p><p>You're correct. Since we are not using any function depends on row number, it is a bit unnecessary here.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>guru786</b><br><small>3/16/2022, 8:32 PM</small></div></div><div class="bottom"><p>What is wrong with this solution?</p><p>select date, asia_consumption + europe_conmuption + na_consumption as total from
(
select fa.date as date,
        Sum(fa.consumption) as asia_consumption, 
        Sum(fe.consumption) as europe_conmuption, 
        Sum(fn.consumption) as na_consumption from fb_asia_energy fa
Left join  fb_eu_energy fe on fa.date=fe.date 
Left join fb_na_energy fn on fn.date=fe.date
group by 1
    )a
    where asia_consumption + europe_conmuption + na_consumption is not null
    order by date desc
    limit 1;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>3/18/2022, 3:42 PM</small></div></div><div class="bottom"><p>Hi guru786,</p><p>If
 you use JOINS for this question you need to be really careful to not 
lose any data. Because you use LEFT JOIN, some rows from the "right" 
tables are lost and not included in the count. You should use FULL JOIN,
 and be careful to replace NULLs with zeroes when summing the 
consumption. That holds for dates also, everything should be wrapped 
with COALESCE.</p><p>WHERE clause is wrong, you should remove it. Also, 
using LIMIT is not the most robust solution, e.g. in case there are 
ties. You could use rank window functions instead or compare all values 
with maximum value. </p><p>Here is a fixed version of your solution:</p><pre><code>SELECT date, asia_consumption + europe_conmuption + na_consumption AS total
FROM
  (SELECT COALESCE(COALESCE(fa.date, fn.date), fe.date) AS date,
          Sum(COALESCE(fa.consumption, 0)) AS asia_consumption,
          Sum(COALESCE(fe.consumption, 0)) AS europe_conmuption,
          Sum(COALESCE(fn.consumption, 0)) AS na_consumption
   FROM fb_asia_energy fa
   FULL OUTER JOIN fb_eu_energy fe ON fa.date=fe.date
   FULL OUTER JOIN fb_na_energy fn ON fn.date=fe.date
   GROUP BY 1)a
ORDER BY date DESC
LIMIT 2</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>WilliePas-D'course155</b><br><small>3/12/2022, 5:06 AM</small></div></div><div class="bottom"><p>select <em> from (
select  date , sum(consumption) as consumption  , 
rank () over (order by sum(consumption) desc) as rnk
from 
(select </em> from fb_eu_energy
union
select <em> from fb_asia_energy
union 
select </em> from fb_na_energy
) x
group by date
) as new 
WHERE RNK =1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Rudra</b><br><small>3/8/2022, 7:17 PM</small></div></div><div class="bottom"><p>select date, total
from
(select date,total, dense_rank() over(order by total desc) as ranking
from
(select distinct(date), sum(consumption) over( partition by t_e.date order by t_e.date) total
from
(select <em> from  fb_eu_energy
    union all
    select </em> from fb_asia_energy
    union all 
    select * from fb_na_energy) t_e) e) e1
where ranking =1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Rudra</b><br><small>3/8/2022, 7:16 PM</small></div></div><div class="bottom"><p>select date, total
from
(select date,total, dense_rank() over(order by total desc) as ranking
from
(select distinct(date), sum(consumption) over( partition by t_e.date order by t_e.date) total
from
(select <em> from  fb_eu_energy
    union all
    select </em> from fb_asia_energy
    union all 
    select * from fb_na_energy) t_e) e) e1
where ranking =1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>IsrealDifficult153</b><br><small>3/7/2022, 8:15 AM</small></div></div><div class="bottom"><p>MySQL solution:</p><p>with t1 as (select <em> from fb_eu_energy
union all
select </em> from fb_asia_energy
union all
select * from fb_na_energy),
t2 as(
select t1.date,sum(t1.consumption) as 'consumption', 
dense_rank() over (order by sum(t1.consumption) desc) as rnk
from t1
group by t1.date)
select t2.date, t2.consumption
from t2 
where t2.rnk=1
group by t2.date
order by t2.date</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Odubey</b><br><small>3/7/2022, 5:52 AM</small></div></div><div class="bottom"><p>with dc_centre as (</p><p>select <em> from fb_eu_energy
union
select </em> from fb_na_energy 
union 
select * from fb_asia_energy)</p><p>select date,tc from</p><p>(select date,sum(consumption) as tc 
, dense_rank() over (order by sum(consumption) desc) rnk
from dc_centre group by 1) b
where b.rnk=1
group by 1
;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>DorisClosed151</b><br><small>3/4/2022, 6:11 PM</small></div></div><div class="bottom"><p>select b.date,max(b.total) as mtotal from
 (select t.date,sum(t.consumption) as total
from ((select date, consumption from fb_eu_energy) union all
      (select date, consumption from fb_asia_energy) union all
      (select date, consumption from fb_na_energy)
     ) t
group by t.date)b
group by b.date order by  b.date desc limit 2;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>DorisClosed151</b><br><small>3/4/2022, 6:10 PM</small></div></div><div class="bottom"><p>select b.date,max(b.total) as mtotal from
 (select t.date,sum(t.consumption) as total
from ((select date, consumption from fb_eu_energy) union all
      (select date, consumption from fb_asia_energy) union all
      (select date, consumption from fb_na_energy)
     ) t
group by t.date)b
group by b.date order by  b.date desc limit 2;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>DorisClosed151</b><br><small>3/4/2022, 6:10 PM</small></div></div><div class="bottom"><p>select b.date,max(b.total) as mtotal from
 (select t.date,sum(t.consumption) as total
from ((select date, consumption from fb_eu_energy) union all
      (select date, consumption from fb_asia_energy) union all
      (select date, consumption from fb_na_energy)
     ) t
group by t.date)b
group by b.date order by  b.date desc limit 2;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>DorisClosed151</b><br><small>3/4/2022, 12:45 PM</small></div></div><div class="bottom"><p>select b.date,max(b.total) as mtotal from
 (select t.date,sum(t.consumption) as total
from ((select date, consumption from fb_eu_energy) union all
      (select date, consumption from fb_asia_energy) union all
      (select date, consumption from fb_na_energy)
     ) t
group by t.date)b
group by b.date order by  b.date desc limit 2;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>SonnyDayz150</b><br><small>3/4/2022, 9:52 AM</small></div></div><div class="bottom"><p>my code..
with list as
( select <em> from fb_eu_energy eu
  Union ALL select </em>
  from fb_asia_energy asia
  Union ALL select *
  from fb_na_energy na
),
total_energy as
(
 select date, sum(consumption) as consumption from list 
 group by date 
 order by date ASC
),</p><p>max_energy as
(
 select  max(consumption) as consumption from total_energy
)</p><p>select te.date, te.consumption 
from total_energy te
join max_energy me
on me.consumption= te.consumption;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>IsrealDifficult147</b><br><small>2/26/2022, 10:32 AM</small></div></div><div class="bottom"><p>How is this approach?</p><pre><code>WITH cte as 
(SELECT COALESCE(eu.date, na.date, asia.date) as date, 
    (COALESCE(eu.consumption, 0) + COALESCE(na.consumption, 0)+
    COALESCE(asia.consumption, 0)) as total_consumption
FROM fb_eu_energy as eu
FULL OUTER JOIN fb_asia_energy as asia on eu.date = asia.date
FULL OUTER JOIN fb_na_energy as na on na.date = asia.date)

SELECT * FROM cte 
WHERE total_consumption = (SELECT MAX(total_consumption) FROM cte)</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>3/3/2022, 1:37 PM</small></div></div><div class="bottom"><p>Hi IsrealDifficult147,</p><p>Great approach! I like you how you managed to solve the question without using UNION. Keep it up!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>ShirleyYoujest143</b><br><small>2/24/2022, 7:10 AM</small></div></div><div class="bottom"><p>select
date,
consumption
from 
(select 
coalesce(eu.date,asia.date,na.date) date ,
sum(coalesce(eu.consumption,0)+coalesce(asia.consumption,0)+coalesce(na.consumption,0)) as consumption,
rank() over (order by sum(coalesce(eu.consumption,0)+coalesce(asia.consumption,0)+coalesce(na.consumption,0)) desc)as r</p><p>from fb_eu_energy eu
full join fb_asia_energy asia
on eu.date=asia.date
full join fb_na_energy na
on eu.date=na.date
group by 1
) 
total where total.r=1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>flashlight</b><br><small>2/23/2022, 3:27 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>My solution
with union_energy as (
    select <em> from fb_eu_energy
    union
    select </em> from fb_asia_energy
    union 
    select * from fb_na_energy
),
max_energy as (
    select date, sum(consumption) as sum_date_max from union_energy 
group by date
)
select date, sum(consumption) as sum_date, (select sum(consumption) from
 union_energy) as sum_energy from union_energy group by date having 
sum(consumption) = (select max(sum_date_max) from max_energy)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Momin.maq</b><br><small>2/18/2022, 7:07 PM</small></div></div><div class="bottom"><p>with cte1 as (
select <em> from fb_eu_energy a
union all 
select </em> from fb_asia_energy b 
union all 
select <em> from fb_na_energy c ),
 cte2 as (
 select date,sum(consumption) total from cte1 group by date),
 cte3 as (
 select date,total,rank() over (order by total desc) ranks from cte2 )
 select </em> from cte3 where ranks=1with cte1 as (
select <em> from fb_eu_energy a
union all 
select </em> from fb_asia_energy b 
union all 
select <em> from fb_na_energy c ),
 cte2 as (
 select date,sum(consumption) total from cte1 group by date),
 cte3 as (
 select date,total,rank() over (order by total desc) ranks from cte2 )
 select </em> from cte3 where ranks=1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>EileenTouda-Left141</b><br><small>2/15/2022, 5:58 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>with t1 as
(select date, consumption from fb_eu_energy
union all
select date, consumption from fb_asia_energy
union all
select date, consumption from fb_na_energy),</p><p>t2 as (select sum(consumption) as total_energy, date from t1
group by date
order by 1 desc)
select date, total_energy from t2 where total_energy = (select max(total_energy) from t2 limit 1)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>rajdeep210</b><br><small>2/13/2022, 4:55 PM</small></div></div><div class="bottom"><p>select 
date,
eu.consumption as europe,
a.consumption as asia,
na.consumption as north,
(eu.consumption + a.consumption + na.consumption) as total 
from fb_eu_energy eu
left join fb_asia_energy a
using(date)
left join fb_na_energy na
using(date)
order by date 
desc
limit 1;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>blliguic</b><br><small>2/7/2022, 8:48 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p><code>with a as (SELECT *
   FROM fb_eu_energy eu
   UNION ALL SELECT *
   FROM fb_asia_energy asia
   UNION ALL SELECT *
   FROM fb_na_energy na)
select date, daily_consumption
from(
select date, sum(consumption) as daily_consumption, rank() over(order by sum(consumption) desc) as rnk
from a
group by date) tmp
where rnk = 1</code></p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>LolaDabridgeda131</b><br><small>2/5/2022, 10:19 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>Can someone shrink this solution?</p><p><code>with consumption_by_date as (
    select distinct
        x.date, sum(consumption) over(partition by date order by date) as sum_dayconsumption
    from ( 
        select * from fb_eu_energy
        union all
            select * from fb_asia_energy
        union all
            select * from fb_na_energy
        order by date
    ) x
    order by sum_dayconsumption desc
)
select date, max(sum_dayconsumption)
from consumption_by_date
where sum_dayconsumption = (
    select 
        max(sum_dayconsumption)
    from consumption_by_date x
)
group by date</code></p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>2/8/2022, 2:24 PM</small></div></div><div class="bottom"><p>Hi LolaDabridgeda131,</p><p>There's no need for this, but also probably no room for maneuver in attempt to shrink this solution.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>RoseAbov-Duresst129</b><br><small>1/28/2022, 7:23 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>-- not the most efficient, any improvement will be appreciated 
WITH finalTable as 
(SELECT <em> FROM fb_eu_energy
UNION ALL
SELECT </em> FROM fb_asia_energy
UNION ALL
SELECT * FROM fb_na_energy
ORDER BY date),
lastTable as 
(SELECT date, SUM(consumption) as Total 
FROM finalTable
GROUP BY date) </p><p>SELECT date, Total
FROM lastTable
ORDER BY Total DESC
LIMIT 2</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>2/5/2022, 9:06 AM</small></div></div><div class="bottom"><p>Hi,</p><p>Only problem with your query is that you hardcode number of rows in the output by using <code>LIMIT 2</code>. What if there's only one date with highest energy consumption? You would need to change your query to using <code>LIMIT 1</code>. And that's not robust. </p><p>You
 can avoid that by either using rank() windows function or you can 
calculate highest energy consumption in the subquery, compare it with 
daily total energy consumptions and output only the ones that match the 
highest one!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>oliv_fslyarf</b><br><small>1/20/2022, 3:45 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>select * from( Select date,cm ,
rank() over( order by cm desc) as rnk 
From 
( Select date,sum(consumption) as cm 
From ( 
Select date , consumption 
From fb_eu_energy 
Union all 
Select date , consumption 
From fb_asia_energy 
Union all 
Select date , consumption 
From fb_na_energy )as consumption 
Group by date ) agg
) rank_cm 
where rnk=1;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>AidenKnowone120</b><br><small>1/15/2022, 12:09 PM</small></div></div><div class="bottom"><p>Very efficient!!</p><p>select distinct(a.user_id) from amazon_transactions a
left join amazon_transactions b on a.user_id =b.user_id
and a.id != b.id
where (a.created_at -b.created_at) between 0 and 7</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>AidenKnowone120</b><br><small>1/15/2022, 11:57 AM</small></div></div><div class="bottom"><p>The easiest way !!</p><p>with cte  as(select date,consumption from fb_eu_energy
union all
select date,consumption from fb_asia_energy<br>union all
select date,consumption from fb_na_energy)
select date, sum(consumption) from cte
group by 1 
order by sum (consumption) desc
limit 2</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>DorisNolongeropen115</b><br><small>1/12/2022, 10:42 PM</small></div></div><div class="bottom"><pre><code>with temp_table as 
(
    select date, sum(consumption) as consumption
    from
    (
        select * from fb_eu_energy
        union
        select * from fb_asia_energy
        union
        select * from fb_na_energy
    ) q
    group by date
)

select date, consumption 
from temp_table
where consumption = (select max(consumption) from temp_table)
;</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>EmreAkanak</b><br><small>12/21/2021, 1:10 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div><div class="badge badge-pill m-l-5 badge-secondary comment-tag">python</div></div></div><div class="bottom"><p>Again as I see there is problem in Python. </p><p>I
 wrote and solved the question with/with SQL query. But neither 
pivot_table() nor groupby() does not outputs properly as it provides in 
Jupyter Notebook and other IDEs...</p><p>Also Python calculation creates different results. </p><p>Related Python code is below: </p><p><code>df.pivot_table(columns='date', aggfunc={'consumption': 'sum'}).T</code></p><p>Related SQL query is below: </p><pre><code>SELECT
    date, totalconsumption

FROM(
SELECT
    *

FROM(
SELECT
    *, RANK() OVER(ORDER BY totalconsumption DESC) AS ranked

FROM(
SELECT
    date, SUM(consumption) AS totalconsumption

FROM(
SELECT
    *

FROM(
SELECT
    *

FROM
    fb_eu_energy
    
UNION ALL 

SELECT
    *

FROM
    fb_asia_energy

UNION ALL

SELECT
    *

FROM
    fb_na_energy
) ds1
) ds2

GROUP BY 
    date

ORDER BY 
    totalconsumption DESC

) ds3
) ds4

WHERE 
    ranked = 1
) ds5;</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>AlKohol104</b><br><small>12/20/2021, 6:23 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">python</div></div></div><div class="bottom"><p>The final output to this problem is wrong and even though I am using the right approach it is not matching the answer.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>12/21/2021, 7:21 PM</small></div></div><div class="bottom"><p>Hi AlKohol104,</p><p>Can you share your approach with us? So we can see what's the problem.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>dwisjp</b><br><small>12/11/2021, 9:00 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>select date,
    total_energy 
    FROM
    (Select date,
        sum(consumption) as total_energy,
    rank() over (order by sum(consumption) desc) as rank_score
    from (select <em> from  fb_eu_energy
            union
        Select </em> from  fb_asia_energy
            union
        Select * from  fb_na_energy) tb1 group by tb1.date) tb2
    where rank_score = 1;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>palashgujrathi</b><br><small>12/3/2021, 9:20 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>with total as (select <em> 
from fb_eu_energy
union 
select </em>
from fb_asia_energy
union 
select *
from fb_na_energy)</p><p>select date, total_energy
from (
select date, sum(consumption) as total_energy, dense_rank() over (order by sum(consumption) desc)
    from total
    group by date) temp
where dense_rank = 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>JamesHizon</b><br><small>12/2/2021, 12:44 AM</small></div></div><div class="bottom"><p>Really
 interesting. A CTE being formed after the prior CTE to obtain 
MAX(total_energy) AS max_energy and a total of 3 CTEs. Then, just query 
from the CTEs using a JOIN to obtain a matching date for the given 
max_energy.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>robptrck</b><br><small>11/25/2021, 5:03 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>Using dense_rank</p><p>select <em>
from
(select
date,
sum(consumption) as consumption,
dense_rank() over(order by sum(consumption) desc) as rnk
from
(select </em>
from fb_eu_energy
union all
select <em> 
from fb_asia_energy
union all
select </em>
from fb_na_energy) a
group by date
order by rnk) b
where rnk = 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>JackO'Lantern92</b><br><small>11/12/2021, 5:24 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>WITH
total_energy AS
  (SELECT <em>
   FROM fb_eu_energy eu
   UNION ALL SELECT </em>
   FROM fb_asia_energy asia
   UNION ALL SELECT *
   FROM fb_na_energy na),
energy_by_date AS
  (SELECT date, sum(consumption) AS total_energy
   FROM total_energy
   GROUP BY date
   ORDER BY date ASC)
select edb.date, edb.total_energy from energy_by_date edb
where edb.total_energy = (SELECT max(total_energy) AS max_energy FROM energy_by_date)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>pipeline19</b><br><small>11/7/2021, 5:51 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">python</div></div></div><div class="bottom"><p>import pandas as pd</p><p>total_energy=
 fb_eu_energy.merge(fb_asia_energy, how="outer",on = "date", suffixes= 
("_eu","_asia")).merge(fb_na_energy,how="outer", 
on="date",suffixes=("_eu","_na")).fillna(0)</p><p>total_energy<a href="">"total_energy"</a> = total_energy<a href="">"consumption_eu"</a> + total_energy<a href="">"consumption_asia"</a> + total_energy<a href="">"consumption"</a></p><p>total_energy[total_energy<a href="">"total_energy"</a> == total_energy<a href="">"total_energy"</a>.max()][<a href="">"date","total_energy"</a>]</p><p>can u tell my how my logic was pls :3 thanks</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>11/12/2021, 3:57 PM</small></div></div><div class="bottom"><p>Hi pipeline19,</p><p>Your
 logic is pretty good. I would just change the hardcoded selection of 
the datest with a maximum total energy. Here is something more robust:</p><pre><code>import pandas as pd 
total_energy= fb_eu_energy.merge(fb_asia_energy, how="outer",on = "date", suffixes= ("_eu","_asia")).merge(fb_na_energy,how="outer", on="date",suffixes=("_eu","_na")).fillna(0) 
total_energy["total_energy"] = total_energy["consumption_eu"] + total_energy["consumption_asia"] + total_energy["consumption"] 
max_total_energy = total_energy.groupby("date")["total_energy"].max().reset_index()
max_total_energy['rnk'] = max_total_energy['total_energy'].rank(method= 'dense', ascending=False)
result = max_total_energy[max_total_energy.rnk == 1][['date', 'total_energy']]</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>varlok</b><br><small>10/8/2021, 12:13 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>My solution, </p><p>'''select date, total_energy_c
from
(select date, sum(consumption) as total_energy_c,
rank() over(order by sum(consumption) desc)
from fb_dc
group by 1) fb_dc_1
where rank=1'''</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>bprasad26</b><br><small>10/7/2021, 7:35 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">python</div></div></div><div class="bottom"><pre><code>fb_eu_energy.head()
df = pd.concat([fb_eu_energy, fb_asia_energy, fb_na_energy])
df2 = df.groupby("date")['consumption'].sum().reset_index()
max_consumption = df2['consumption'].max()
df2[df2['consumption']==max_consumption]</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>BetteAlott69</b><br><small>10/1/2021, 4:49 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>with B as (
select date, sum(consumption) as total_energy
from
    (
    select <em> 
    from fb_eu_energy a
    union all
    select </em> 
    from fb_asia_energy b
    union all
    select *
    from fb_na_energy c
    ) as A
group by date 
) </p><p>select *
from B 
where total_energy = (select max(B.total_energy) from B)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>vijayroy28</b><br><small>9/30/2021, 3:40 PM</small></div></div><div class="bottom"><p>Hello Sir,
Pleas tell how is this solution  (I was able to got the ans right in second attempt  :( )</p><p>With cte as
(Select distinct date,sum(consumption)Over(Partition by date) as sm from
(select <em> from fb_eu_energy
UNION 
Select </em> from fb_asia_energy
UNION
Select <em> from fb_na_energy) x
Order by sm desc)
select </em> from cte where sm in (Select max(sm) from cte)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Matt@StrataScratch</b><br><small>10/2/2021, 5:03 PM</small></div></div><div class="bottom"><p>Hi vijayroy28,</p><p>thank you for sharing your solution! It's a correct approach and it generates the expected output!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>HoldenStrong66</b><br><small>9/13/2021, 10:14 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">python</div></div></div><div class="bottom"><h1>Import your libraries</h1><p>import pandas as pd
import datetime</p><h1>Start writing code</h1><h1>Creating a new variable and assigning each columns into it for all the three data frames.</h1><p>a = fb_eu_energy[<a href="">"date","consumption"</a>]
b = fb_asia_energy[<a href="">"date","consumption"</a>]
c = fb_na_energy[<a href="">"date","consumption"</a>]</p><h1>Now I have 
to merge all the rows into one like we did in SQL by using Union, but 
her i'll use concat since we don't use union here.</h1><p>abc = pd.concat(<a href="">a,b,c</a>)</p><h1>Now I have to group by date and sum of corresponding consumption to get the total energy consumption.</h1><p>new = abc.groupby("date")<a href="">"consumption"</a>.sum().reset_index()</p><h1>Now we have got summation of consumption wrt date, now we will use Dense_rank function here to get the highest record here.</h1><p>new<a href="">'Rank'</a> = new.consumption.rank(method = 'dense',ascending = False).astype(int)
output = new[new<a href="">"Rank"</a> == 1][<a href="">"date","consumption"</a>]
output</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>HoldenStrong66</b><br><small>9/13/2021, 9:35 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>With cte as 
    (
    select a.<em>
    from fb_eu_energy a
    union all
    select b.</em>
    from fb_asia_energy b
    union all
    select c.<em>
    from fb_na_energy c
    ),
    cte1 as 
        (
        select date,sum
        from
            (
            select date,sum,dense_rank()over(order by sum desc) total_energy
            from 
            (
            select date,sum(consumption)
            from cte
            group by 1
            ) a
            ) b
            where total_energy = 1
            ) 
            select </em>
            from cte1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>iram</b><br><small>9/9/2021, 1:06 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><pre><code>With datacenters as(
   select date, sum(consumption) as total_energy from (
    select date, consumption from fb_eu_energy
    union all
    select date, consumption from fb_asia_energy
    union all
    select date, consumption from fb_na_energy) sub
    group by date
)
select Date ,total_energy from (
select  date as Date,total_energy, rank() over ( order by total_energy desc) as rankofc from datacenters ) sub
where rankofc = 1</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Bhuvnesh10</b><br><small>9/6/2021, 8:22 PM</small></div></div><div class="bottom"><p>select
 final_date, tot from 
(select COALESCE(e_date, a_date, na_date) as final_date, rank() over ( 
order by  COALESCE(e_consumption,0) + COALESCE(a_consumption, 0) + 
COALESCE(na_consumption,0) desc) max_tot,
COALESCE(e_consumption,0) + COALESCE(a_consumption, 0) + 
COALESCE(na_consumption,0) as tot
from
((select date as e_date, consumption as e_consumption from fb_eu_energy)
 e
full outer join
(select date as a_date, consumption as a_consumption from 
fb_asia_energy) a
on e_date = a_date
full outer join
(select date as na_date, consumption as na_consumption from 
fb_na_energy) na 
on a_date = na_date) abc) xyz
where max_tot = 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>ValIdation66</b><br><small>8/29/2021, 8:20 PM</small></div></div><div class="bottom"><p>WITH total_ranking AS(
SELECT a.date, SUM(a.consumption) total_energy
FROM(
    SELECT <em>
    FROM fb_eu_energy asia
    UNION SELECT </em> 
    FROM fb_asia_energy eu
    UNION SELECT * 
    FROM fb_na_energy na
) a
GROUP BY a.date
)</p><p>SELECT *
FROM total_ranking
WHERE total_energy = 
(
SELECT MAX(total_energy)
FROM total_ranking
)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>woyaodangds112</b><br><small>8/21/2021, 12:54 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>I really like this linear approach of building tables one by one, each depending on the previous table.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>8/21/2021, 10:47 AM</small></div></div><div class="bottom"><p>Hi woyaodangds112,</p><p>We agree with you, it's pretty easy to follow and understand the logic behind the solution!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>nima.ahmadi</b><br><small>8/19/2021, 8:41 PM</small></div></div><div class="bottom"><p>with p as (select <em>,rank() over(order by sumo desc) from (select date,sum(consumption) as sumo  from (select </em> from  fb_eu_energy
        union
        select <em> from fb_asia_energy
        union 
        select </em> from fb_na_energy) as r
group by date) as w)
select date,sumo as conumption from p
where rank =1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>8/20/2021, 9:25 AM</small></div></div><div class="bottom"><p>Hi SalLadd59,</p><p>Great solution, thank you for sharing it with us!</p><p>Formatting deleted the <code>*</code> signs so I'm posting your solution with fixed formatting:</p><pre><code>with p as (select * ,rank() over(order by sumo desc) from (select date,sum(consumption) as sumo from (select * from fb_eu_energy union select * from fb_asia_energy union select  * from fb_na_energy) as r group by date) as w) select date,sumo as conumption from p where rank =1</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>ErinDetyers60</b><br><small>8/17/2021, 3:16 PM</small></div></div><div class="bottom"><p>with cte1 as
(select tot.date,sum(consumption) tot_con
from(
select <em> from fb_eu_energy
union all
select </em> from fb_asia_energy
union all
select <em> from fb_na_energy) tot
group by tot.date
order by tot_con desc)
select </em> from cte1 
where tot_con=(select max(tot_con) from cte1)
;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>8/17/2021, 4:00 PM</small></div></div><div class="bottom"><p>Hi ErinDetyers60,</p><p>Great solution, thanks for sharing it with us! Formatting deleted the <code>*</code> signs so I'm posting your solution with that fixed:</p><pre><code>with cte1 as (select tot.date,sum(consumption) tot_con from( select * from fb_eu_energy union all select * from fb_asia_energy union all select * from fb_na_energy) tot group by tot.date order by tot_con desc) 

select * from cte1 where tot_con=(select max(tot_con) from cte1) ;</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>HankErchief60</b><br><small>8/10/2021, 6:39 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>with intem as (
select distinct(x.date),
sum(x.consumption) over(partition by x.date) as total
from
(select <em> from fb_eu_energy
union
select </em> from fb_asia_energy
union
select * from fb_na_energy) x
)
select date from intem i1
where i1.total = (select max(i2.total) from intem i2)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>mani78</b><br><small>7/29/2021, 5:25 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>with cte as(</p><p>select 'EU' as datacenter, date, consumption from fb_eu_energy
union all
select 'ASIA', date, consumption from fb_asia_energy
union all
select 'NA', date, consumption from fb_na_energy</p><p>)
select date, total_energy from (
select date, Sum(consumption) as total_energy,
rank()over(order by Sum(consumption) desc) rnk
from cte
group by date
)t
where t.rnk=1
;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>WillowWisp43</b><br><small>7/2/2021, 11:52 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>select date, sum(consumption)
from (SELECT <em>
   FROM fb_eu_energy eu
   UNION ALL SELECT </em>
   FROM fb_asia_energy asia
   UNION ALL SELECT *
   FROM fb_na_energy na) as t</p><p>group by date
order by sum desc
limit 2</p><p>Is this correct? I am a noob. I dont even understand what you are tying to do in the main solution. Why is that so complicated?</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Kat@StrataScratch</b><br><small>7/3/2021, 9:05 AM</small></div></div><div class="bottom"><p>Hi WillowWisp43,</p><p>thank you for sharing your approach and sharing your questions, we are all noobs somehow ;)</p><p>Here are couple of notes on your solution:</p><ul><li><p>in
 our main solution we are avoiding the use of limit, because, in 
real-life scenarios, you won't be knowing how many rows to output, you 
want a robust code to produce the correct output regardless of the 
dataset.</p></li><li><p>hardcoding <code>limit 2</code> into the solution doesn't really mean that the first two rows are for <code>highest total energy consumption</code> .. one could be less, that's the reason for creating the 3rd cte <code>max_energy</code></p></li><li><p>but how can you get to the <code>max</code> of energy consumption without having <code>sum</code>
 first? we could have cobmined first 2 ctes together or combined the 2nd
 &amp; 3rd, however, this would have made the ctes more complex, and a 
bit unreadable for some, or in the later case, would have produced 
redundant data.</p></li></ul><p>to conclude, avoid using limits, avoid 
hardcoding critical and dynamic values, use CTEs for creating readable, 
clean &amp; re-usable chunks of codes.</p><p>please let us know if you still have doubts about this one :)</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>DustinDeWinned45</b><br><small>7/2/2021, 12:53 PM</small></div></div><div class="bottom"><p>select distinct x.date,max(x.consumption) as cons
from (
select eu.date,sum(eu.consumption+asia.consumption+na.consumption) as consumption from fb_eu_energy eu
inner join fb_asia_energy asia
on eu.date = asia.date 
inner join fb_na_energy na 
on na.date = asia.date
group by eu.date
)x
group by x.date
order by cons desc 
limit 2</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>DavsJob24</b><br><small>6/30/2021, 8:10 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>I used this to aproach the result</p><p>select  total.date,sum(consumption) as total_energy
from
(select date,consumption
from fb_eu_energy
union
select date,consumption
from fb_asia_energy
union
select date,consumption
from fb_na_energy) as total
group by total.date
order by total_energy desc
limit 2</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>7/2/2021, 11:58 AM</small></div></div><div class="bottom"><p>Hi
 DavsJob24,
Your solution is a correct one, but it is not the most robust one! If 
there is only one month with max total energy your solution will not 
work. Try to make a solution that will work for any case!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>MacArronne44</b><br><small>6/28/2021, 10:50 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p><a href="">SOLUTION USING COALESCE and CTEs</a></p><p>WITH all_consumption AS(
SELECT date, 
     COALESCE(fb1.consumption, 0) AS eu_consumption, 
     COALESCE(fb2.consumption, 0) AS asia_consumption,
     COALESCE(fb3.consumption, 0) AS na_consumption
FROM fb_eu_energy fb1
FULL JOIN fb_asia_energy fb2
USING(date)
FULL JOIN fb_na_energy fb3
USING(date)
),</p><p>total_energyTable AS(
SELECT date,
    eu_consumption,
    asia_consumption,
    na_consumption,
    (eu_consumption+asia_consumption+na_consumption) AS total_energy
FROM all_consumption
ORDER BY total_energy DESC
),</p><p>ranking AS(
SELECT date,
    total_energy,
    DENSE_RANK() OVER(ORDER BY total_energy DESC) AS consum_ranking
FROM total_energyTable
)</p><p>SELECT date, total_energy
FROM ranking
WHERE consum_ranking = 1;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Ron9654</b><br><small>6/25/2021, 11:40 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>With 
cte1 as
(select date, max(consumption) from fb_eu_energy group by date
UNION
select date, max(consumption)from fb_asia_energy group by date
UNION
select date, max(consumption) from fb_na_energy group by date),
cte2 as 
(select date, sum(max) as total_energy from cte1 group by date),
cte3 as
(select date,total_energy, dense_rank() over (order by total_energy desc) as ranking from cte2)
select date, total_energy from cte3 where ranking = 1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>6/27/2021, 12:09 PM</small></div></div><div class="bottom"><p>Thanks for sharing your solution!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>subra1p</b><br><small>6/21/2021, 9:47 AM</small></div></div><div class="bottom"><p>CTE approach :: </p><p>with fb_dc_energy as
( 
select a.date, sum(a.consumption) as total_con,rank() over(order by sum(a.consumption) desc) as rk 
from
(SELECT date, consumption FROM fb_eu_energy
UNION ALL
SELECT date, consumption FROM fb_asia_energy
UNION ALL
SELECT date, consumption FROM fb_na_energy)a
group by a.date 
)
select date, total_con from fb_dc_energy
where rk = 1;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>6/23/2021, 11:31 AM</small></div></div><div class="bottom"><p>Great approach! Thanks for sharing your solution with us.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>MacArronne40</b><br><small>6/20/2021, 7:28 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>SELECT date, total_energy
FROM (
    SELECT 
        date, 
        SUM(consumption) AS total_energy, 
        DENSE_RANK() OVER (ORDER BY SUM(consumption) DESC)
    FROM (
        SELECT <em> FROM fb_eu_energy
        UNION
        SELECT </em> FROM fb_asia_energy
        UNION 
        SELECT * FROM fb_na_energy
    ) as tmp
    GROUP BY 1
) AS tmp
WHERE dense_rank = 1;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>6/21/2021, 12:34 PM</small></div></div><div class="bottom"><p>Hi, your solution is correct, thanks for sharing.</p><p>Because of formating your <code>*</code> got deleted so I'm posting your solution with that fixed:</p><pre><code>SELECT date, total_energy FROM ( SELECT date, SUM(consumption) AS total_energy, DENSE_RANK() OVER (ORDER BY SUM(consumption) DESC) FROM ( SELECT * FROM fb_eu_energy UNION SELECT * FROM fb_asia_energy UNION SELECT * FROM fb_na_energy ) as tmp GROUP BY 1 ) AS tmp WHERE dense_rank = 1;</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>LeivMeehom35</b><br><small>6/18/2021, 12:03 AM</small></div></div><div class="bottom"><p>Below
 query ranks every row as 1 because of the 'partition by date' part. 
Without partition by date it gives me the right answer. I wonder why 
partition by is not grouping by the date then rank the sum across all 
dates like I expected? What is the general difference between group by 
and partition by?</p><p>SELECT date, total_energy FROM
(SELECT date, SUM(consumption) AS total_energy, RANK() OVER (partition by date ORDER BY SUM(consumption) DESC) AS r 
FROM
(SELECT <em> FROM fb_eu_energy
UNION ALL
SELECT </em> FROM fb_asia_energy
UNION ALL
SELECT * FROM fb_na_energy) fb_energy
GROUP BY date) fb_energy_ranked
WHERE r = 1
;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>6/20/2021, 7:33 AM</small></div></div><div class="bottom"><p>Hi LeivMeehom35,</p><p>Partition by is different than group by. </p><p>Group by collapses the dataset defined groups and calculates one selected aggregated measure for each group. </p><p>Partition
 by is used for window functions and aggregations for each row with 
taking into account selected numbers of the row before and after. With 
partition by you calculate an aggregated measure for each row. For 
instance, you could use it to calculate accumulations! </p><p>Their purpose is different, I hope we helped you!</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>AbbyKuss35</b><br><small>6/14/2021, 3:16 PM</small></div></div><div class="bottom"><p>Can you please advise why my solution doesn't work?
WITH total as(
    SELECT date, consumption
    FROM fb_eu_energy
    UNION ALL
    SELECT date, consumption
    FROM fb_asia_energy
    UNION ALL
    SELECT date, consumption
    FROM fb_na_energy)
SELECT date, total_energy 
FROM (
    SELECT date, sum(consumption) as total_energy, RANK() over(ORDER BY total_energy DESC) rnk
    FROM total
    WHERE rnk = 1
    GROUP BY date) a</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Marin@StrataScratch</b><br><small>6/16/2021, 12:17 PM</small></div></div><div class="bottom"><p>Hi AbbyKuss35,</p><p>You
 can't order by window function by aggregated value (total_energy) in 
the same query you calculate it. Also, you can't filter on window 
function value in the same query you calculate it. When we change this 
to:</p><pre><code>WITH total as( SELECT date, consumption FROM fb_eu_energy UNION ALL SELECT date, consumption FROM fb_asia_energy UNION ALL SELECT date, consumption FROM fb_na_energy) 

SELECT date, total_energy FROM
(SELECT date, total_energy, RANK() over(ORDER BY total_energy DESC) as rnk FROM ( SELECT date, sum(consumption) as total_energy FROM total GROUP BY date) a1) a2 WHERE rnk=1</code></pre><p>your solution is correct. Your logic and approach were correct, just be careful about these SQL nuisances.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Mohit24</b><br><small>6/10/2021, 1:13 PM</small></div></div><div class="bottom"><p>with cte as
(select date ,sum(consumption)as total_energy from (
select date,consumption from fb_eu_energy
union all
select date,consumption from fb_asia_energy
union all
select date,consumption from fb_na_energy) as t1
group by date
order by total_energy desc)</p><p>select * from cte where total_energy = (select max(total_energy) from cte);</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>gaurrithik</b><br><small>5/19/2021, 1:22 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>Any Suggestions on this query , same answer but using full outer join and coalesce , simple and short query
SELECT DAY, TOTAL
FROM
(SELECT COALESCE(E.DATE,A.DATE,N.DATE) AS DAY ,
COALESCE(E.CONSUMPTION,0)+COALESCE(A.CONSUMPTION,0)+COALESCE(N.CONSUMPTION,0) AS TOTAL
, DENSE_RANK() OVER (ORDER BY COALESCE(E.CONSUMPTION,0)+COALESCE(A.CONSUMPTION,0)+COALESCE(N.CONSUMPTION,0) DESC) AS RA
FROM fb_eu_energy E
FULL OUTER JOIN fb_asia_energy A
ON E.DATE = A.DATE
FULL OUTER JOIN fb_na_energy N
ON COALESCE(E.DATE,A.DATE) = N.DATE )T
WHERE RA=1</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Saajan</b><br><small>5/11/2021, 10:29 AM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>can anyone explain why my code is not working when I'm using where clause to filter data instead of join in above solution </p><pre><code>WITH all_energy as (select * from fb_eu_energy eu
                                         union all 
                                         select * from fb_asia_energy asia
                                         union all 
                                         select * from fb_na_energy  other),
day_energy as (select date , sum(consumption) as total_energy
                from all_energy 
                group by date),
max_energy as (select max(total_energy) as me from day_energy)    
select *
from day_energy de
where de.total_energy = max_energy.me;</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>geotactic</b><br><small>5/12/2021, 6:10 AM</small></div></div><div class="bottom"><p>@saajan Hey Saajan, you have to add max energy in the last select query.</p><p>WITH all_energy as (select <em> from fb_eu_energy eu
                                         union all 
                                         select </em> from fb_asia_energy asia
                                         union all 
                                         select * from fb_na_energy  other),
day_energy as (select date , sum(consumption) as total_energy
                from all_energy 
                group by date),
max_energy as (select max(total_energy) as me from day_energy)<br>select date,de.total_energy
from day_energy de,max_energy
where de.total_energy = max_energy.me;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Kat@StrataScratch</b><br><small>5/12/2021, 4:16 PM</small></div></div><div class="bottom"><p>Hello Saajan,</p><p>because your query doesn't actually see the table you have created (max_energy)
simply change your query at the end to this &amp; it will work :)
SELECT de.*
FROM day_energy de, max_energy
WHERE de.total_energy = max_energy.me;</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>JoeyTribbbiani</b><br><small>4/24/2021, 1:19 PM</small><div class="badge badge-pill m-l-5 badge-secondary comment-tag">SQL</div></div></div><div class="bottom"><p>select date, sum(consumption) as total
from 
 (
    select <em>
    from fb_eu_energy eu
    union
    select </em>
    from fb_asia_energy asia
    union
    select *
    from fb_na_energy na
    ) t
group by date
order by total Desc
limit 2</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>frederikmuller</b><br><small>5/7/2021, 10:40 AM</small></div></div><div class="bottom"><p>you can't know that there's going to be 2 dates with the maximum total energy consumption, LIMIT 2 won't work for other cases</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>RobinEue19</b><br><small>4/5/2021, 4:52 PM</small></div></div><div class="bottom"><p>can someone tell me why it doesn't work?</p><p>'''</p><h1></h1><p>df = fb_eu_energy.merge(fb_asia_energy,on = 'date',how = 'outer')
df = df.merge(fb_na_energy,on = 'date',how = 'outer')
df<a href="">'all_consumption'</a> = df[<a href="">'consumption_x','consumption_y','consumption'</a>].sum(axis = 1)</p><p>df[df<a href="">'all_consumption'</a>==max(df<a href="">'all_consumption'</a>)][<a href="">'date','all_consumption'</a>].sort_values('date')'''</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Kasia@StrataScratch</b><br><small>4/7/2021, 2:55 PM</small></div></div><div class="bottom"><p>Your
 solution is correct, however there are minor format differences between
 your solution and proposed solution- that's why the checker points it 
varies from the original output.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>ArseniyTyurin</b><br><small>3/14/2021, 4:37 AM</small></div></div><div class="bottom"><p>Got stuck with the solution because I didn't think to put the aggregation function directly in cte over unions.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>RipItupp5</b><br><small>1/21/2021, 6:41 AM</small></div></div><div class="bottom"><p>import pandas as pd
import numpy as np</p><p>df = pd.merge(fb_eu_energy, fb_asia_energy, how='outer', left_on = 'date', right_on = 'date')
df2 = pd.merge(df, fb_na_energy, how='outer', left_on = 'date', right_on = 'date')
df2 = df2.replace(np.nan, 0)
df2<a href="">'total'</a> = df2<a href="">'consumption_x'</a> + df2<a href="">'consumption_y'</a> + df2<a href="">'consumption'</a>
df3 = df2[<a href="">'date', 'total'</a>].sort_values('total', ascending=False)
df3.head(1)</p><p>df2 = df2.replace(np.nan, 0) can't replace an to 0</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>Team@StrataScratch</b><br><small>1/27/2021, 12:04 AM</small></div></div><div class="bottom"><p>Try using <code>df2.fillna(0)</code></p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div><div class="comment-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">0</span></div><div class="right"><b>SalLadd4</b><br><small>12/12/2020, 3:58 AM</small></div></div><div class="bottom"><p>I don't understand why this is not working</p><pre><code># Import your libraries
import pandas as pd
import numpy as np

# Start writing code
df = pd.concat([fb_eu_energy,fb_asia_energy,fb_na_energy])
consumption = df.groupby("date", as_index=False).sum()
consumption["dayofyear"] = pd.to_datetime(consumption['date']).dt.dayofyear
consumption[consumption["consumption"]==consumption["consumption"].max()][["dayofyear","consumption"]]</code></pre><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div><div class="replies-container"><div class="comment"><div class="top"><div class="left"><button type="button" class="upvote-link btn-link-borderless bg-none"><i class="fa fa-arrow-up"></i></button><br><span class="upvotes-number">1</span></div><div class="right"><b>Team@StrataScratch</b><br><small>12/12/2020, 3:56 PM</small></div></div><div class="bottom"><p>The
 approach to your solution is correct but instead of outputting the day 
of the year, just output the date and that should fix it.</p><div class="actions" style="display: flex; flex-direction: row; align-items: start;"><button type="button" class="btn-link-borderless bg-none" style="margin-right: 20px;"><i class="fa fa-reply"></i> Reply</button></div></div></div></div></div></div></div></div></div><div id="question-details-tabs-tabpane-submissions" aria-labelledby="question-details-tabs-tab-submissions" role="tabpanel" aria-hidden="true" class="fade tab-pane"><div style="max-height: 1045px;"><div class="row"><div style="height: 100%;" class="col-12"><div style="margin: 1.5rem;"><h5 style="font-size: 16px;"><span style="font-weight: 600;">Total Number of Attempts:</span> <span style="padding-left: 5px;">0</span></h5><h5 style="font-size: 16px;"><span style="font-weight: 600;">Success Rate:</span> <span style="padding-left: 5px;">0.00%</span></h5></div><div class="submissions"><div class="full-height"><div class="dtContainer dataTables_wrapper full-height"><table id="dt" class="table display dataTable no-footer full-height"><thead><tr class="dataTableHiddenHeaders"><th role="columnheader" scope="col">Date<br></th><th role="columnheader" scope="col">Status<br></th><th role="columnheader" scope="col">Language<br></th><th role="columnheader" scope="col">Solution<br></th></tr></thead><tbody><tr class="text-center"><td>No solutions found.</td></tr></tbody></table><div class="dataTables_length" id="dt_length">Show <div style="display: inline-block; width: 80px;"><div class="popular-modules css-b62m3t-container"><span id="react-select-39-live-region" class="css-7pg0cj-a11yText"></span><span aria-live="polite" aria-atomic="false" aria-relevant="additions text" class="css-7pg0cj-a11yText"></span><div class=" css-1s2u09g-control"><div class=" css-1d8n9bt"><div class=" css-qc6sy-singleValue">10</div><div class=" css-ackcql" data-value=""><input class="" style="color: inherit; background: rgba(0, 0, 0, 0) none repeat scroll 0px center; opacity: 1; width: 100%; grid-area: 1 / 2; font: inherit; min-width: 2px; border: 0px none; margin: 0px; outline: currentcolor none 0px; padding: 0px;" autocapitalize="none" autocomplete="off" autocorrect="off" id="react-select-39-input" spellcheck="false" tabindex="0" type="text" aria-autocomplete="list" aria-expanded="false" aria-haspopup="true" aria-controls="react-select-39-listbox" aria-owns="react-select-39-listbox" role="combobox"></div></div><div class=" css-1wy0on6"><span class=" css-1okebmr-indicatorSeparator"></span><div class=" css-tlfecz-indicatorContainer" aria-hidden="true"><svg height="20" width="20" viewBox="0 0 20 20" aria-hidden="true" focusable="false" class="css-8mmkcg"><path d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"></path></svg></div></div></div><input name="pageSize" type="hidden" value="10"></div></div> entries</div></div></div></div></div></div></div></div><div id="question-details-tabs-tabpane-solutions" aria-labelledby="question-details-tabs-tab-solutions" role="tabpanel" aria-hidden="true" class="fade tab-pane"><div style="max-height: 1045px;"><div class="row justify-content-end m-0"><div style="margin-right: 5px;" class="sort-dropdown dropdown"><button type="button" style="border: 0px none; background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%;"><span style="margin-right: 5px;">Sort By</span><i class="fa fa-sort-amount-desc" aria-hidden="true"></i></button></div></div><div><div><div><div class="user-solution-upvote"><span class="upvotes-number" style="margin-right: 5px;">14</span><button type="button" class="upvote-link" style="background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%; border: 0px none; color: rgb(0, 166, 153);"><i class="fa fa-arrow-up"></i></button></div><b>MacDonalds88 on 28/12/2021</b></div><div class="m-t-5 m-r-5"><div class="strata-editor-container"><div id="ace-editor" style="width: 100%; height: 615px; font-size: 0.8125rem;" class=" ace_editor ace-github"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; font-size: 1px; top: 380px; left: 534px; height: 1px; width: 1px;" readonly="readonly" wrap="off"></textarea><div class="ace_gutter" aria-hidden="true" style="left: 0px; width: 47px;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1000000px; top: 0px; left: 0px; width: 47px;"><div class="ace_gutter-cell " style="height: 19px; top: 0px;">1<span class="ace_fold-widget ace_start ace_open" style="height: 19px; display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 19px;">2<span style="display: inline-block; height: 19px;" class="ace_fold-widget ace_start ace_open"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 38px;">3<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 57px;">4<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 76px;">5<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 95px;">6<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 114px;">7<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 133px;">8<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 152px;">9<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 171px;">10<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 190px;">11<span class="ace_fold-widget ace_start ace_open" style="height: 19px; display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 209px;">12<span style="display: inline-block; height: 19px;" class="ace_fold-widget ace_start ace_open"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 228px;">13<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 247px;">14<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 266px;">15<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 285px;">16<span class="ace_fold-widget ace_start ace_open" style="height: 19px; display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 304px;">17<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 323px;">18<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 342px;">19<span style="display: none;"></span></div><div class="ace_gutter-cell ace_gutter-active-line " style="height: 19px; top: 361px;">20<span style="display: none;"></span></div></div></div><div class="ace_scroller" style="line-height: 19px; left: 47px; right: 0px; bottom: 0px;"><div class="ace_content" style="top: 0px; left: 0px; width: 750px; height: 653px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 564px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div style="height: 19px; top: 361px; left: 0px; right: 0px;" class="ace_active-line"></div><div style="height: 19px; width: 7px; top: 361px; left: 480px;" class="ace_bracket ace_start ace_br15"></div><div style="height: 19px; width: 7px; top: 361px; left: 186px;" class="ace_bracket ace_start ace_br15"></div></div><div class="ace_layer ace_text-layer" style="height: 1000000px; margin: 0px 4px; top: 0px; left: 0px;"><div style="height: 19px; top: 0px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_identifier">WITH</span></div></div><div style="height: 19px; top: 19px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_identifier">unioned</span> <span class="ace_keyword">AS</span> <span class="ace_paren ace_lparen">(</span></div></div><div style="height: 19px; top: 38px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">SELECT</span> *</div></div><div style="height: 19px; top: 57px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">FROM</span> <span class="ace_identifier">fb_eu_energy</span></div></div><div style="height: 19px; top: 76px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">UNION</span></div></div><div style="height: 19px; top: 95px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">SELECT</span> *</div></div><div style="height: 19px; top: 114px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">FROM</span> <span class="ace_identifier">fb_asia_energy</span></div></div><div style="height: 19px; top: 133px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">UNION</span></div></div><div style="height: 19px; top: 152px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">SELECT</span> *</div></div><div style="height: 19px; top: 171px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">FROM</span> <span class="ace_identifier">fb_na_energy</span><span class="ace_paren ace_rparen">)</span>,</div></div><div style="height: 19px; top: 190px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"></div></div><div style="height: 19px; top: 209px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_identifier">totals</span> <span class="ace_keyword">AS</span> <span class="ace_paren ace_lparen">(</span></div></div><div style="height: 19px; top: 228px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">SELECT</span> <span class="ace_storage ace_type">date</span>, <span class="ace_support ace_function">SUM</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">consumption</span><span class="ace_paren ace_rparen">)</span> <span class="ace_identifier">total_consumption</span></div></div><div style="height: 19px; top: 247px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">FROM</span> <span class="ace_identifier">unioned</span></div></div><div style="height: 19px; top: 266px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">GROUP</span> <span class="ace_keyword">BY</span> <span class="ace_storage ace_type">date</span></div></div><div style="height: 19px; top: 285px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">ORDER</span> <span class="ace_keyword">BY</span> <span class="ace_identifier">total_consumption</span> <span class="ace_keyword">DESC</span><span class="ace_paren ace_rparen">)</span></div></div><div style="height: 19px; top: 304px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    </div></div><div style="height: 19px; top: 323px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">SELECT</span> *</div></div><div style="height: 19px; top: 342px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">FROM</span> <span class="ace_identifier">totals</span></div></div><div style="height: 19px; top: 361px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">WHERE</span> <span class="ace_identifier">total_consumption</span> <span class="ace_keyword ace_operator">=</span> <span class="ace_paren ace_lparen">(</span><span class="ace_keyword">SELECT</span> <span class="ace_support ace_function">MAX</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">total_consumption</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">FROM</span> <span class="ace_identifier">totals</span><span class="ace_paren ace_rparen">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="display: block; top: 361px; left: 487px; width: 7px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px; display: none;"><div class="ace_scrollbar-inner" style="width: 22px; height: 380px;">&nbsp;</div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 47px; right: 0px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 780px;">&nbsp;</div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה</div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div class="strata-editor-extension strata-editor-dragbar" role="separator"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg></div></div></div></div><div><div><div class="user-solution-upvote"><span class="upvotes-number" style="margin-right: 5px;">5</span><button type="button" class="upvote-link" style="background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%; border: 0px none; color: rgb(0, 166, 153);"><i class="fa fa-arrow-up"></i></button></div><b>NickOfthyme105 on 7/1/2022</b></div><div class="m-t-5 m-r-5"><div class="strata-editor-container"><div id="ace-editor" style="width: 100%; height: 200px; font-size: 0.8125rem;" class=" ace_editor ace-github"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; font-size: 1px; top: 0px; left: 0px; height: 1px; width: 1px;" readonly="readonly" wrap="off"></textarea><div class="ace_gutter" aria-hidden="true" style="left: 0px; width: 47px;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1000000px; top: 0px; left: 0px; width: 47px;"><div class="ace_gutter-cell " style="height: 19px; top: 0px;">1<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 19px;">2<span class="ace_fold-widget ace_start ace_open" style="height: 19px; display: inline-block;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 38px;">3<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 57px;">4<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 76px;">5<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 95px;">6<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 114px;">7<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 133px;">8<span class="ace_fold-widget ace_start ace_open" style="height: 19px; display: inline-block;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 152px;">9<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 171px;">10<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 190px;">11<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 209px;">12<span style="display: none;"></span></div></div></div><div class="ace_scroller" style="line-height: 19px; left: 47px; right: 17px; bottom: 0px;"><div class="ace_content" style="top: 0px; left: 0px; width: 733px; height: 238px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 564px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="height: 1000000px; margin: 0px 4px; top: 0px; left: 0px;"><div style="height: 19px; top: 0px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_comment">--data | total_energy</span></div></div><div style="height: 19px; top: 19px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_identifier">with</span> <span class="ace_identifier">cte</span> <span class="ace_keyword">as</span> <span class="ace_paren ace_lparen">(</span><span class="ace_keyword">select</span> *</div></div><div style="height: 19px; top: 38px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">from</span> <span class="ace_identifier">fb_eu_energy</span></div></div><div style="height: 19px; top: 57px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">union</span> <span class="ace_identifier">all</span> </div></div><div style="height: 19px; top: 76px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">select</span> * <span class="ace_keyword">from</span> <span class="ace_identifier">fb_asia_energy</span></div></div><div style="height: 19px; top: 95px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">union</span> <span class="ace_identifier">all</span> </div></div><div style="height: 19px; top: 114px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">select</span> * <span class="ace_keyword">from</span> <span class="ace_identifier">fb_na_energy</span><span class="ace_paren ace_rparen">)</span></div></div><div style="height: 19px; top: 133px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">select</span> <span class="ace_identifier">f</span>.<span class="ace_storage ace_type">date</span>,<span class="ace_identifier">f</span>.<span class="ace_identifier">total_energy</span> <span class="ace_keyword">from</span> <span class="ace_paren ace_lparen">(</span></div></div><div style="height: 19px; top: 152px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">select</span> <span class="ace_storage ace_type">date</span>, <span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">consumption</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">as</span> <span class="ace_identifier">total_energy</span>,</div></div><div style="height: 19px; top: 171px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_identifier">dense_rank</span><span class="ace_paren ace_lparen">(</span><span class="ace_paren ace_rparen">)</span><span class="ace_identifier">over</span><span class="ace_paren ace_lparen">(</span><span class="ace_keyword">order</span> <span class="ace_keyword">by</span> <span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">consumption</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">desc</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">as</span> <span class="ace_identifier">ranks</span></div></div><div style="height: 19px; top: 190px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">from</span> <span class="ace_identifier">cte</span></div></div><div style="height: 19px; top: 209px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">group</span> <span class="ace_keyword">by</span> <span class="ace_storage ace_type">date</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="display: block; top: 247px; left: 109px; width: 7px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 266px;">&nbsp;</div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 47px; right: 17px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 780px;">&nbsp;</div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה</div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div class="strata-editor-extension strata-editor-dragbar" role="separator"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg></div></div></div></div><div><div><div class="user-solution-upvote"><span class="upvotes-number" style="margin-right: 5px;">2</span><button type="button" class="upvote-link" style="background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%; border: 0px none; color: rgb(0, 166, 153);"><i class="fa fa-arrow-up"></i></button></div><b>Arijit on 15/1/2022</b></div><div class="m-t-5 m-r-5"><div class="strata-editor-container"><div id="ace-editor" style="width: 100%; height: 200px; font-size: 0.8125rem;" class=" ace_editor ace-github"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; font-size: 1px; top: 199px; left: 107px; height: 1px; width: 1px;" readonly="readonly" wrap="off"></textarea><div class="ace_gutter" aria-hidden="true" style="left: 0px; width: 47px;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1000000px; top: -47px; left: 0px; width: 47px;"><div class="ace_gutter-cell " style="height: 19px; top: 38px;">3<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 57px;">4<span class="ace_fold-widget ace_start ace_open" style="height: 19px; display: inline-block;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 76px;">5<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 95px;">6<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 114px;">7<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 133px;">8<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 152px;">9<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 171px;">10<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 190px;">11<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 209px;">12<span style="display: none;"></span></div><div class="ace_gutter-cell ace_gutter-active-line " style="height: 19px; top: 228px;">13<span style="display: none;"></span></div></div></div><div class="ace_scroller" style="line-height: 19px; left: 47px; right: 17px; bottom: 0px;"><div class="ace_content" style="top: -9px; left: 0px; width: 733px; height: 238px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 564px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div style="height: 19px; top: 190px; left: 0px; right: 0px;" class="ace_active-line"></div></div><div class="ace_layer ace_text-layer" style="height: 1000000px; margin: 0px 4px; top: -38px; left: 0px;"><div style="height: 19px; top: 38px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">from</span> </div></div><div style="height: 19px; top: 57px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_paren ace_lparen">(</span><span class="ace_keyword">select</span> * <span class="ace_keyword">from</span> <span class="ace_identifier">fb_eu_energy</span></div></div><div style="height: 19px; top: 76px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">union</span> </div></div><div style="height: 19px; top: 95px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">select</span> * <span class="ace_keyword">from</span> <span class="ace_identifier">fb_asia_energy</span></div></div><div style="height: 19px; top: 114px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">union</span></div></div><div style="height: 19px; top: 133px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">select</span> * <span class="ace_keyword">from</span> <span class="ace_identifier">fb_na_energy</span></div></div><div style="height: 19px; top: 152px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">order</span> <span class="ace_keyword">by</span> <span class="ace_storage ace_type">date</span><span class="ace_paren ace_rparen">)</span> <span class="ace_identifier">x</span></div></div><div style="height: 19px; top: 171px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">group</span> <span class="ace_keyword">by</span> <span class="ace_storage ace_type">date</span><span class="ace_paren ace_rparen">)</span> <span class="ace_identifier">y</span></div></div><div style="height: 19px; top: 190px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">group</span> <span class="ace_keyword">by</span> <span class="ace_storage ace_type">date</span></div></div><div style="height: 19px; top: 209px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">order</span> <span class="ace_keyword">by</span> <span class="ace_constant ace_numeric">2</span> <span class="ace_keyword">desc</span></div></div><div style="height: 19px; top: 228px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">limit</span> <span class="ace_constant ace_numeric">2</span>;</div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="display: block; top: 190px; left: 60px; width: 7px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 247px;">&nbsp;</div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 47px; right: 17px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 780px;">&nbsp;</div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה</div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div class="strata-editor-extension strata-editor-dragbar" role="separator"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg></div></div></div></div><div><div><div class="user-solution-upvote"><span class="upvotes-number" style="margin-right: 5px;">2</span><button type="button" class="upvote-link" style="background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%; border: 0px none; color: rgb(0, 166, 153);"><i class="fa fa-arrow-up"></i></button></div><b>EmreAkanak on 21/12/2021</b></div><div class="m-t-5 m-r-5"><div class="strata-editor-container"><div id="ace-editor" style="width: 100%; height: 200px; font-size: 0.8125rem;" class=" ace_editor ace-github"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; font-size: 1px; top: 0px; left: 0px; height: 1px; width: 1px;" readonly="readonly" wrap="off"></textarea><div class="ace_gutter" aria-hidden="true" style="left: 0px; width: 47px;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1000000px; top: -482px; left: 0px; width: 47px;"><div class="ace_gutter-cell " style="height: 19px; top: 475px;">26<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 494px;">27<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 513px;">28<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 532px;">29<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 551px;">30<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 570px;">31<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 589px;">32<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 608px;">33<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 627px;">34<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 646px;">35<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 665px;">36<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 684px;">37<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 703px;">38<span style="display: none;"></span></div></div></div><div class="ace_scroller" style="line-height: 19px; left: 47px; right: 17px; bottom: 0px;"><div class="ace_content" style="top: -7px; left: 0px; width: 733px; height: 238px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 564px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="height: 1000000px; margin: 0px 4px; top: -475px; left: 0px;"><div style="height: 19px; top: 475px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    </div></div><div style="height: 19px; top: 494px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">UNION</span> <span class="ace_identifier">ALL</span> </div></div><div style="height: 19px; top: 513px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"></div></div><div style="height: 19px; top: 532px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">SELECT</span></div></div><div style="height: 19px; top: 551px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    *</div></div><div style="height: 19px; top: 570px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"></div></div><div style="height: 19px; top: 589px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">FROM</span></div></div><div style="height: 19px; top: 608px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_identifier">fb_asia_energy</span></div></div><div style="height: 19px; top: 627px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"></div></div><div style="height: 19px; top: 646px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">UNION</span> <span class="ace_identifier">ALL</span></div></div><div style="height: 19px; top: 665px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"></div></div><div style="height: 19px; top: 684px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">SELECT</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="display: block; top: 570px; left: 46px; width: 7px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 1064px;">&nbsp;</div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 47px; right: 17px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 780px;">&nbsp;</div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה</div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div class="strata-editor-extension strata-editor-dragbar" role="separator"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg></div></div></div></div><div><div><div class="user-solution-upvote"><span class="upvotes-number" style="margin-right: 5px;">1</span><button type="button" class="upvote-link" style="background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%; border: 0px none; color: rgb(0, 166, 153);"><i class="fa fa-arrow-up"></i></button></div><b>Divya on 5/3/2022</b></div><div class="m-t-5 m-r-5"><div class="strata-editor-container"><div id="ace-editor" style="width: 100%; height: 200px; font-size: 0.8125rem;" class=" ace_editor ace-github"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; font-size: 1px; top: 199px; left: 555px; height: 1px; width: 1px;" readonly="readonly" wrap="off"></textarea><div class="ace_gutter" aria-hidden="true" style="left: 0px; width: 47px;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1000000px; top: -161px; left: 0px; width: 47px;"><div class="ace_gutter-cell " style="height: 19px; top: 152px;">9<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 171px;">10<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 190px;">11<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 209px;">12<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 228px;">13<span style="display: inline-block; height: 19px;" class="ace_fold-widget ace_start ace_open"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 247px;">14<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 266px;">15<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 285px;">16<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 304px;">17<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 323px;">18<span style="display: none;"></span></div><div class="ace_gutter-cell ace_gutter-active-line " style="height: 19px; top: 342px;">19<span style="display: none;"></span></div></div></div><div class="ace_scroller" style="line-height: 19px; left: 47px; right: 17px; bottom: 0px;"><div class="ace_content" style="top: -9px; left: 0px; width: 733px; height: 238px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 564px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"><div style="height: 19px; top: 190px; left: 0px; right: 0px;" class="ace_active-line"></div><div style="height: 19px; width: 7px; top: 190px; left: 501px;" class="ace_bracket ace_start ace_br15"></div><div style="height: 19px; width: 7px; top: 190px; left: 228px;" class="ace_bracket ace_start ace_br15"></div></div><div class="ace_layer ace_text-layer" style="height: 1000000px; margin: 0px 4px; top: -152px; left: 0px;"><div style="height: 19px; top: 152px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">UNION</span> </div></div><div style="height: 19px; top: 171px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">SELECT</span> <span class="ace_storage ace_type">date</span>,<span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">consumption</span><span class="ace_paren ace_rparen">)</span></div></div><div style="height: 19px; top: 190px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">FROM</span> <span class="ace_identifier">fb_na_energy</span></div></div><div style="height: 19px; top: 209px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">group</span> <span class="ace_keyword">by</span> <span class="ace_storage ace_type">date</span><span class="ace_paren ace_rparen">)</span>,</div></div><div style="height: 19px; top: 228px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_identifier">cte2</span> <span class="ace_keyword">AS</span><span class="ace_paren ace_lparen">(</span></div></div><div style="height: 19px; top: 247px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">SELECT</span> <span class="ace_storage ace_type">date</span>,<span class="ace_support ace_function">sum</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">tot</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">AS</span> <span class="ace_identifier">TOTAL_CONSUMPTION</span></div></div><div style="height: 19px; top: 266px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">FROM</span> <span class="ace_identifier">cte1</span></div></div><div style="height: 19px; top: 285px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">group</span> <span class="ace_keyword">by</span> <span class="ace_storage ace_type">DATE</span><span class="ace_paren ace_rparen">)</span></div></div><div style="height: 19px; top: 304px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">SELECT</span> <span class="ace_identifier">cte2</span>.<span class="ace_storage ace_type">date</span>,<span class="ace_identifier">cte2</span>.<span class="ace_identifier">TOTAL_CONSUMPTION</span></div></div><div style="height: 19px; top: 323px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">FROM</span> <span class="ace_identifier">cte2</span> </div></div><div style="height: 19px; top: 342px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">WHERE</span> <span class="ace_identifier">cte2</span>.<span class="ace_identifier">TOTAL_CONSUMPTION</span> <span class="ace_identifier">IN</span> <span class="ace_paren ace_lparen">(</span><span class="ace_keyword">SELECT</span> <span class="ace_support ace_function">max</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">TOTAL_CONSUMPTION</span><span class="ace_paren ace_rparen">)</span><span class="ace_keyword">FROM</span> <span class="ace_identifier">cte2</span><span class="ace_paren ace_rparen">)</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="display: block; top: 190px; left: 508px; width: 7px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 361px;">&nbsp;</div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 47px; right: 17px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 780px;">&nbsp;</div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה</div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div class="strata-editor-extension strata-editor-dragbar" role="separator"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg></div></div></div></div></div><div style="margin-top: 20px;" class="row"><div class="col-12"><button disabled="disabled" style="margin-right: 10px;" xs="1" type="button" class="btn btn-primary">1</button><button style="margin-right: 10px;" xs="1" type="button" class="btn btn-primary">2</button><button style="margin-right: 10px;" xs="1" type="button" class="btn btn-primary">3</button><button style="margin-right: 10px;" xs="1" type="button" class="btn btn-primary">4</button><button style="margin-right: 10px;" xs="1" type="button" class="btn btn-primary">5</button><button style="margin-right: 10px;" xs="1" type="button" class="btn btn-primary">Next</button><div style="width: 80px; height: 38px; display: inline-block; float: right; margin-right: 5px;"><div class=" css-b62m3t-container"><span id="react-select-41-live-region" class="css-7pg0cj-a11yText"></span><span aria-live="polite" aria-atomic="false" aria-relevant="additions text" class="css-7pg0cj-a11yText"></span><div class=" css-1s2u09g-control"><div class=" css-1d8n9bt"><div class=" css-qc6sy-singleValue">5</div><div class=" css-ackcql" data-value=""><input class="" style="color: inherit; background: rgba(0, 0, 0, 0) none repeat scroll 0px center; opacity: 1; width: 100%; grid-area: 1 / 2; font: inherit; min-width: 2px; border: 0px none; margin: 0px; outline: currentcolor none 0px; padding: 0px;" autocapitalize="none" autocomplete="off" autocorrect="off" id="react-select-41-input" spellcheck="false" tabindex="0" type="text" aria-autocomplete="list" aria-expanded="false" aria-haspopup="true" aria-controls="react-select-41-listbox" aria-owns="react-select-41-listbox" role="combobox"></div></div><div class=" css-1wy0on6"><span class=" css-1okebmr-indicatorSeparator"></span><div class=" css-tlfecz-indicatorContainer" aria-hidden="true"><svg height="20" width="20" viewBox="0 0 20 20" aria-hidden="true" focusable="false" class="css-8mmkcg"><path d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"></path></svg></div></div></div><input name="pageSize" type="hidden" value="5"></div></div></div></div></div></div></div></div></div><div><hr class="green-hr-bold"><div class="scrollbar-container"><div class="scrollbar-content"><div><div class="TableElement collapse in show"><div class="clearfix"><div class="pull-left"><div class="table-name color-green">fb_eu_energy<button type="button" class="bg-none btn-link-borderless"><small class="m-l-5 table-name-icon"><i class="fa fa-minus-square-o"></i></small></button></div></div><div class="pull-right"><div class="ws-el-controls pull-right btn-group"><button type="button" class="m-l-5 btn btn-sm btn-primary">Preview</button></div></div></div><div class="collapse in show"><div class="table-columns"><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">date</div><div class="pull-right text-muted"><small>datetime</small></div></div><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">consumption</div><div class="pull-right text-muted"><small>int</small></div></div></div></div></div><div class="TableElement collapse in show"><div class="clearfix"><div class="pull-left"><div class="table-name color-green">fb_asia_energy<button type="button" class="bg-none btn-link-borderless"><small class="m-l-5 table-name-icon"><i class="fa fa-minus-square-o"></i></small></button></div></div><div class="pull-right"><div class="ws-el-controls pull-right btn-group"><button type="button" class="m-l-5 btn btn-sm btn-primary">Preview</button></div></div></div><div class="collapse in show"><div class="table-columns"><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">date</div><div class="pull-right text-muted"><small>datetime</small></div></div><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">consumption</div><div class="pull-right text-muted"><small>int</small></div></div></div></div></div><div class="TableElement collapse in show"><div class="clearfix"><div class="pull-left"><div class="table-name color-green">fb_na_energy<button type="button" class="bg-none btn-link-borderless"><small class="m-l-5 table-name-icon"><i class="fa fa-minus-square-o"></i></small></button></div></div><div class="pull-right"><div class="ws-el-controls pull-right btn-group"><button type="button" class="m-l-5 btn btn-sm btn-primary">Preview</button></div></div></div><div class="collapse in show"><div class="table-columns"><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">date</div><div class="pull-right text-muted"><small>datetime</small></div></div><div class="clearfix table-column"><div class="pull-left m-l-10 col-name">consumption</div><div class="pull-right text-muted"><small>int</small></div></div></div></div></div></div></div></div><hr><div role="alert" class="fade alert alert-warning show"><div><div>Recommended <b>Medium Interview</b> Questions</div><div><a href="https://platform.stratascratch.com/coding/9624-accommodates-to-bed-ratio?python=undefined"> &gt;&gt; Accommodates-To-Bed Ratio</a></div><div><a href="https://platform.stratascratch.com/coding/10124-bookings-vs-non-bookings?python=undefined"> &gt;&gt; Bookings vs Non-Bookings</a></div><div><a href="https://platform.stratascratch.com/coding/9636-cheapest-neighborhoods-with-real-beds-and-internet?python=undefined"> &gt;&gt; Cheapest Neighborhoods With Real Beds And Internet</a></div></div><br><div><div>Recommended <b>Meta/Facebook</b> Questions</div><div><a href="https://platform.stratascratch.com/coding/10061-popularity-of-hack?python=undefined"> &gt;&gt; Popularity of Hack</a></div><div><a href="https://platform.stratascratch.com/coding/10285-acceptance-rate-by-date?python=undefined"> &gt;&gt; Acceptance Rate By Date</a></div><div><a href="https://platform.stratascratch.com/coding/9782-customer-revenue-in-march?python=undefined"> &gt;&gt; Customer Revenue In March</a></div></div></div></div></div></div><div class="col-md-6"><div class="m-t-10 position-relative" style="width: 100%;"><button class="btn btn-primary editor-resize" type="button"><i class="fa fa-arrow-left" aria-hidden="true"></i></button><div class="strata-editor-container"><div id="ace-editor" style="width: 100%; height: 336px; font-size: 0.8125rem;" class=" ace_editor ace-github"><textarea class="ace_text-input" autocorrect="off" autocapitalize="none" spellcheck="false" style="opacity: 0; font-size: 1px; height: 1px; width: 1px; top: 0px; left: 0px;" wrap="off"></textarea><div class="ace_gutter" aria-hidden="true" style="left: 0px; width: 47px;"><div class="ace_layer ace_gutter-layer ace_folding-enabled" style="height: 1000000px; top: 0px; left: 0px; width: 47px;"><div class="ace_gutter-cell " style="height: 19px; top: 0px;">1<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 19px;">2<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 38px;">3<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 57px;">4<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 76px;">5<span class="ace_fold-widget ace_start ace_open" style="height: 19px; display: inline-block;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 95px;">6<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 114px;">7<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 133px;">8<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 152px;">9<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 171px;">10<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 190px;">11<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 209px;">12<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 228px;">13<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 247px;">14<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 266px;">15<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 285px;">16<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 304px;">17<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 323px;">18<span style="display: none;"></span></div><div class="ace_gutter-cell " style="height: 19px; top: 342px;">19<span style="display: none;"></span></div></div></div><div class="ace_scroller" style="line-height: 19px; left: 47px; right: 17px; bottom: 0px;"><div class="ace_content" style="top: 0px; left: 0px; width: 775px; height: 374px;"><div class="ace_layer ace_print-margin-layer"><div class="ace_print-margin" style="left: 564px; visibility: visible;"></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_text-layer" style="height: 1000000px; margin: 0px 4px; top: 0px; left: 0px;"><div style="height: 19px; top: 0px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">SELECT</span></div></div><div style="height: 19px; top: 19px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_storage ace_type">date</span>,</div></div><div style="height: 19px; top: 38px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_support ace_function">SUM</span><span class="ace_paren ace_lparen">(</span><span class="ace_identifier">consumption</span><span class="ace_paren ace_rparen">)</span></div></div><div style="height: 19px; top: 57px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">FROM</span></div></div><div style="height: 19px; top: 76px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_paren ace_lparen">(</span><span class="ace_keyword">SELECT</span></div></div><div style="height: 19px; top: 95px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_storage ace_type">date</span>,</div></div><div style="height: 19px; top: 114px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">consumption</span></div></div><div style="height: 19px; top: 133px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">FROM</span> <span class="ace_identifier">fb_eu_energy</span> <span class="ace_keyword">AS</span> <span class="ace_identifier">eu</span></div></div><div style="height: 19px; top: 152px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">UNION</span> <span class="ace_identifier">ALL</span> <span class="ace_keyword">SELECT</span></div></div><div style="height: 19px; top: 171px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_storage ace_type">date</span>,</div></div><div style="height: 19px; top: 190px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">consumption</span></div></div><div style="height: 19px; top: 209px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">FROM</span></div></div><div style="height: 19px; top: 228px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">fb_asia_energy</span> <span class="ace_keyword">AS</span> <span class="ace_identifier">a</span></div></div><div style="height: 19px; top: 247px;" class="ace_line_group"><div class="ace_line" style="height: 19px;">    <span class="ace_keyword">UNION</span> <span class="ace_identifier">ALL</span> <span class="ace_keyword">SELECT</span></div></div><div style="height: 19px; top: 266px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_storage ace_type">date</span>,</div></div><div style="height: 19px; top: 285px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">consumption</span></div></div><div style="height: 19px; top: 304px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span>    <span class="ace_keyword">FROM</span></div></div><div style="height: 19px; top: 323px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_identifier">fb_na_energy</span> <span class="ace_keyword">AS</span> <span class="ace_identifier">na</span><span class="ace_paren ace_rparen">)</span> <span class="ace_keyword">AS</span> <span class="ace_identifier">total_consumption_table</span></div></div><div style="height: 19px; top: 342px;" class="ace_line_group"><div class="ace_line" style="height: 19px;"><span class="ace_keyword">GROUP</span> <span class="ace_keyword">BY</span> <span class="ace_storage ace_type">date</span></div></div></div><div class="ace_layer ace_marker-layer"></div><div class="ace_layer ace_cursor-layer ace_hidden-cursors"><div class="ace_cursor" style="display: block; top: 836px; left: 4px; width: 7px; height: 19px;"></div></div></div></div><div class="ace_scrollbar ace_scrollbar-v" style="width: 22px; bottom: 0px;"><div class="ace_scrollbar-inner" style="width: 22px; height: 855px;">&nbsp;</div></div><div class="ace_scrollbar ace_scrollbar-h" style="display: none; height: 22px; left: 47px; right: 17px;"><div class="ace_scrollbar-inner" style="height: 22px; width: 839px;">&nbsp;</div></div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: hidden;"><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font: inherit; overflow: visible;">הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה</div><div style="height: auto; width: auto; top: 0px; left: 0px; visibility: hidden; position: absolute; white-space: pre; font-style: inherit; font-variant: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-optical-sizing: inherit; font-language-override: inherit; font-feature-settings: inherit; font-variation-settings: inherit; overflow: visible;">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div></div></div><div class="strata-editor-extension strata-editor-dragbar" role="separator"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 320 512" style="width: 14px;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path></svg></div></div></div><div class="strata-editor-buttons-wrapper"><button type="button" class="btn btn-sm btn-default" style="display: inline-flex; align-items: center;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" style="width: 12px; height: 14px; margin-right: 0.4em;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28 77.418-.07 144.315-53.144 162.787-126.849 1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z"></path></svg>Run Code</button><button type="button" class="btn btn-sm btn-primary" style="display: inline-flex; align-items: center;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" style="width: 12px; height: 14px; margin-right: 0.4em;" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"></path></svg>Solved</button><a href="https://platform.stratascratch.com/coding/10322-finding-user-purchases?python=" class="btn" style="color: green; margin-top: 2px; font-size: 16px;"><i class="fa fa-caret-square-o-right fa-2x" aria-hidden="true" title="Next question"></i></a></div><p class="strata-editor-hotkey-message">Use Alt + Enter to run query</p><div class="m-t-10"><ul class="left_side_tab nav nav-tabs" role="tablist"><li class="nav-item"><a href="#" role="tab" data-rb-event-key="output" id="code-output-tabs-tab-output" aria-controls="code-output-tabs-tabpane-output" aria-selected="true" class="nav-link active">Output</a></li><button style="position: absolute; right: 0px;" type="button" class="btn btn-link">View the output in a separate browser tab</button></ul><div class="tab-content"><div id="code-output-tabs-tabpane-output" aria-labelledby="code-output-tabs-tab-output" role="tabpanel" aria-hidden="false" class="fade tab-pane active show"><div style="width: 100%; height: 20px; overflow-x: scroll;"><div style="width: 0px; height: 20px;"></div></div><div class="scroll-horizontal scroll-vertical table-fixed-height"><div role="alert" class="fade alert alert-info show">Your solution is correct.
          Congratulations, your solution has now been logged in the Solution From Users tab
          </div><p class="text-grey">Your Solution Output:</p><table class="table table-bordered table-striped fixed-width strata-editor-result-table "><thead><tr><th>date</th><th>sum</th></tr></thead><tbody id="myTable"><tr class="correct"><td>2020-01-06</td><td>1250</td></tr><tr class="correct"><td>2020-01-07</td><td>1250</td></tr></tbody></table></div></div></div></div></div></div></div><div class="col-md-1"></div></div></div></main><footer class="footer"><div class="container" style="width: 310px;"><div style="display: flex; justify-content: space-between;"><a href="https://platform.stratascratch.com/terms-and-conditions">Terms and Conditions</a><span>•</span><a href="https://platform.stratascratch.com/privacy-policy">Privacy Policy</a></div></div></footer></div><script type="text/javascript" src="Data_files/runtime.js"></script><script type="text/javascript" src="Data_files/styles.js"></script><script type="text/javascript" src="Data_files/vendorsmain.js"></script><script type="text/javascript" src="Data_files/main.js"></script><div class="ReactModalPortal"></div><iframe name="__privateStripeMetricsController5490" allowtransparency="true" scrolling="no" allow="payment *" src="Data_files/m-outer-9fe86c29346daf61dc2cc0586b4fad18.htm" tabindex="-1" style="border: medium none !important; margin: 0px !important; padding: 0px !important; width: 1px !important; min-width: 100% !important; overflow: hidden !important; display: block !important; visibility: hidden !important; position: fixed !important; height: 1px !important; pointer-events: none !important; user-select: none !important;" frameborder="0"></iframe></body></html>